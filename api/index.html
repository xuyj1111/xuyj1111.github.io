{"themeConfig":{"themeName":"notes","postPageSize":10,"archivesPageSize":50,"siteName":"æ´—è¡£æœºçš„åšå®¢","siteDescription":"ã€ä¸€åJavaå¼€å‘ã€‘slaveğŸ‘‰https://www.cnblogs.com/xuyj1111/","footerInfo":"","showFeatureImage":true,"domain":"https://xuyj1111.github.io","postUrlFormat":"SHORT_ID","tagUrlFormat":"SHORT_ID","dateFormat":"YYYY-MM-DD","feedFullText":false,"feedCount":10,"archivesPath":"archives","postPath":"","tagPath":""},"posts":[{"content":" ä¸€ä¸ª Job ç”±å¤šä¸ª Step ç»„æˆ Step æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼šTaskletå’ŒRead-Process-Write ä¸¤ç§å®ç°æ–¹å¼å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä¸€èµ·ä½¿ç”¨ Spring Batch æä¾›äº† skip å’Œ retry æœºåˆ¶ ä½¿ç”¨ Tasklet Tasklet åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå®ç°org.springframework.batch.core.step.tasklet.Taskletæ¥å£ï¼Œåœ¨executeæ–¹æ³•ä¸­ç¼–å†™é€»è¾‘ å½“ Tasklet å®ç°ç±»è¿”å›RepeatStatus.FINISHEDï¼ŒJob ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ª Step @Configuration @EnableBatchProcessing public class MyJobConfiguration { @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Step step1() { return stepBuilderFactory.get(&quot;step1&quot;) .tasklet((stepContribution, chunkContext) -&gt; { // Step1çš„é€»è¾‘ return RepeatStatus.FINISHED; }).build(); } @Bean public Step step2() { return stepBuilderFactory.get(&quot;step2&quot;) .tasklet((stepContribution, chunkContext) -&gt; { // Step2çš„é€»è¾‘ return RepeatStatus.FINISHED; }).build(); } @Bean public Step step3() { return stepBuilderFactory.get(&quot;step3&quot;) .tasklet((stepContribution, chunkContext) -&gt; { // Step3çš„é€»è¾‘ return RepeatStatus.FINISHED; }).build(); } @Bean public Job myJob() { return jobBuilderFactory.get(&quot;myJob&quot;) .start(step1()) .next(step2()) .next(step3()) .build(); } } ä½¿ç”¨ Read-Process-Write Read-Process-Write ä¼šæ‰§è¡Œå¤šæ¬¡ï¼Œchunk(int chunkSize)ä¸­çš„å€¼è¡¨ç¤ºä¸€æ¬¡ Read-Process-Write çš„å¤„ç†é‡ æ­¤æ¬¡ä½¿ç”¨FlatFileItemReaderè¯»æ•°æ®ï¼ŒJpaItemWriterå†™æ•°æ® public class MessageProcessor implements ItemProcessor&lt;Message, Message&gt; { @Override public Message process(Message item) { System.out.println(&quot;item: &quot; + item.toString()); return item; } } public class MessageItemReadListener implements ItemReadListener&lt;Message&gt; { // } public class MessageWriteListener implements ItemWriteListener&lt;Message&gt; { // } public class MessageLineMapper implements LineMapper&lt;Message&gt; { // } public class Message { // } public class MessageMigrationJobConfiguration { private static final Integer CHUNK_SIZE = 4; private static final String MESSAGE_FILE = &quot;src/main/resources/file/message.txt&quot;; private static final Integer SKIP_LIMIT = 1; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private EntityManagerFactory entityManager; /** * @Description: æ„å»ºjob */ @Bean public Job messageMigrationJob(@Qualifier(&quot;messageMigrationStep&quot;) Step messageMigrationStep) { return jobBuilderFactory.get(&quot;messageMigrationJob&quot;) .flow(messageMigrationStep) .end() .build(); } /** * @Description: æ„å»ºstep */ @Bean public Step messageMigrationStep(@Qualifier(&quot;jsonMessageReader&quot;) FlatFileItemReader&lt;Message&gt; jsonMessageReader, @Qualifier(&quot;messageProcessor&quot;) MessageProcessor messageProcessor, @Qualifier(&quot;messageItemWriter&quot;) JpaItemWriter&lt;Message&gt; messageItemWriter) { return stepBuilderFactory.get(&quot;messageMigrationStep&quot;) .&lt;Message, Message&gt;chunk(CHUNK_SIZE) .reader(jsonMessageReader).faultTolerant().skip(JsonParseException.class).skipLimit(SKIP_LIMIT) .listener(new MessageItemReadListener()) .processor(messageProcessor) .writer(messageItemWriter).faultTolerant().skip(Exception.class).skipLimit(SKIP_LIMIT) .listener(new MessageWriteListener()) .build(); } /** * @Description: æ„å»ºreader * FlatFileItemReaderï¼šä»æ–‡ä»¶é‡Œé¢ä¸€è¡Œä¸€è¡Œçš„è¯»å–æ•°æ® * .setResourceï¼šè®¾ç½®æ–‡ä»¶è·¯å¾„ * .setLineMapperï¼šæŠŠä¸€è¡Œæ–‡æœ¬æ˜ å°„ä¸ºMessageç±»ï¼Œè‡ªå®šä¹‰ç±» */ @Bean public FlatFileItemReader&lt;Message&gt; jsonMessageReader() { FlatFileItemReader&lt;Message&gt; reader = new FlatFileItemReader&lt;&gt;(); reader.setResource(new FileSystemResource(new File(MESSAGE_FILE))); reader.setLineMapper(new MessageLineMapper()); return reader; } @Bean public MessageProcessor messageProcessor() { return new MessageProcessor(); } /** * @Description: æ„å»ºwriter */ @Bean public JpaItemWriter&lt;Message&gt; messageItemWriter() { JpaItemWriter&lt;Message&gt; writer = new JpaItemWriter&lt;&gt;(); writer.setEntityManagerFactory(entityManager); return writer; } } æ³¨è§£ @EnableBatchProcessingæ‰“å¼€Batchã€‚å¦‚æœå¤š job çš„æƒ…å†µï¼Œéœ€è¦æŠŠ EnableBatchProcessing æ³¨è§£çš„ modular è®¾ç½®ä¸º true ï¼Œè®©æ¯ä¸ª Job ä½¿ç”¨è‡ªå·±çš„ ApplicationConext @JobScopeä½œç”¨åŸŸæ³¨è§£ã€‚åº”ç”¨äº step æˆ– readerã€processorã€writer ç­‰ç»„ä»¶çš„ @Bean æ–¹æ³•ä¸­ï¼Œç”¨äºæŒ‡å®šç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸèŒƒå›´ä¸º Jobã€‚ä½¿ç”¨ @JobScope æ³¨è§£çš„ç»„ä»¶ï¼Œå°†åœ¨ Job æ‰§è¡ŒæœŸé—´å®ä¾‹åŒ–ä¸€æ¬¡ï¼Œç„¶ååœ¨ Job æ‰§è¡Œå®Œæˆåé”€æ¯ã€‚è¿™ä½¿å¾—ç»„ä»¶å¯ä»¥æ‹¥æœ‰ Job çš„ä¸Šä¸‹æ–‡ï¼ŒåŒ…æ‹¬ JobParametersã€ExecutionContext ç­‰ï¼Œä»è€Œå¯ä»¥åœ¨ Job æ‰§è¡ŒæœŸé—´è·å– Job çš„ç›¸å…³ä¿¡æ¯ã€‚ å¸¸ç”¨ç±» JobLauncherå¯åŠ¨ job ç±» JobRegistryå­˜å‚¨å¤šä¸ª job å®ä¾‹ï¼ŒJobRegistry å¯ä»¥é€šè¿‡ job å®ä¾‹çš„å”¯ä¸€åç§°è·å– job JobBuilderFactoryæ„å»º JobBuilder å¯¹è±¡çš„å·¥å‚ç±» é€šå¸¸ç”¨JobBuilder get(String name)æ„å»º JobBuilder StepBuilderFactoryæ„å»º StepBuilder å¯¹è±¡çš„å·¥å‚ç±» é€šå¸¸ç”¨StepBuilder get(String name)æ„å»º StepBuilder JobParameters å­˜å‚¨ä¸€ç»„æœ‰åºçš„é”®å€¼å¯¹ï¼Œè¿™äº›é”®å€¼ç”¨äº Job æˆ– Step çš„è¿è¡Œæ—¶å‚æ•° @Autowired private JobLauncher jobLauncher; public void executeJob(Job job) { JobParameters params = new JobParametersBuilder() .addLong(key, value, true) .addString(key, value, true) .toJobParameters(); jobLauncher.run(job, params) } åœ¨æ„å»º job æ—¶ï¼ˆæˆ–step/tasklet/chunk/reader...ï¼‰éœ€è¦å‚æ•°ä¿¡æ¯ï¼Œä½¿ç”¨@Value(&quot;#{jobParameters['...']}&quot;)æ³¨è§£çš„æ–¹å¼æ³¨å…¥ éœ€è¦ä½¿ç”¨ @JobScope æ³¨è§£ @Bean @JobScope ItemProcessor&lt;Xxx, Xxx&gt; processor(@Value(&quot;#{jobParameters['Xxx']}&quot;) String Xxx, @Value(&quot;#{jobParameters['Xxx']}&quot;) String Xxx) { return null; } JobBuilder ç”¨æ¥åˆ›å»º Job å®ä¾‹ å¸¸ç”¨æ–¹æ³•ğŸ‘‡ name(String name)ä¸ºJobå®ä¾‹æŒ‡å®šåç§° incrementer(JobParametersIncrementer incrementer)æŒ‡å®š JobParametersIncrementer å®ä¾‹ï¼Œç”¨äºç”Ÿæˆ Job å‚æ•° start(Step step)è¿”å› SimpleJobBuilderï¼ŒæŒ‡å®š Job å®ä¾‹çš„ç¬¬ä¸€ä¸ª Step å®ä¾‹ flow(Step step)è¿”å› JobFlowBuilderï¼ŒæŒ‡å®š Job å®ä¾‹çš„ç¬¬ä¸€ä¸ª Step å®ä¾‹ listener(JobExecutionListener listener)æŒ‡å®š JobExecutionListener å®ä¾‹ï¼Œç”¨äºç›‘å¬ Job çš„æ‰§è¡Œ listener(StepExecutionListener listener)æŒ‡å®š StepExecutionListener å®ä¾‹ï¼Œç”¨äºç›‘å¬ Job çš„æ¯ä¸ª Step çš„æ‰§è¡Œ validator(JobParametersValidator validator)æŒ‡å®š JobParametersValidator å®ä¾‹ï¼Œç”¨äºéªŒè¯ Job å‚æ•°çš„åˆæ³•æ€§ build()æ„å»º Job å®ä¾‹ Job Job æœ‰ä»¥ä¸‹å‡ ç§ï¼š SimpleJobåŒ…å«ä¸€ä¸ª Stepï¼Œæ‰§è¡Œå®Œ Step åå³ç»“æŸ FlowJobåŒ…å«å¤šä¸ª Step ç»„æˆçš„é€»è¾‘æµï¼Œæ ¹æ® Step æ‰§è¡Œç»“æœçŠ¶æ€ï¼Œé€šè¿‡å†³ç­–å™¨å®ç°åˆ†æ”¯ SplitJobåŒ…å«å¤šä¸ª Stepï¼Œè¿™äº› Step å¯ä»¥å¹¶è¡Œæ‰§è¡Œ ChildJobåœ¨ä¸€ä¸ª Job ä¸­å¯ä»¥åŒ…å«å…¶ä»– Jobï¼Œå½¢æˆæ ‘å½¢ç»“æ„ï¼Œçˆ¶Job å¯ä»¥å†³å®š å­Job çš„æ‰§è¡Œé¡ºåºå’Œæ‰§è¡Œæ¡ä»¶ CompositeJobé€šè¿‡è®²å¤šä¸ª Job ç»„åˆåœ¨ä¸€èµ·ï¼Œå®ç°ä¸€ä¸ª Job åŒ…å«å¤šä¸ª å­Job çš„æ•ˆæœï¼Œå­Job å¯ä»¥å¹¶è¡Œæˆ–ä¸²è¡Œæ‰§è¡Œï¼Œç›¸äº’ç‹¬ç«‹ p.s. è¿™äº› Job ä¹‹é—´å¹¶ä¸æ˜¯äº’æ–¥çš„ï¼Œå¯ä»¥æ··åˆä½¿ç”¨ã€‚å¯ä»¥ä½¿ç”¨JobStepBuilderå°†ä¸€ä¸ª Job å°è£…æˆ Stepï¼Œç„¶ååœ¨å¦ä¸€ä¸ª Job ä¸­å¼•ç”¨è¿™ä¸ª Step StepBuilder ç”¨æ¥åˆ›å»º Step å®ä¾‹ å¸¸ç”¨æ–¹æ³•ğŸ‘‡ tasklet(Tasklet tasklet)æŒ‡å®š Step ä¸­ä½¿ç”¨çš„ Taskletï¼Œæ¯ä¸ª Step è‡³å°‘è¦æœ‰ä¸€ä¸ª Tasklet chunk(int chunkSize)æŒ‡å®šæ¯æ¬¡è¯»å–å¤šå°‘æ•°æ®è¿›è¡Œå¤„ç†ï¼Œä»¥åŠå¤„ç†å®Œåä¸€æ¬¡æ€§å†™å‡ºçš„æ•°æ®é‡ reader(ItemReader&lt;? extends T&gt; itemReader)æŒ‡å®š Step ä¸­ä½¿ç”¨çš„ ItemReader processor(ItemProcessor&lt;? super T, ? extends S&gt; itemProcessor)æŒ‡å®š Step ä¸­ä½¿ç”¨çš„ ItemProcessor writer(ItemWriter&lt;? super S&gt; itemWriter)æŒ‡å®š Step ä¸­ä½¿ç”¨çš„ ItemWriter allowStartIfComplete(boolean allowStart)æ˜¯å¦å…è®¸ Step åœ¨ä¸Šä¸€æ¬¡æ‰§è¡Œå®Œæˆåç«‹å³å†æ¬¡æ‰§è¡Œ flow(Flow flow)è¿”å› FlowStepBuilderï¼ŒæŒ‡å®š Step çš„ Flow å®ä¾‹ Step Step æœ‰ä»¥ä¸‹å‡ ç§ï¼š SimpleStepæŒ‡å®šè¯»ã€å¤„ç†ã€å†™æ“ä½œã€å•çº¿ç¨‹ã€‘ ChunkOrientedTaskletå¯ä»¥åŒ…æ½è¯»ã€å¤„ç†ã€å†™æ“ä½œã€å•çº¿ç¨‹ã€‘ TaskletStepæŒ‡å®šå¹¶æ‰§è¡Œä¸€ä¸ª Taskletã€å•çº¿ç¨‹ã€‘ FlowStepä¸­æœ‰ä¸€ä¸ª Flow å®ä¾‹ï¼ŒFlow å®ä¾‹ä¸­å¯ä»¥æœ‰å¤šä¸ª Stepï¼Œå¯è¿›è¡Œæ¡ä»¶æ§åˆ¶ï¼Œå¦‚è·³è¿‡æŸäº›æ­¥éª¤ã€é‡è¯•æŸäº›æ­¥éª¤ç­‰ã€å•çº¿ç¨‹ã€‘ å¤šçº¿ç¨‹çš„ Step æœ‰SimpleAsyncTaskExecutorStepã€TaskExecutorStepã€PartitionStep Listener Listener æ¥å£éœ€è¦å®ç°ä½¿ç”¨ï¼Œéƒ½æœ‰beforeXxxå’ŒafterXxxæ–¹æ³•ã€‚åœ¨å¯¹åº”ä½ç½®ä½¿ç”¨ï¼Œå¦‚ Step çš„ç›‘å¬å™¨ï¼Œåœ¨åˆ›å»º Step æ—¶ä½¿ç”¨ï¼›Job çš„ç›‘å¬å™¨ï¼Œåœ¨åˆ›å»º Job æ—¶ä½¿ç”¨ å¸¸ç”¨æ¥å£ğŸ‘‡ StepExecutionListenerstep æ‰§è¡Œç›‘å¬å™¨ ItemReadListenerstep è¯»ç›‘å¬å™¨ ItemWriteListenerstep å†™ç›‘å¬å™¨ JobExecutionListenerjob æ‰§è¡Œç›‘å¬å™¨ ItemReader step çš„è¯»æ“ä½œï¼ŒSpringBatch æä¾›å¤šä¸ªå®ç°ç±»ğŸ‘‡ JdbcCursorItemReaderç”¨äºä» JDBC æ¸¸æ ‡æ£€ç´¢ç»“æœé›† JdbcPagingItemReaderç”¨äºä» JDBC åˆ†é¡µæ£€ç´¢ç»“æœé›† HibernateCursorItemReaderç”¨äºä» Hibernate æ¸¸æ ‡æ£€ç´¢ç»“æœé›† HibernatePagingItemReaderç”¨äºä» Hibernate åˆ†é¡µæ£€ç´¢ç»“æœé›† JpaPagingItemReaderç”¨äºä» JPA åˆ†é¡µæ£€ç´¢ç»“æœé›† FlatFileItemReaderç”¨äºä»æ–‡ä»¶ä¸­è¯»å–æ•°æ® StaxEventItemReaderè¯»å– XML æ–‡ä»¶ JsonItemReaderè¯»å– Json æ ¼å¼æ•°æ® è‡ªå®šä¹‰ ItemReaderï¼šå®ç° ItemReader æ¥å£ï¼Œå¹¶é‡å†™ read æ–¹æ³•ï¼Œè¯¥æ–¹æ³•éœ€è¦è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰è¯»åˆ°æ•°æ®åˆ™è¿”å› null ItemWriter step çš„å†™æ“ä½œï¼ŒSpringBatch æä¾›å¤šä¸ªå®ç°ç±»ğŸ‘‡ JdbcBatchItemWriterå°†æ•°æ®æ‰¹é‡å†™å…¥å…³ç³»å‹æ•°æ®åº“ JpaItemWriterå°†æ•°æ®æ‰¹é‡å†™å…¥ JPA å®ä½“ç±» HibernateItemWriterå°†æ•°æ®æ‰¹é‡å†™å…¥ Hibernate å®ä½“ç±» FlatFileItemWriterå°†æ•°æ®å†™å…¥æ–‡æœ¬æ–‡ä»¶ MultiResourceItemWriterå°†æ•°æ®å†™å…¥å¤šä¸ªæ–‡ä»¶ MongoItemWriterå°†æ•°æ®æ‰¹é‡å†™å…¥ MongoDB HdfsTextItemWriterå°†æ•°æ®å†™å…¥ HDFS æ–‡ä»¶ è‡ªå®šä¹‰ ItemWriterï¼šé€šè¿‡å®ç° ItemWriter æ¥å£ï¼Œå¹¶é‡å†™ write æ–¹æ³• ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"ä½¿ç”¨æ‰‹å†Œ","slug":"0shj16Tx0","used":true,"link":"https://xuyj1111.github.io/0shj16Tx0/"}],"title":"ã€Javaã€‘SpringBatch çº¯çº¯çš„ç¬”è®°","feature":"","link":"https://xuyj1111.github.io/s4LoWAgBB/","stats":{"text":"8 min read","time":462000,"words":1731,"minutes":8},"date":"2023-03-02 10:00:33","dateFormat":"2023-03-02"},{"content":"ä¸‰ç§ ThreadLocal åˆ†åˆ«æ˜¯ï¼š jdk æä¾›çš„ThreadLocal jdk æä¾›çš„InheritableThreadLocal é˜¿é‡Œå·´å·´æä¾›çš„TransmittableThreadLocal æ–‡ç« ä¸­ demo çš„ç¯å¢ƒä»£ç ğŸ‘‡ private ThreadLocal&lt;Object&gt; t = new ThreadLocal&lt;&gt;(); private ThreadLocal&lt;Object&gt; it = new InheritableThreadLocal&lt;&gt;(); private ThreadLocal tt = new TransmittableThreadLocal(); private void printForThreadLocal() { System.out.println(Thread.currentThread().getName() + &quot;:&quot; + t.get()); } private void printForInheritableThreadLocal() { System.out.println(Thread.currentThread().getName() + &quot;:&quot; + it.get()); } private void printForTransmittableThreadLocal() { System.out.println(Thread.currentThread().getName() + &quot;:&quot; + tt.get()); } /** * @Description: åˆ›å»ºçº¿ç¨‹æ±  */ private Executor createThreadPool() { ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor(); executor.setCorePoolSize(1); executor.setMaxPoolSize(10); executor.setKeepAliveSeconds(60); executor.setQueueCapacity(60); executor.setThreadNamePrefix(&quot;myThreadPool: &quot;); executor.setTaskDecorator(new MyTaskDecorator()); executor.initialize(); return executor; } ThreadLocal çº¿ç¨‹å˜é‡ï¼Œä»…ä¾›å½“å‰çº¿ç¨‹ä½¿ç”¨ï¼Œä¸å­˜åœ¨å¤šçº¿ç¨‹åˆ†äº«å˜é‡é—®é¢˜ ç¼ºç‚¹ï¼šçˆ¶å­çº¿ç¨‹ä¸å¯ä¼ é€’ ä¸‰ä¸ªæ–¹æ³•ï¼š void set(Object value)å¡«å……å˜é‡ T get()è·å–å˜é‡ void remove()åˆ é™¤å˜é‡ã€å½“çº¿ç¨‹ç»“æŸåï¼Œçº¿ç¨‹å˜é‡ä¹Ÿä¼šè¢«å›æ”¶ï¼Œæ˜¾ç¤ºçš„è°ƒç”¨removeå¹¶ä¸æ˜¯å¿…é¡»çš„æ“ä½œï¼Œä½†å¯ä»¥åŠ å¿«å†…å­˜å›æ”¶çš„é€Ÿåº¦ã€‘ æœ€ç®€å•çš„ ThreadLocal ç”¨æ³•ğŸ‘‡ è¯æ˜çº¿ç¨‹ä¹‹é—´ä¸å…±äº« ThreadLocal ä¸­çš„å€¼ @Test public void test01ThreadLocal() { t.set(1); new Thread(() -&gt; printForThreadLocal()).start(); printForThreadLocal(); } InheritableThreadLocal æ˜¯ ThreadLocal çš„å­ç±»ï¼Œå®ç°äº†çˆ¶å­çº¿ç¨‹å…±äº«å˜é‡é—®é¢˜ ç¼ºç‚¹ï¼šåœ¨ä½¿ç”¨çº¿ç¨‹æ± æ—¶ï¼Œçˆ¶å­çº¿ç¨‹å…±äº«å˜é‡ä»æœ‰é—®é¢˜ å®ç°çˆ¶å­çº¿ç¨‹å…±äº«å˜é‡ğŸ‘‡ @Test public void test01InheritableThreadLocal() { it.set(1); new Thread(() -&gt; printForInheritableThreadLocal()).start(); printForInheritableThreadLocal(); } åŸºæœ¬æ•°æ®ç±»å‹ä¸å¯è¯æ˜çˆ¶å­çº¿ç¨‹æŒ‡å‘åŒä¸€å¯¹è±¡ğŸ‘‡ @SneakyThrows @Test public void test02InheritableThreadLocal() { it.set(1); printForInheritableThreadLocal(); new Thread(() -&gt; { printForInheritableThreadLocal(); it.set(2); printForInheritableThreadLocal(); }).start(); Thread.sleep(500); printForInheritableThreadLocal(); } InheritableThreadLocalä¸­å­çˆ¶çº¿ç¨‹ä¸­æŒ‡å‘åŒä¸€å¯¹è±¡ğŸ‘‡ @SneakyThrows @Test public void test03InheritableThreadLocal() { TestDTO testDTO = new TestDTO(); testDTO.setName(&quot;å¼ ä¸‰&quot;); testDTO.setAge(20); it.set(testDTO); printForInheritableThreadLocal(); new Thread(() -&gt; { printForInheritableThreadLocal(); TestDTO pp = (TestDTO) it.get(); pp.setName(&quot;æå››&quot;); it.set(pp); printForInheritableThreadLocal(); }).start(); Thread.sleep(500); printForInheritableThreadLocal(); } çº¿ç¨‹æ± åœ¨initæ–°çš„çº¿ç¨‹æ—¶ï¼Œä¼šå°†ä¸»çº¿ç¨‹çš„InheritableThreadLocalä¼ é€’ç»™å­çº¿ç¨‹ğŸ‘‡ @SneakyThrows @Test public void test04InheritableThreadLocal() { it.set(1); printForInheritableThreadLocal(); Executor threadPool = createThreadPool(); threadPool.execute(() -&gt; printForInheritableThreadLocal()); printForInheritableThreadLocal(); } ä½†å¦‚æœåœ¨initå­çº¿ç¨‹æ—¶ï¼Œä¸»çº¿ç¨‹InheritableThreadLocalä¸­å€¼ä¸ºnullï¼Œå­çº¿ç¨‹ä¹Ÿæ˜¯nullï¼› ä¹‹åä¸»çº¿ç¨‹è¢«èµ‹äº†æ–°å€¼ï¼Œå·²ç»è¢«initçš„å­çº¿ç¨‹å†æ¬¡è¢«è°ƒç”¨æ—¶ï¼Œä¸»çº¿ç¨‹ä¸ä¼šèµ‹å€¼ç»™å­çº¿ç¨‹ï¼ˆå½“å‰çº¿ç¨‹æ± å¤§å°ä¸º1ï¼Œåˆ™å¯å®ç°äºŒæ¬¡è°ƒç”¨åˆ›å»ºçš„å­çº¿ç¨‹ï¼‰ğŸ‘‡ @SneakyThrows @Test public void test05InheritableThreadLocal() { Executor threadPool = createThreadPool(); threadPool.execute(() -&gt; printForInheritableThreadLocal()); it.set(1); threadPool.execute(() -&gt; printForInheritableThreadLocal()); printForInheritableThreadLocal(); } TransmittableThreadLocal è§£å†³äº†InheritableThreadLocalåœ¨çº¿ç¨‹æ± æ—¶çˆ¶å­çº¿ç¨‹ä¼ é€’çš„é—®é¢˜ğŸ‘‡ @Test public void test01TransmittableThreadLocal() { Executor threadPool = TtlExecutors.getTtlExecutor(createThreadPool()); threadPool.execute(() -&gt; printForTransmittableThreadLocal()); tt.set(1); threadPool.execute(() -&gt; printForTransmittableThreadLocal()); printForTransmittableThreadLocal(); } ","tags":[{"index":-1,"name":"Java","slug":"SOje8Joqr","used":true,"link":"https://xuyj1111.github.io/SOje8Joqr/"},{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"ä½¿ç”¨æ‰‹å†Œ","slug":"0shj16Tx0","used":true,"link":"https://xuyj1111.github.io/0shj16Tx0/"}],"title":"ã€Javaã€‘ä¸‰ç§ ThreadLocal çš„ç®€å•ä½¿ç”¨","feature":"","link":"https://xuyj1111.github.io/Kbdumv2S0/","stats":{"text":"3 min read","time":170000,"words":612,"minutes":3},"date":"2023-02-19 23:33:11","dateFormat":"2023-02-19"},{"content":" ç©è½¬Springä¸­å¼ºå¤§çš„spelè¡¨è¾¾å¼ï¼ï¼Œby æ— æƒ…çš„BUGæ€æ‰‹ Spel æ¦‚è¿° Spring è¡¨è¾¾å¼è¯­è¨€å…¨ç§°ä¸º â€œSpring Expression Languageâ€ï¼Œç¼©å†™ä¸º â€œSpELâ€ï¼Œç±»ä¼¼äº Struts2x ä¸­ä½¿ç”¨çš„ OGNL è¡¨è¾¾å¼è¯­è¨€ï¼Œèƒ½åœ¨è¿è¡Œæ—¶æ„å»ºå¤æ‚è¡¨è¾¾å¼ã€å­˜å–å¯¹è±¡å›¾å±æ€§ã€å¯¹è±¡æ–¹æ³•è°ƒç”¨ç­‰ç­‰ï¼Œå¹¶ä¸”èƒ½ä¸ Spring åŠŸèƒ½å®Œç¾æ•´åˆï¼Œå¦‚èƒ½ç”¨æ¥é…ç½® Bean å®šä¹‰ã€‚ è¡¨è¾¾å¼è¯­è¨€ç»™é™æ€ Java è¯­è¨€å¢åŠ äº†åŠ¨æ€åŠŸèƒ½ã€‚ SpEL æ˜¯å•ç‹¬æ¨¡å—ï¼Œåªä¾èµ–äº core æ¨¡å—ï¼Œä¸ä¾èµ–äºå…¶ä»–æ¨¡å—ï¼Œå¯ä»¥å•ç‹¬ä½¿ç”¨ã€‚ Spel èƒ½å¹²ä»€ä¹ˆ? è¡¨è¾¾å¼è¯­è¨€ä¸€èˆ¬æ˜¯ç”¨æœ€ç®€å•çš„å½¢å¼å®Œæˆæœ€ä¸»è¦çš„å·¥ä½œï¼Œå‡å°‘æˆ‘ä»¬çš„å·¥ä½œé‡ã€‚ SpEL æ”¯æŒå¦‚ä¸‹è¡¨è¾¾å¼ï¼š ä¸€ã€åŸºæœ¬è¡¨è¾¾å¼ï¼š å­—é¢é‡è¡¨è¾¾å¼ã€å…³ç³»ï¼Œé€»è¾‘ä¸ç®—æ•°è¿ç®—è¡¨è¾¾å¼ã€å­—ç¬¦ä¸²è¿æ¥åŠæˆªå–è¡¨è¾¾å¼ã€ä¸‰ç›®è¿ç®—åŠ Elivis è¡¨è¾¾å¼ã€æ­£åˆ™è¡¨è¾¾å¼ã€æ‹¬å·ä¼˜å…ˆçº§è¡¨è¾¾å¼ï¼› äºŒã€ç±»ç›¸å…³è¡¨è¾¾å¼ï¼š ç±»ç±»å‹è¡¨è¾¾å¼ã€ç±»å®ä¾‹åŒ–ã€instanceof è¡¨è¾¾å¼ã€å˜é‡å®šä¹‰åŠå¼•ç”¨ã€èµ‹å€¼è¡¨è¾¾å¼ã€è‡ªå®šä¹‰å‡½æ•°ã€å¯¹è±¡å±æ€§å­˜å–åŠå®‰å…¨å¯¼èˆªè¡¨è¾¾å¼ã€å¯¹è±¡æ–¹æ³•è°ƒç”¨ã€Bean å¼•ç”¨ï¼› ä¸‰ã€é›†åˆç›¸å…³è¡¨è¾¾å¼ï¼š å†…è” Listã€å†…è”æ•°ç»„ã€é›†åˆï¼Œå­—å…¸è®¿é—®ã€åˆ—è¡¨ï¼Œå­—å…¸ï¼Œæ•°ç»„ä¿®æ”¹ã€é›†åˆæŠ•å½±ã€é›†åˆé€‰æ‹©ï¼›ä¸æ”¯æŒå¤šç»´å†…è”æ•°ç»„åˆå§‹åŒ–ï¼›ä¸æ”¯æŒå†…è”å­—å…¸å®šä¹‰ï¼› å››ã€å…¶ä»–è¡¨è¾¾å¼ï¼šæ¨¡æ¿è¡¨è¾¾å¼ã€‚ æ³¨ï¼šSpEL è¡¨è¾¾å¼ä¸­çš„å…³é”®å­—æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ã€‚ SpEL åŸºç¡€ HelloWorld é¦–å…ˆå‡†å¤‡æ”¯æŒ SpEL çš„ Jar åŒ…ï¼šâ€œorg.springframework.expression-3.0.5.RELEASE.jarâ€ å°†å…¶æ·»åŠ åˆ°ç±»è·¯å¾„ä¸­ã€‚ SpEL åœ¨æ±‚è¡¨è¾¾å¼å€¼æ—¶ä¸€èˆ¬åˆ†ä¸ºå››æ­¥ï¼Œå…¶ä¸­ç¬¬ä¸‰æ­¥å¯é€‰ï¼šé¦–å…ˆæ„é€ ä¸€ä¸ªè§£æå™¨ï¼Œå…¶æ¬¡è§£æå™¨è§£æå­—ç¬¦ä¸²è¡¨è¾¾å¼ï¼Œåœ¨æ­¤æ„é€ ä¸Šä¸‹æ–‡ï¼Œæœ€åæ ¹æ®ä¸Šä¸‹æ–‡å¾—åˆ°è¡¨è¾¾å¼è¿ç®—åçš„å€¼ã€‚ è®©æˆ‘ä»¬çœ‹ä¸‹ä»£ç ç‰‡æ®µå§ï¼š package com.javacode2018.spel; import org.junit.Test; import org.springframework.expression.EvaluationContext; import org.springframework.expression.Expression; import org.springframework.expression.ExpressionParser; import org.springframework.expression.spel.standard.SpelExpressionParser; import org.springframework.expression.spel.support.StandardEvaluationContext; public class SpelTest { @Test public void test1() { ExpressionParser parser = new SpelExpressionParser(); Expression expression = parser.parseExpression(&quot;('Hello' + ' World').concat(#end)&quot;); EvaluationContext context = new StandardEvaluationContext(); context.setVariable(&quot;end&quot;, &quot;!&quot;); System.out.println(expression.getValue(context)); } } è¾“å‡º Hello World! æ¥ä¸‹æ¥è®©æˆ‘ä»¬åˆ†æä¸‹ä»£ç ï¼š 1ï¼‰åˆ›å»ºè§£æå™¨ï¼šSpEL ä½¿ç”¨ ExpressionParser æ¥å£è¡¨ç¤ºè§£æå™¨ï¼Œæä¾› SpelExpressionParser é»˜è®¤å®ç°ï¼› 2ï¼‰è§£æè¡¨è¾¾å¼ï¼šä½¿ç”¨ ExpressionParser çš„ parseExpression æ¥è§£æç›¸åº”çš„è¡¨è¾¾å¼ä¸º Expression å¯¹è±¡ã€‚ 3ï¼‰æ„é€ ä¸Šä¸‹æ–‡ï¼šå‡†å¤‡æ¯”å¦‚å˜é‡å®šä¹‰ç­‰ç­‰è¡¨è¾¾å¼éœ€è¦çš„ä¸Šä¸‹æ–‡æ•°æ®ã€‚ 4ï¼‰æ±‚å€¼ï¼šé€šè¿‡ Expression æ¥å£çš„ getValue æ–¹æ³•æ ¹æ®ä¸Šä¸‹æ–‡è·å¾—è¡¨è¾¾å¼å€¼ã€‚ æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹ä¸‹å…¶å…·ä½“å®ç°åŠåŸç†å§ã€‚ SpEL åŸç†åŠæ¥å£ SpEL æä¾›ç®€å•çš„æ¥å£ä»è€Œç®€åŒ–ç”¨æˆ·ä½¿ç”¨ï¼Œåœ¨ä»‹ç»åŸç†å‰è®©æˆ‘ä»¬å­¦ä¹ ä¸‹å‡ ä¸ªæ¦‚å¿µï¼š ä¸€ã€è¡¨è¾¾å¼ï¼š è¡¨è¾¾å¼æ˜¯è¡¨è¾¾å¼è¯­è¨€çš„æ ¸å¿ƒï¼Œæ‰€ä»¥è¡¨è¾¾å¼è¯­è¨€éƒ½æ˜¯å›´ç»•è¡¨è¾¾å¼è¿›è¡Œçš„ï¼Œä»æˆ‘ä»¬è§’åº¦æ¥çœ‹æ˜¯ â€œå¹²ä»€ä¹ˆâ€ï¼› äºŒã€è§£æå™¨ï¼š ç”¨äºå°†å­—ç¬¦ä¸²è¡¨è¾¾å¼è§£æä¸ºè¡¨è¾¾å¼å¯¹è±¡ï¼Œä»æˆ‘ä»¬è§’åº¦æ¥çœ‹æ˜¯ â€œè°æ¥å¹²â€ï¼› ä¸‰ã€ä¸Šä¸‹æ–‡ï¼š è¡¨è¾¾å¼å¯¹è±¡æ‰§è¡Œçš„ç¯å¢ƒï¼Œè¯¥ç¯å¢ƒå¯èƒ½å®šä¹‰å˜é‡ã€å®šä¹‰è‡ªå®šä¹‰å‡½æ•°ã€æä¾›ç±»å‹è½¬æ¢ç­‰ç­‰ï¼Œä»æˆ‘ä»¬è§’åº¦çœ‹æ˜¯ â€œåœ¨å“ªå¹²â€ï¼› å››ã€æ ¹å¯¹è±¡åŠæ´»åŠ¨ä¸Šä¸‹æ–‡å¯¹è±¡ï¼š æ ¹å¯¹è±¡æ˜¯é»˜è®¤çš„æ´»åŠ¨ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œæ´»åŠ¨ä¸Šä¸‹æ–‡å¯¹è±¡è¡¨ç¤ºäº†å½“å‰è¡¨è¾¾å¼æ“ä½œçš„å¯¹è±¡ï¼Œä»æˆ‘ä»¬è§’åº¦çœ‹æ˜¯ â€œå¯¹è°å¹²â€ã€‚ ç†è§£äº†è¿™äº›æ¦‚å¿µåï¼Œè®©æˆ‘ä»¬çœ‹ä¸‹ SpEL å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š å·¥ä½œåŸç† 1.é¦–å…ˆå®šä¹‰è¡¨è¾¾å¼ï¼šâ€œ1+2â€ï¼› 2.å®šä¹‰è§£æå™¨ExpressionParserå®ç°ï¼ŒSpELæä¾›é»˜è®¤å®ç°SpelExpressionParserï¼› 2.1.SpelExpressionParserè§£æå™¨å†…éƒ¨ä½¿ç”¨Tokenizerç±»è¿›è¡Œè¯æ³•åˆ†æï¼Œå³æŠŠå­—ç¬¦ä¸²æµåˆ†æä¸ºè®°å·æµï¼Œè®°å·åœ¨SpELä½¿ç”¨Tokenç±»æ¥è¡¨ç¤ºï¼› 2.2.æœ‰äº†è®°å·æµåï¼Œè§£æå™¨ä¾¿å¯æ ¹æ®è®°å·æµç”Ÿæˆå†…éƒ¨æŠ½è±¡è¯­æ³•æ ‘ï¼›åœ¨SpELä¸­è¯­æ³•æ ‘èŠ‚ç‚¹ç”±SpelNodeæ¥å£å®ç°ä»£è¡¨ï¼šå¦‚OpPlusè¡¨ç¤ºåŠ æ“ä½œèŠ‚ç‚¹ã€IntLiteralè¡¨ç¤ºintå‹å­—é¢é‡èŠ‚ç‚¹ï¼›ä½¿ç”¨SpelNodelå®ç°ç»„æˆäº†æŠ½è±¡è¯­æ³•æ ‘ï¼› 2.3.å¯¹å¤–æä¾›Expressionæ¥å£æ¥ç®€åŒ–è¡¨ç¤ºæŠ½è±¡è¯­æ³•æ ‘ï¼Œä»è€Œéšè—å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œå¹¶æä¾›getValueç®€å•æ–¹æ³•ç”¨äºè·å–è¡¨è¾¾å¼å€¼ï¼›SpELæä¾›é»˜è®¤å®ç°ä¸ºSpelExpressionï¼› 3.å®šä¹‰è¡¨è¾¾å¼ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆå¯é€‰ï¼‰ï¼ŒSpELä½¿ç”¨EvaluationContextæ¥å£è¡¨ç¤ºä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œç”¨äºè®¾ç½®æ ¹å¯¹è±¡ã€è‡ªå®šä¹‰å˜é‡ã€è‡ªå®šä¹‰å‡½æ•°ã€ç±»å‹è½¬æ¢å™¨ç­‰ï¼ŒSpELæä¾›é»˜è®¤å®ç°StandardEvaluationContextï¼› 4.ä½¿ç”¨è¡¨è¾¾å¼å¯¹è±¡æ ¹æ®ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆå¯é€‰ï¼‰æ±‚å€¼ï¼ˆè°ƒç”¨è¡¨è¾¾å¼å¯¹è±¡çš„getValueæ–¹æ³•ï¼‰è·å¾—ç»“æœã€‚ æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹ä¸‹ SpEL çš„ä¸»è¦æ¥å£å§ï¼š ExpressionParser æ¥å£ è¡¨ç¤ºè§£æå™¨ï¼Œé»˜è®¤å®ç°æ˜¯ org.springframework.expression.spel.standard åŒ…ä¸­çš„ SpelExpressionParser ç±»ï¼Œä½¿ç”¨ parseExpression æ–¹æ³•å°†å­—ç¬¦ä¸²è¡¨è¾¾å¼è½¬æ¢ä¸º Expression å¯¹è±¡ï¼Œå¯¹äº ParserContext æ¥å£ç”¨äºå®šä¹‰å­—ç¬¦ä¸²è¡¨è¾¾å¼æ˜¯ä¸æ˜¯æ¨¡æ¿ï¼ŒåŠæ¨¡æ¿å¼€å§‹ä¸ç»“æŸå­—ç¬¦ï¼š public interface ExpressionParser { Expression parseExpression(String expressionString) throws ParseException; Expression parseExpression(String expressionString, ParserContext context) throws ParseException; } æ¥çœ‹ä¸‹ç¤ºä¾‹ï¼š @Test public void testParserContext() { ExpressionParser parser = new SpelExpressionParser(); ParserContext parserContext = new ParserContext() { @Override public boolean isTemplate() { return true; } @Override public String getExpressionPrefix() { return &quot;#{&quot;; } @Override public String getExpressionSuffix() { return &quot;}&quot;; } }; String template = &quot;#{'Hello '}#{'World!'}&quot;; Expression expression = parser.parseExpression(template, parserContext); System.out.println(expression.getValue()); } åœ¨æ­¤æˆ‘ä»¬æ¼”ç¤ºçš„æ˜¯ä½¿ç”¨ ParserContext çš„æƒ…å†µï¼Œæ­¤å¤„å®šä¹‰äº† ParserContext å®ç°ï¼šå®šä¹‰è¡¨è¾¾å¼æ˜¯æ¨¡å—ï¼Œè¡¨è¾¾å¼å‰ç¼€ä¸º â€œ#{â€ï¼Œåç¼€ä¸ºâ€œ}â€ï¼›ä½¿ç”¨ parseExpression è§£ææ—¶ä¼ å…¥çš„æ¨¡æ¿å¿…é¡»ä»¥â€œ#{â€ å¼€å¤´ï¼Œä»¥ â€œ}â€ ç»“å°¾ï¼Œå¦‚ &quot;#{'Hello '}#{'World!'}&quot;ã€‚ é»˜è®¤ä¼ å…¥çš„å­—ç¬¦ä¸²è¡¨è¾¾å¼ä¸æ˜¯æ¨¡æ¿å½¢å¼ï¼Œå¦‚ä¹‹å‰æ¼”ç¤ºçš„ Hello Worldã€‚ EvaluationContext æ¥å£ è¡¨ç¤ºä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œé»˜è®¤å®ç°æ˜¯ org.springframework.expression.spel.support åŒ…ä¸­çš„ StandardEvaluationContext ç±»ï¼Œä½¿ç”¨ setRootObject æ–¹æ³•æ¥è®¾ç½®æ ¹å¯¹è±¡ï¼Œä½¿ç”¨ setVariable æ–¹æ³•æ¥æ³¨å†Œè‡ªå®šä¹‰å˜é‡ï¼Œä½¿ç”¨ registerFunction æ¥æ³¨å†Œè‡ªå®šä¹‰å‡½æ•°ç­‰ç­‰ã€‚ Expression æ¥å£ è¡¨ç¤ºè¡¨è¾¾å¼å¯¹è±¡ï¼Œé»˜è®¤å®ç°æ˜¯ org.springframework.expression.spel.standard åŒ…ä¸­çš„ SpelExpressionï¼Œæä¾› getValue æ–¹æ³•ç”¨äºè·å–è¡¨è¾¾å¼å€¼ï¼Œæä¾› setValue æ–¹æ³•ç”¨äºè®¾ç½®å¯¹è±¡å€¼ã€‚ äº†è§£äº† SpEL åŸç†åŠæ¥å£ï¼Œæ¥ä¸‹æ¥çš„äº‹æƒ…å°±æ˜¯ SpEL è¯­æ³•äº†ã€‚ SpEL è¯­æ³• åŸºæœ¬è¡¨è¾¾å¼ å­—é¢é‡è¡¨è¾¾å¼ SpEL æ”¯æŒçš„å­—é¢é‡åŒ…æ‹¬ï¼šå­—ç¬¦ä¸²ã€æ•°å­—ç±»å‹ï¼ˆintã€longã€floatã€doubleï¼‰ã€å¸ƒå°”ç±»å‹ã€null ç±»å‹ã€‚ ç±»å‹ç¤ºä¾‹å­—ç¬¦ä¸² String str1 = parser.parseExpression(&quot;'Hello World!'&quot;).getValue(String.class); æ•°å­—ç±»å‹ int int1 = parser.parseExpression(&quot;1&quot;).getValue(Integer.class); long long1 = parser.parseExpression(&quot;-1L&quot;).getValue(long.class); float float1 = parser.parseExpression(&quot;1.1&quot;).getValue(Float.class); double double1 = parser.parseExpression(&quot;1.1E+2&quot;).getValue(double.class); int hex1 = parser.parseExpression(&quot;0xa&quot;).getValue(Integer.class); long hex2 = parser.parseExpression(&quot;0xaL&quot;).getValue(long.class); å¸ƒå°”ç±»å‹ boolean true1 = parser.parseExpression(&quot;true&quot;).getValue(boolean.class); boolean false1 = parser.parseExpression(&quot;false&quot;).getValue(boolean.class);null ç±»å‹ Object null1 = parser.parseExpression(&quot;null&quot;).getValue(Object.class); @Test public void test2() { ExpressionParser parser = new SpelExpressionParser(); String str1 = parser.parseExpression(&quot;'Hello World!'&quot;).getValue(String.class); int int1 = parser.parseExpression(&quot;1&quot;).getValue(Integer.class); long long1 = parser.parseExpression(&quot;-1L&quot;).getValue(long.class); float float1 = parser.parseExpression(&quot;1.1&quot;).getValue(Float.class); double double1 = parser.parseExpression(&quot;1.1E+2&quot;).getValue(double.class); int hex1 = parser.parseExpression(&quot;0xa&quot;).getValue(Integer.class); long hex2 = parser.parseExpression(&quot;0xaL&quot;).getValue(long.class); boolean true1 = parser.parseExpression(&quot;true&quot;).getValue(boolean.class); boolean false1 = parser.parseExpression(&quot;false&quot;).getValue(boolean.class); Object null1 = parser.parseExpression(&quot;null&quot;).getValue(Object.class); System.out.println(&quot;str1=&quot; + str1); System.out.println(&quot;int1=&quot; + int1); System.out.println(&quot;long1=&quot; + long1); System.out.println(&quot;float1=&quot; + float1); System.out.println(&quot;double1=&quot; + double1); System.out.println(&quot;hex1=&quot; + hex1); System.out.println(&quot;hex2=&quot; + hex2); System.out.println(&quot;true1=&quot; + true1); System.out.println(&quot;false1=&quot; + false1); System.out.println(&quot;null1=&quot; + null1); } è¾“å‡º str1=Hello World! int1=1 long1=-1 float1=1.1 double1=110.0 hex1=10 hex2=10 true1=true false1=false null1=null ç®—æ•°è¿ç®—è¡¨è¾¾å¼ SpEL æ”¯æŒåŠ  (+)ã€å‡ (-)ã€ä¹˜ (*)ã€é™¤ (/)ã€æ±‚ä½™ï¼ˆ%ï¼‰ã€å¹‚ï¼ˆ^ï¼‰è¿ç®—ã€‚ ç±»å‹ç¤ºä¾‹åŠ å‡ä¹˜é™¤ int result1 = parser.parseExpression(&quot;1+2-3*4/2&quot;).getValue(Integer.class);//-3 æ±‚ä½™ int result2 = parser.parseExpression(&quot;4%3&quot;).getValue(Integer.class);//1 å¹‚è¿ç®— int result3 = parser.parseExpression(&quot;2^3&quot;).getValue(Integer.class);//8 SpEL è¿˜æä¾›æ±‚ä½™ï¼ˆMODï¼‰å’Œé™¤ï¼ˆDIVï¼‰è€Œå¤–ä¸¤ä¸ªè¿ç®—ç¬¦ï¼Œä¸ â€œ%â€ å’Œâ€œ/â€ç­‰ä»·ï¼Œä¸åŒºåˆ†å¤§å°å†™ã€‚ å…³ç³»è¡¨è¾¾å¼ ç­‰äºï¼ˆ==ï¼‰ã€ä¸ç­‰äº (!=)ã€å¤§äº (&gt;)ã€å¤§äºç­‰äº (&gt;=)ã€å°äº (&lt;)ã€å°äºç­‰äº (&lt;=)ï¼ŒåŒºé—´ï¼ˆbetweenï¼‰è¿ç®—ã€‚ å¦‚parser.parseExpression(&quot;1&gt;2&quot;).getValue(boolean.class);å°†è¿”å› falseï¼› è€Œparser.parseExpression(&quot;1 between {1, 2}&quot;).getValue(boolean.class);å°†è¿”å› trueã€‚ betweenè¿ç®—ç¬¦å³è¾¹æ“ä½œæ•°å¿…é¡»æ˜¯åˆ—è¡¨ç±»å‹ï¼Œä¸”åªèƒ½åŒ…å«2ä¸ªå…ƒç´ ã€‚ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºå¼€å§‹ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸ºç»“æŸï¼ŒåŒºé—´è¿ç®—æ˜¯åŒ…å«è¾¹ç•Œå€¼çš„ï¼Œå³ xxx&gt;=list.get(0) &amp;&amp; xxx&lt;=list.get(1)ã€‚ SpEL åŒæ ·æä¾›äº†ç­‰ä»·çš„ â€œEQâ€ ã€â€œNEâ€ã€ â€œGTâ€ã€â€œGEâ€ã€ â€œLTâ€ ã€â€œLEâ€ æ¥è¡¨ç¤ºç­‰äºã€ä¸ç­‰äºã€å¤§äºã€å¤§äºç­‰äºã€å°äºã€å°äºç­‰äºï¼Œä¸åŒºåˆ†å¤§å°å†™ã€‚ @Test public void test3() { ExpressionParser parser = new SpelExpressionParser(); boolean v1 = parser.parseExpression(&quot;1&gt;2&quot;).getValue(boolean.class); boolean between1 = parser.parseExpression(&quot;1 between {1,2}&quot;).getValue(boolean.class); System.out.println(&quot;v1=&quot; + v1); System.out.println(&quot;between1=&quot; + between1); } è¾“å‡º v1=false between1=true é€»è¾‘è¡¨è¾¾å¼ ä¸”ï¼ˆand æˆ–è€… &amp;&amp;ï¼‰ã€æˆ– (or æˆ–è€… ||)ã€é (! æˆ– NOT)ã€‚ @Test public void test4() { ExpressionParser parser = new SpelExpressionParser(); boolean result1 = parser.parseExpression(&quot;2&gt;1 and (!true or !false)&quot;).getValue(boolean.class); boolean result2 = parser.parseExpression(&quot;2&gt;1 &amp;&amp; (!true || !false)&quot;).getValue(boolean.class); boolean result3 = parser.parseExpression(&quot;2&gt;1 and (NOT true or NOT false)&quot;).getValue(boolean.class); boolean result4 = parser.parseExpression(&quot;2&gt;1 &amp;&amp; (NOT true || NOT false)&quot;).getValue(boolean.class); System.out.println(&quot;result1=&quot; + result1); System.out.println(&quot;result2=&quot; + result2); System.out.println(&quot;result3=&quot; + result3); System.out.println(&quot;result4=&quot; + result4); } è¾“å‡º result1=true result2=true result3=true result4=false å­—ç¬¦ä¸²è¿æ¥åŠæˆªå–è¡¨è¾¾å¼ ä½¿ç”¨ â€œ+â€ è¿›è¡Œå­—ç¬¦ä¸²è¿æ¥ï¼Œä½¿ç”¨ â€œ'String'[0] [index]â€ æ¥æˆªå–ä¸€ä¸ªå­—ç¬¦ï¼Œç›®å‰åªæ”¯æŒæˆªå–ä¸€ä¸ªï¼Œå¦‚ â€œ'Hello' + 'World!'â€ å¾—åˆ° â€œHello World!â€ï¼›è€Œâ€œ'Hello World!'[0]â€ å°†è¿”å›â€œHâ€ã€‚ ä¸‰ç›®è¿ç®— ä¸‰ç›®è¿ç®—ç¬¦ â€œè¡¨è¾¾å¼ 1? è¡¨è¾¾å¼ 2: è¡¨è¾¾å¼ 3â€ ç”¨äºæ„é€ ä¸‰ç›®è¿ç®—è¡¨è¾¾å¼ï¼Œå¦‚ â€œ2&gt;1?true:falseâ€ å°†è¿”å› trueï¼› Elivis è¿ç®—ç¬¦ Elivis è¿ç®—ç¬¦ â€œè¡¨è¾¾å¼ 1?: è¡¨è¾¾å¼ 2â€ ä» Groovy è¯­è¨€å¼•å…¥ç”¨äºç®€åŒ–ä¸‰ç›®è¿ç®—ç¬¦çš„ï¼Œå½“è¡¨è¾¾å¼ 1 ä¸ºé null æ—¶åˆ™è¿”å›è¡¨è¾¾å¼ 1ï¼Œå½“è¡¨è¾¾å¼ 1 ä¸º null æ—¶åˆ™è¿”å›è¡¨è¾¾å¼ 2ï¼Œç®€åŒ–äº†ä¸‰ç›®è¿ç®—ç¬¦æ–¹å¼ â€œè¡¨è¾¾å¼ 1? è¡¨è¾¾å¼ 1: è¡¨è¾¾å¼ 2â€ï¼Œå¦‚â€œnull?:falseâ€ å°†è¿”å› falseï¼Œè€Œ â€œtrue?:falseâ€ å°†è¿”å› trueï¼› æ­£åˆ™è¡¨è¾¾å¼ ä½¿ç”¨ â€œstr matches regexï¼Œå¦‚â€œ'123' matches '\\d{3}'â€ å°†è¿”å› trueï¼› æ‹¬å·ä¼˜å…ˆçº§è¡¨è¾¾å¼ ä½¿ç”¨ â€œ(è¡¨è¾¾å¼)â€ æ„é€ ï¼Œæ‹¬å·é‡Œçš„å…·æœ‰é«˜ä¼˜å…ˆçº§ã€‚ ç±»ç›¸å…³è¡¨è¾¾å¼ ç±»ç±»å‹è¡¨è¾¾å¼ ä½¿ç”¨ â€œT(Type)â€ æ¥è¡¨ç¤º java.lang.Class å®ä¾‹ï¼Œâ€œTypeâ€å¿…é¡»æ˜¯ç±»å…¨é™å®šåï¼Œâ€œjava.langâ€åŒ…é™¤å¤–ï¼Œå³è¯¥åŒ…ä¸‹çš„ç±»å¯ä»¥ä¸æŒ‡å®šåŒ…åï¼›ä½¿ç”¨ç±»ç±»å‹è¡¨è¾¾å¼è¿˜å¯ä»¥è¿›è¡Œè®¿é—®ç±»é™æ€æ–¹æ³•åŠç±»é™æ€å­—æ®µã€‚ å…·ä½“ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š @Test public void testClassTypeExpression() { ExpressionParser parser = new SpelExpressionParser(); //java.langåŒ…ç±»è®¿é—® Class&lt;String&gt; result1 = parser.parseExpression(&quot;T(String)&quot;).getValue(Class.class); System.out.println(result1); //å…¶ä»–åŒ…ç±»è®¿é—® String expression2 = &quot;T(com.javacode2018.spel.SpelTest)&quot;; Class&lt;SpelTest&gt; value = parser.parseExpression(expression2).getValue(Class.class); System.out.println(value == SpelTest.class); //ç±»é™æ€å­—æ®µè®¿é—® int result3 = parser.parseExpression(&quot;T(Integer).MAX_VALUE&quot;).getValue(int.class); System.out.println(result3 == Integer.MAX_VALUE); //ç±»é™æ€æ–¹æ³•è°ƒç”¨ int result4 = parser.parseExpression(&quot;T(Integer).parseInt('1')&quot;).getValue(int.class); System.out.println(result4); } è¾“å‡º class java.lang.String true true 1 å¯¹äº java.lang åŒ…é‡Œçš„å¯ä»¥ç›´æ¥ä½¿ç”¨ â€œT(String)â€ è®¿é—®ï¼›å…¶ä»–åŒ…å¿…é¡»æ˜¯ç±»å…¨é™å®šåï¼›å¯ä»¥è¿›è¡Œé™æ€å­—æ®µè®¿é—®å¦‚â€œT(Integer).MAX_VALUEâ€ï¼›ä¹Ÿå¯ä»¥è¿›è¡Œé™æ€æ–¹æ³•è®¿é—®å¦‚â€œT(Integer).parseInt('1')â€ã€‚ ç±»å®ä¾‹åŒ– ç±»å®ä¾‹åŒ–åŒæ ·ä½¿ç”¨ java å…³é”®å­— â€œnewâ€ï¼Œç±»åå¿…é¡»æ˜¯å…¨é™å®šåï¼Œä½† java.lang åŒ…å†…çš„ç±»å‹é™¤å¤–ï¼Œå¦‚ Stringã€Integerã€‚ @Test public void testConstructorExpression() { ExpressionParser parser = new SpelExpressionParser(); String result1 = parser.parseExpression(&quot;new String('è·¯äººç”²java')&quot;).getValue(String.class); System.out.println(result1); Date result2 = parser.parseExpression(&quot;new java.util.Date()&quot;).getValue(Date.class); System.out.println(result2); } å®ä¾‹åŒ–å®Œå…¨è·Ÿ Java å†…æ–¹å¼ä¸€æ ·ï¼Œè¿è¡Œè¾“å‡º è·¯äººç”²java Tue Aug 03 20:22:43 CST 2020 instanceof è¡¨è¾¾å¼ SpEL æ”¯æŒ instanceof è¿ç®—ç¬¦ï¼Œè·Ÿ Java å†…ä½¿ç”¨åŒä¹‰ï¼›å¦‚ â€œ'haha' instanceof T(String)â€ å°†è¿”å› trueã€‚ @Test public void testInstanceOfExpression() { ExpressionParser parser = new SpelExpressionParser(); Boolean value = parser.parseExpression(&quot;'è·¯äººç”²' instanceof T(String)&quot;).getValue(Boolean.class); System.out.println(value); } è¾“å‡º true å˜é‡å®šä¹‰åŠå¼•ç”¨ å˜é‡å®šä¹‰é€šè¿‡ EvaluationContext æ¥å£çš„ setVariable(variableName, value) æ–¹æ³•å®šä¹‰ï¼›åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨&quot;#variableName&quot;å¼•ç”¨ï¼›é™¤äº†å¼•ç”¨è‡ªå®šä¹‰å˜é‡ï¼ŒSpE è¿˜å…è®¸å¼•ç”¨æ ¹å¯¹è±¡åŠå½“å‰ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œä½¿ç”¨&quot;#root&quot;å¼•ç”¨æ ¹å¯¹è±¡ï¼Œä½¿ç”¨&quot;#this&quot;å¼•ç”¨å½“å‰ä¸Šä¸‹æ–‡å¯¹è±¡ï¼› @Test public void testVariableExpression() { ExpressionParser parser = new SpelExpressionParser(); EvaluationContext context = new StandardEvaluationContext(); context.setVariable(&quot;name&quot;, &quot;è·¯äººç”²java&quot;); context.setVariable(&quot;lesson&quot;, &quot;Springç³»åˆ—&quot;); //è·å–nameå˜é‡ï¼Œlessonå˜é‡ String name = parser.parseExpression(&quot;#name&quot;).getValue(context, String.class); System.out.println(name); String lesson = parser.parseExpression(&quot;#lesson&quot;).getValue(context, String.class); System.out.println(lesson); //StandardEvaluationContextæ„é€ å™¨ä¼ å…¥rootå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡#rootæ¥è®¿é—®rootå¯¹è±¡ context = new StandardEvaluationContext(&quot;æˆ‘æ˜¯rootå¯¹è±¡&quot;); String rootObj = parser.parseExpression(&quot;#root&quot;).getValue(context, String.class); System.out.println(rootObj); //#thisç”¨æ¥è®¿é—®å½“å‰ä¸Šçº¿æ–‡ä¸­çš„å¯¹è±¡ String thisObj = parser.parseExpression(&quot;#this&quot;).getValue(context, String.class); System.out.println(thisObj); } è¾“å‡º è·¯äººç”²java Springç³»åˆ— æˆ‘æ˜¯rootå¯¹è±¡ æˆ‘æ˜¯rootå¯¹è±¡ ä½¿ç”¨ â€œ#variableâ€ æ¥å¼•ç”¨åœ¨ EvaluationContext å®šä¹‰çš„å˜é‡ï¼›é™¤äº†å¯ä»¥å¼•ç”¨è‡ªå®šä¹‰å˜é‡ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ â€œ#rootâ€ å¼•ç”¨æ ¹å¯¹è±¡ï¼Œâ€œ#thisâ€å¼•ç”¨å½“å‰ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œæ­¤å¤„ â€œ#thisâ€ å³æ ¹å¯¹è±¡ã€‚ è‡ªå®šä¹‰å‡½æ•° ç›®å‰åªæ”¯æŒç±»é™æ€æ–¹æ³•æ³¨å†Œä¸ºè‡ªå®šä¹‰å‡½æ•°ï¼›SpEL ä½¿ç”¨ StandardEvaluationContext çš„ registerFunction æ–¹æ³•è¿›è¡Œæ³¨å†Œè‡ªå®šä¹‰å‡½æ•°ï¼Œå…¶å®å®Œå…¨å¯ä»¥ä½¿ç”¨ setVariable ä»£æ›¿ï¼Œä¸¤è€…å…¶å®æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼› @Test public void testFunctionExpression() throws SecurityException, NoSuchMethodException { //å®šä¹‰2ä¸ªå‡½æ•°,registerFunctionå’ŒsetVariableéƒ½å¯ä»¥ï¼Œä¸è¿‡ä»è¯­ä¹‰ä¸Šé¢æ¥çœ‹ç”¨registerFunctionæ›´æ°å½“ StandardEvaluationContext context = new StandardEvaluationContext(); Method parseInt = Integer.class.getDeclaredMethod(&quot;parseInt&quot;, String.class); context.registerFunction(&quot;parseInt1&quot;, parseInt); context.setVariable(&quot;parseInt2&quot;, parseInt); ExpressionParser parser = new SpelExpressionParser(); System.out.println(parser.parseExpression(&quot;#parseInt1('3')&quot;).getValue(context, int.class)); System.out.println(parser.parseExpression(&quot;#parseInt2('3')&quot;).getValue(context, int.class)); String expression1 = &quot;#parseInt1('3') == #parseInt2('3')&quot;; boolean result1 = parser.parseExpression(expression1).getValue(context, boolean.class); System.out.println(result1); } æ­¤å¤„å¯ä»¥çœ‹å‡º â€œregisterFunctionâ€ å’Œâ€œsetVariableâ€éƒ½å¯ä»¥æ³¨å†Œè‡ªå®šä¹‰å‡½æ•°ï¼Œä½†æ˜¯ä¸¤ä¸ªæ–¹æ³•çš„å«ä¹‰ä¸ä¸€æ ·ï¼Œæ¨èä½¿ç”¨ â€œregisterFunctionâ€ æ–¹æ³•æ³¨å†Œè‡ªå®šä¹‰å‡½æ•°ã€‚ è¿è¡Œè¾“å‡º 3 3 true è¡¨è¾¾å¼èµ‹å€¼ ä½¿ç”¨Expression#setValueæ–¹æ³•å¯ä»¥ç»™è¡¨è¾¾å¼èµ‹å€¼ @Test public void testAssignExpression1() { Object user = new Object() { private String name; public String getName() { return name; } public void setName(String name) { this.name = name; } @Override public String toString() { return &quot;$classname{&quot; + &quot; + name + '\\'' + '}'; } }; { //userä¸ºrootå¯¹è±¡ ExpressionParser parser = new SpelExpressionParser(); EvaluationContext context = new StandardEvaluationContext(user); parser.parseExpression(&quot;#root.name&quot;).setValue(context, &quot;è·¯äººç”²java&quot;); System.out.println(parser.parseExpression(&quot;#root&quot;).getValue(context, user.getClass())); } { //userä¸ºå˜é‡ ExpressionParser parser = new SpelExpressionParser(); EvaluationContext context = new StandardEvaluationContext(); context.setVariable(&quot;user&quot;, user); parser.parseExpression(&quot;#user.name&quot;).setValue(context, &quot;è·¯äººç”²java&quot;); System.out.println(parser.parseExpression(&quot;#user&quot;).getValue(context, user.getClass())); } } è¿è¡Œè¾“å‡º $classname{name='è·¯äººç”²java'} $classname{name='è·¯äººç”²java'} å¯¹è±¡å±æ€§å­˜å–åŠå®‰å…¨å¯¼èˆªè¡¨è¾¾å¼ å¯¹è±¡å±æ€§è·å–éå¸¸ç®€å•ï¼Œå³ä½¿ç”¨å¦‚ â€œa.property.propertyâ€ è¿™ç§ç‚¹ç¼€å¼è·å–ï¼ŒSpEL å¯¹äºå±æ€§åé¦–å­—æ¯æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼›SpEL è¿˜å¼•å…¥äº† Groovy è¯­è¨€ä¸­çš„å®‰å…¨å¯¼èˆªè¿ç®—ç¬¦â€œ(å¯¹è±¡ | å±æ€§)?. å±æ€§â€ï¼Œç”¨æ¥é¿å… â€œ?.â€ å‰è¾¹çš„è¡¨è¾¾å¼ä¸º null æ—¶æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œè€Œæ˜¯è¿”å› nullï¼›ä¿®æ”¹å¯¹è±¡å±æ€§å€¼åˆ™å¯ä»¥é€šè¿‡èµ‹å€¼è¡¨è¾¾å¼æˆ– Expression æ¥å£çš„ setValue æ–¹æ³•ä¿®æ”¹ã€‚ public static class Car { private String name; public String getName() { return name; } public void setName(String name) { this.name = name; } @Override public String toString() { return &quot;Car{&quot; + &quot; + name + '\\'' + '}'; } } public static class User { private Car car; public Car getCar() { return car; } public void setCar(Car car) { this.car = car; } @Override public String toString() { return &quot;User{&quot; + &quot;car=&quot; + car + '}'; } } @Test public void test5() { User user = new User(); EvaluationContext context = new StandardEvaluationContext(); context.setVariable(&quot;user&quot;, user); ExpressionParser parser = new SpelExpressionParser(); //ä½¿ç”¨.ç¬¦å·ï¼Œè®¿é—®user.car.nameä¼šæŠ¥é”™ï¼ŒåŸå› ï¼šuser.carä¸ºç©º try { System.out.println(parser.parseExpression(&quot;#user.car.name&quot;).getValue(context, String.class)); } catch (EvaluationException | ParseException e) { System.out.println(&quot;å‡ºé”™äº†ï¼š&quot; + e.getMessage()); } //ä½¿ç”¨å®‰å…¨è®¿é—®ç¬¦å·?.ï¼Œå¯ä»¥è§„é¿nullé”™è¯¯ System.out.println(parser.parseExpression(&quot;#user?.car?.name&quot;).getValue(context, String.class)); Car car = new Car(); car.setName(&quot;ä¿æ—¶æ·&quot;); user.setCar(car); System.out.println(parser.parseExpression(&quot;#user?.car?.toString()&quot;).getValue(context, String.class)); } è¿è¡Œè¾“å‡º å‡ºé”™äº†ï¼šEL1007E: Property or field 'name' cannot be found on null null Car{name='ä¿æ—¶æ·'} å¯¹è±¡æ–¹æ³•è°ƒç”¨ å¯¹è±¡æ–¹æ³•è°ƒç”¨æ›´ç®€å•ï¼Œè·Ÿ Java è¯­æ³•ä¸€æ ·ï¼›å¦‚ â€œ'haha'.substring(2,4)â€ å°†è¿”å›â€œhaâ€ï¼›è€Œå¯¹äºæ ¹å¯¹è±¡å¯ä»¥ç›´æ¥è°ƒç”¨æ–¹æ³•ï¼› Bean å¼•ç”¨ SpEL æ”¯æŒä½¿ç”¨ â€œ@â€ ç¬¦å·æ¥å¼•ç”¨ Beanï¼Œåœ¨å¼•ç”¨ Bean æ—¶éœ€è¦ä½¿ç”¨ BeanResolver æ¥å£å®ç°æ¥æŸ¥æ‰¾ Beanï¼ŒSpring æä¾› BeanFactoryResolver å®ç°ã€‚ @Test public void test6() { DefaultListableBeanFactory factory = new DefaultListableBeanFactory(); User user = new User(); Car car = new Car(); car.setName(&quot;ä¿æ—¶æ·&quot;); user.setCar(car); factory.registerSingleton(&quot;user&quot;, user); StandardEvaluationContext context = new StandardEvaluationContext(); context.setBeanResolver(new BeanFactoryResolver(factory)); ExpressionParser parser = new SpelExpressionParser(); User userBean = parser.parseExpression(&quot;@user&quot;).getValue(context, User.class); System.out.println(userBean); System.out.println(userBean == factory.getBean(&quot;user&quot;)); } è¿è¡Œè¾“å‡º User{car=Car{name='ä¿æ—¶æ·'}} true é›†åˆç›¸å…³è¡¨è¾¾å¼ å†…è” List ä» Spring3.0.4 å¼€å§‹æ”¯æŒå†…è” Listï¼Œä½¿ç”¨ {è¡¨è¾¾å¼ï¼Œâ€¦â€¦} å®šä¹‰å†…è” Listï¼Œå¦‚ â€œ{1,2,3}â€ å°†è¿”å›ä¸€ä¸ªæ•´å‹çš„ ArrayListï¼Œè€Œ â€œ{}â€ å°†è¿”å›ç©ºçš„ Listï¼Œå¯¹äºå­—é¢é‡è¡¨è¾¾å¼åˆ—è¡¨ï¼ŒSpEL ä¼šä½¿ç”¨ java.util.Collections.unmodifiableList æ–¹æ³•å°†åˆ—è¡¨è®¾ç½®ä¸ºä¸å¯ä¿®æ”¹ã€‚ @Test public void test7() { ExpressionParser parser = new SpelExpressionParser(); //å°†è¿”å›ä¸å¯ä¿®æ”¹çš„ç©ºList List&lt;Integer&gt; result2 = parser.parseExpression(&quot;{}&quot;).getValue(List.class); //å¯¹äºå­—é¢é‡åˆ—è¡¨ä¹Ÿå°†è¿”å›ä¸å¯ä¿®æ”¹çš„List List&lt;Integer&gt; result1 = parser.parseExpression(&quot;{1,2,3}&quot;).getValue(List.class); Assert.assertEquals(new Integer(1), result1.get(0)); try { result1.set(0, 2); } catch (Exception e) { e.printStackTrace(); } //å¯¹äºåˆ—è¡¨ä¸­åªè¦æœ‰ä¸€ä¸ªä¸æ˜¯å­—é¢é‡è¡¨è¾¾å¼ï¼Œå°†åªè¿”å›åŸå§‹Listï¼Œ //ä¸ä¼šè¿›è¡Œä¸å¯ä¿®æ”¹å¤„ç† String expression3 = &quot;{{1+2,2+4},{3,4+4}}&quot;; List&lt;List&lt;Integer&gt;&gt; result3 = parser.parseExpression(expression3).getValue(List.class); result3.get(0).set(0, 1); System.out.println(result3); //å£°æ˜äºŒç»´æ•°ç»„å¹¶åˆå§‹åŒ– int[] result4 = parser.parseExpression(&quot;new int[2]{1,2}&quot;).getValue(int[].class); System.out.println(result4[1]); //å®šä¹‰ä¸€ç»´æ•°ç»„å¹¶åˆå§‹åŒ– int[] result5 = parser.parseExpression(&quot;new int[1]&quot;).getValue(int[].class); System.out.println(result5[0]); } è¾“å‡º java.lang.UnsupportedOperationException at java.util.Collections$UnmodifiableList.set(Collections.java:1311) at com.javacode2018.spel.SpelTest.test7(SpelTest.java:315) [[1, 6], [3, 8]] 2 0 å†…è”æ•°ç»„ å’Œ Java æ•°ç»„å®šä¹‰ç±»ä¼¼ï¼Œåªæ˜¯åœ¨å®šä¹‰æ—¶è¿›è¡Œå¤šç»´æ•°ç»„åˆå§‹åŒ–ã€‚ int[][][] result4 = parser.parseExpression(&quot;new int[1][2][3]{{1}{2}{3}}&quot;).getValue(int[][][].class); é›†åˆï¼Œå­—å…¸å…ƒç´ è®¿é—® SpEL ç›®å‰æ”¯æŒæ‰€æœ‰é›†åˆç±»å‹å’Œå­—å…¸ç±»å‹çš„å…ƒç´ è®¿é—®ï¼Œä½¿ç”¨ â€œé›†åˆ[ç´¢å¼•]â€ è®¿é—®é›†åˆå…ƒç´ ï¼Œä½¿ç”¨ â€œmap[key]â€ è®¿é—®å­—å…¸å…ƒç´ ï¼› //SpELå†…è”Listè®¿é—® int result1 = parser.parseExpression(&quot;{1,2,3}[0]&quot;).getValue(int.class); //SpELç›®å‰æ”¯æŒæ‰€æœ‰é›†åˆç±»å‹çš„è®¿é—® Collection&lt;Integer&gt; collection = new HashSet&lt;Integer&gt;(); collection.add(1); collection.add(2); EvaluationContext context2 = new StandardEvaluationContext(); context2.setVariable(&quot;collection&quot;, collection); int result2 = parser.parseExpression(&quot;#collection[1]&quot;).getValue(context2, int.class); //SpELå¯¹Mapå­—å…¸å…ƒç´ è®¿é—®çš„æ”¯æŒ Map&lt;String, Integer&gt; map = new HashMap&lt;String, Integer&gt;(); map.put(&quot;a&quot;, 1); EvaluationContext context3 = new StandardEvaluationContext(); context3.setVariable(&quot;map&quot;, map); int result3 = parser.parseExpression(&quot;#map['a']&quot;).getValue(context3, int.class); åˆ—è¡¨ï¼Œå­—å…¸ï¼Œæ•°ç»„å…ƒç´ ä¿®æ”¹ å¯ä»¥ä½¿ç”¨èµ‹å€¼è¡¨è¾¾å¼æˆ– Expression æ¥å£çš„ setValue æ–¹æ³•ä¿®æ”¹ï¼› @Test public void test8() { ExpressionParser parser = new SpelExpressionParser(); //ä¿®æ”¹listå…ƒç´ å€¼ List&lt;Integer&gt; list = new ArrayList&lt;Integer&gt;(); list.add(1); list.add(2); EvaluationContext context1 = new StandardEvaluationContext(); context1.setVariable(&quot;collection&quot;, list); parser.parseExpression(&quot;#collection[1]&quot;).setValue(context1, 4); int result1 = parser.parseExpression(&quot;#collection[1]&quot;).getValue(context1, int.class); System.out.println(result1); //ä¿®æ”¹mapå…ƒç´ å€¼ Map&lt;String, Integer&gt; map = new HashMap&lt;String, Integer&gt;(); map.put(&quot;a&quot;, 1); EvaluationContext context2 = new StandardEvaluationContext(); context2.setVariable(&quot;map&quot;, map); parser.parseExpression(&quot;#map['a']&quot;).setValue(context2, 4); Integer result2 = parser.parseExpression(&quot;#map['a']&quot;).getValue(context2, int.class); System.out.println(result2); } è¾“å‡º 4 4 é›†åˆæŠ•å½± åœ¨ SQL ä¸­æŠ•å½±æŒ‡ä»è¡¨ä¸­é€‰æ‹©å‡ºåˆ—ï¼Œè€Œåœ¨ SpEL æŒ‡æ ¹æ®é›†åˆä¸­çš„å…ƒç´ ä¸­é€šè¿‡é€‰æ‹©æ¥æ„é€ å¦ä¸€ä¸ªé›†åˆï¼Œè¯¥é›†åˆå’ŒåŸé›†åˆå…·æœ‰ç›¸åŒæ•°é‡çš„å…ƒç´ ï¼›SpEL ä½¿ç”¨ â€œï¼ˆlist|mapï¼‰.![æŠ•å½±è¡¨è¾¾å¼]â€ æ¥è¿›è¡ŒæŠ•å½±è¿ç®—ï¼š @Test public void test9() { ExpressionParser parser = new SpelExpressionParser(); //1.æµ‹è¯•é›†åˆæˆ–æ•°ç»„ List&lt;Integer&gt; list = new ArrayList&lt;Integer&gt;(); list.add(4); list.add(5); EvaluationContext context1 = new StandardEvaluationContext(); context1.setVariable(&quot;list&quot;, list); Collection&lt;Integer&gt; result1 = parser.parseExpression(&quot;#list.![#this+1]&quot;).getValue(context1, Collection.class); result1.forEach(System.out::println); System.out.println(&quot;------------&quot;); //2.æµ‹è¯•å­—å…¸ Map&lt;String, Integer&gt; map = new HashMap&lt;String, Integer&gt;(); map.put(&quot;a&quot;, 1); map.put(&quot;b&quot;, 2); EvaluationContext context2 = new StandardEvaluationContext(); context2.setVariable(&quot;map&quot;, map); List&lt;Integer&gt; result2 = parser.parseExpression(&quot;#map.![value+1]&quot;).getValue(context2, List.class); result2.forEach(System.out::println); } å¯¹äºé›†åˆæˆ–æ•°ç»„ä½¿ç”¨å¦‚ä¸Šè¡¨è¾¾å¼è¿›è¡ŒæŠ•å½±è¿ç®—ï¼Œå…¶ä¸­æŠ•å½±è¡¨è¾¾å¼ä¸­ â€œ#thisâ€ ä»£è¡¨æ¯ä¸ªé›†åˆæˆ–æ•°ç»„å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨æ¯”å¦‚ â€œ#this.propertyâ€ æ¥è·å–é›†åˆå…ƒç´ çš„å±æ€§ï¼Œå…¶ä¸­ â€œ#thisâ€ å¯ä»¥çœç•¥ã€‚ Map æŠ•å½±æœ€ç»ˆåªèƒ½å¾—åˆ° List ç»“æœï¼Œå¦‚ä¸Šæ‰€ç¤ºï¼Œå¯¹äºæŠ•å½±è¡¨è¾¾å¼ä¸­çš„ â€œ#thisâ€ å°†æ˜¯ Map.Entryï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ â€œvalueâ€ æ¥è·å–å€¼ï¼Œä½¿ç”¨ â€œkeyâ€ æ¥è·å–é”®ã€‚ é›†åˆé€‰æ‹© åœ¨ SQL ä¸­æŒ‡ä½¿ç”¨ select è¿›è¡Œé€‰æ‹©è¡Œæ•°æ®ï¼Œè€Œåœ¨ SpEL æŒ‡æ ¹æ®åŸé›†åˆé€šè¿‡æ¡ä»¶è¡¨è¾¾å¼é€‰æ‹©å‡ºæ»¡è¶³æ¡ä»¶çš„å…ƒç´ å¹¶æ„é€ ä¸ºæ–°çš„é›†åˆï¼ŒSpEL ä½¿ç”¨ â€œ(list|map).?[é€‰æ‹©è¡¨è¾¾å¼]â€ï¼Œå…¶ä¸­é€‰æ‹©è¡¨è¾¾å¼ç»“æœå¿…é¡»æ˜¯ boolean ç±»å‹ï¼Œå¦‚æœ true åˆ™é€‰æ‹©çš„å…ƒç´ å°†æ·»åŠ åˆ°æ–°é›†åˆä¸­ï¼Œfalse å°†ä¸æ·»åŠ åˆ°æ–°é›†åˆä¸­ã€‚ @Test public void test10() { ExpressionParser parser = new SpelExpressionParser(); //1.æµ‹è¯•é›†åˆæˆ–æ•°ç»„ List&lt;Integer&gt; list = new ArrayList&lt;Integer&gt;(); list.add(1); list.add(4); list.add(5); list.add(7); EvaluationContext context1 = new StandardEvaluationContext(); context1.setVariable(&quot;list&quot;, list); Collection&lt;Integer&gt; result1 = parser.parseExpression(&quot;#list.?[#this&gt;4]&quot;).getValue(context1, Collection.class); result1.forEach(System.out::println); System.out.println(&quot;------------&quot;); } è¾“å‡º 5 7 å¯¹äºé›†åˆæˆ–æ•°ç»„é€‰æ‹©ï¼Œå¦‚ â€œ#collection.?[#this&gt;4]â€ å°†é€‰æ‹©å‡ºé›†åˆå…ƒç´ å€¼å¤§äº 4 çš„æ‰€æœ‰å…ƒç´ ã€‚é€‰æ‹©è¡¨è¾¾å¼å¿…é¡»è¿”å›å¸ƒå°”ç±»å‹ï¼Œä½¿ç”¨ â€œ#thisâ€ è¡¨ç¤ºå½“å‰å…ƒç´ ã€‚ //2.æµ‹è¯•å­—å…¸ Map&lt;String, Integer&gt; map = new HashMap&lt;String, Integer&gt;(); map.put(&quot;a&quot;, 1); map.put(&quot;b&quot;, 2); map.put(&quot;c&quot;, 3); EvaluationContext context2 = new StandardEvaluationContext(); context2.setVariable(&quot;map&quot;, map); Map&lt;String, Integer&gt; result2 = parser.parseExpression(&quot;#map.?[key!='a']&quot;).getValue(context2, Map.class); result2.forEach((key, value) -&gt; { System.out.println(key + &quot;:&quot; + value); }); System.out.println(&quot;------------&quot;); List&lt;Integer&gt; result3 = parser.parseExpression(&quot;#map.?[key!='a'].![value+1]&quot;).getValue(context2, List.class); result3.forEach(System.out::println); è¾“å‡º b:2 c:3 ------------ 3 4 å¯¹äºå­—å…¸é€‰æ‹©ï¼Œå¦‚ â€œ#map.?[#this.key != 'a']â€ å°†é€‰æ‹©é”®å€¼ä¸ç­‰äºâ€aâ€çš„ï¼Œå…¶ä¸­é€‰æ‹©è¡¨è¾¾å¼ä¸­ â€œ#thisâ€ æ˜¯ Map.Entry ç±»å‹ï¼Œè€Œæœ€ç»ˆç»“æœè¿˜æ˜¯ Mapï¼Œè¿™ç‚¹å’ŒæŠ•å½±ä¸åŒï¼›é›†åˆé€‰æ‹©å’ŒæŠ•å½±å¯ä»¥ä¸€èµ·ä½¿ç”¨ï¼Œå¦‚ â€œ#map.?[key != 'a'].![value+1]â€ å°†é¦–å…ˆé€‰æ‹©é”®å€¼ä¸ç­‰äºâ€aâ€çš„ï¼Œç„¶ååœ¨é€‰å‡ºçš„ Map ä¸­å†è¿›è¡Œ â€œvalue+1â€ çš„æŠ•å½±ã€‚ è¡¨è¾¾å¼æ¨¡æ¿ æ¨¡æ¿è¡¨è¾¾å¼å°±æ˜¯ç”±å­—é¢é‡ä¸ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼å—ç»„æˆã€‚æ¯ä¸ªè¡¨è¾¾å¼å—ç”± â€œå‰ç¼€ + è¡¨è¾¾å¼ + åç¼€â€ å½¢å¼ç»„æˆï¼Œå¦‚ â€œ${1+2}â€ å³è¡¨è¾¾å¼å—ã€‚åœ¨å‰è¾¹æˆ‘ä»¬å·²ç»ä»‹ç»äº†ä½¿ç”¨ ParserContext æ¥å£å®ç°æ¥å®šä¹‰è¡¨è¾¾å¼æ˜¯å¦æ˜¯æ¨¡æ¿åŠå‰ç¼€å’Œåç¼€å®šä¹‰ã€‚åœ¨æ­¤å°±ä¸å¤šä»‹ç»äº†ï¼Œå¦‚ â€œError ${#v0} ${#v1}â€ è¡¨è¾¾å¼è¡¨ç¤ºç”±å­—é¢é‡ â€œError â€ã€æ¨¡æ¿è¡¨è¾¾å¼â€œ#v0â€ã€æ¨¡æ¿è¡¨è¾¾å¼â€œ#v1â€ ç»„æˆï¼Œå…¶ä¸­ v0 å’Œ v1 è¡¨ç¤ºè‡ªå®šä¹‰å˜é‡ï¼Œéœ€è¦åœ¨ä¸Šä¸‹æ–‡å®šä¹‰ã€‚ è§£æè¡¨è¾¾å¼çš„æ—¶å€™éœ€è¦æŒ‡å®šæ¨¡æ¿ï¼Œæ¨¡æ¿é€šè¿‡ParserContextæ¥å£æ¥å®šä¹‰ public interface ParserContext { //æ˜¯å¦æ˜¯æ¨¡æ¿ boolean isTemplate(); //æ¨¡æ¿è¡¨è¾¾å¼å‰ç¼€ String getExpressionPrefix(); //æ¨¡æ¿è¡¨è¾¾å¼åç¼€ String getExpressionSuffix(); } æœ‰ä¸ªå­ç±»ï¼Œæˆ‘ä»¬ç›´æ¥å¯ä»¥æ‹¿æ¥ç”¨ï¼šTemplateParserContextã€‚ @Test public void test11() { //åˆ›å»ºè§£æå™¨ SpelExpressionParser parser = new SpelExpressionParser(); //åˆ›å»ºè§£æå™¨ä¸Šä¸‹æ–‡ ParserContext context = new TemplateParserContext(&quot;%{&quot;, &quot;}&quot;); Expression expression = parser.parseExpression(&quot;ä½ å¥½:%{#name},æˆ‘ä»¬æ­£åœ¨å­¦ä¹ :%{#lesson}&quot;, context); //åˆ›å»ºè¡¨è¾¾å¼è®¡ç®—ä¸Šä¸‹æ–‡ EvaluationContext evaluationContext = new StandardEvaluationContext(); evaluationContext.setVariable(&quot;name&quot;, &quot;è·¯äººç”²java&quot;); evaluationContext.setVariable(&quot;lesson&quot;, &quot;springé«˜æ‰‹ç³»åˆ—!&quot;); //è·å–å€¼ String value = expression.getValue(evaluationContext, String.class); System.out.println(value); } è¿è¡Œè¾“å‡º ä½ å¥½:è·¯äººç”²java,æˆ‘ä»¬æ­£åœ¨å­¦ä¹ :springé«˜æ‰‹ç³»åˆ—! åœ¨ Bean å®šä¹‰ä¸­ä½¿ç”¨ spel è¡¨è¾¾å¼ xml é£æ ¼çš„é…ç½® SpEL æ”¯æŒåœ¨ Bean å®šä¹‰æ—¶æ³¨å…¥ï¼Œé»˜è®¤ä½¿ç”¨ â€œ#{SpEL è¡¨è¾¾å¼}â€ è¡¨ç¤ºï¼Œå…¶ä¸­ â€œ#rootâ€ æ ¹å¯¹è±¡é»˜è®¤å¯ä»¥è®¤ä¸ºæ˜¯ ApplicationContextï¼Œåªæœ‰ ApplicationContext å®ç°é»˜è®¤æ”¯æŒ SpELï¼Œè·å–æ ¹å¯¹è±¡å±æ€§å…¶å®æ˜¯è·å–å®¹å™¨ä¸­çš„ Beanã€‚ å¦‚ï¼š &lt;bean&gt; &lt;constructor-arg value=&quot;#{' World!'}&quot;/&gt; &lt;/bean&gt; &lt;bean&gt; &lt;constructor-arg value=&quot;#{'Hello'}#{world}&quot;/&gt; &lt;/bean&gt; &lt;bean&gt; &lt;constructor-arg value=&quot;#{'Hello' + world}&quot;/&gt; &lt;/bean&gt; &lt;bean&gt; &lt;constructor-arg value=&quot;#{'Hello' + @world}&quot;/&gt; &lt;/bean&gt; æ¨¡æ¿é»˜è®¤ä»¥å‰ç¼€ â€œ#{â€ å¼€å¤´ï¼Œä»¥åç¼€ â€œ}â€ ç»“å°¾ï¼Œä¸”ä¸å…è®¸åµŒå¥—ï¼Œå¦‚ â€œ#{'Hello'#{world}}â€ é”™è¯¯ï¼Œå¦‚ â€œ#{'Hello' + world}â€ ä¸­â€œworldâ€é»˜è®¤è§£æä¸º Beanã€‚å½“ç„¶å¯ä»¥ä½¿ç”¨ â€œ@beanâ€ å¼•ç”¨äº†ã€‚ æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œé™¤äº† XML é…ç½®æ–¹å¼ï¼ŒSpring è¿˜æä¾›ä¸€ç§æ³¨è§£æ–¹å¼ @Valueï¼Œæ¥ç€å¾€ä¸‹çœ‹å§ã€‚ æ³¨è§£é£æ ¼çš„é…ç½® åŸºäºæ³¨è§£é£æ ¼çš„ SpEL é…ç½®ä¹Ÿéå¸¸ç®€å•ï¼Œä½¿ç”¨ @Value æ³¨è§£æ¥æŒ‡å®š SpEL è¡¨è¾¾å¼ï¼Œè¯¥æ³¨è§£å¯ä»¥æ”¾åˆ°å­—æ®µã€æ–¹æ³•åŠæ–¹æ³•å‚æ•°ä¸Šã€‚ æµ‹è¯• Bean ç±»å¦‚ä¸‹ï¼Œä½¿ç”¨ @Value æ¥æŒ‡å®š SpEL è¡¨è¾¾å¼ï¼š public class SpELBean { @Value(&quot;#{'Hello' + world}&quot;) private String value; } åœ¨ Bean å®šä¹‰ä¸­ SpEL çš„é—®é¢˜ å¦‚æœæœ‰åŒå­¦é—® â€œ#{æˆ‘ä¸æ˜¯ SpEL è¡¨è¾¾å¼}â€ ä¸æ˜¯ SpEL è¡¨è¾¾å¼ï¼Œè€Œæ˜¯å…¬å¸å†…éƒ¨çš„æ¨¡æ¿ï¼Œæƒ³æ¢ä¸ªå‰ç¼€å’Œåç¼€è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿ æˆ‘ä»¬ä½¿ç”¨ BeanFactoryPostProcessor æ¥å£æä¾› postProcessBeanFactory å›è°ƒæ–¹æ³•ï¼Œå®ƒæ˜¯åœ¨ IoC å®¹å™¨åˆ›å»ºå¥½ä½†è¿˜æœªè¿›è¡Œä»»ä½• Bean åˆå§‹åŒ–æ—¶è¢« ApplicationContext å®ç°è°ƒç”¨ï¼Œå› æ­¤åœ¨è¿™ä¸ªé˜¶æ®µæŠŠ SpEL å‰ç¼€åŠåç¼€ä¿®æ”¹æ‰æ˜¯å®‰å…¨çš„ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š package com.javacode2018.spel.test1; import org.springframework.beans.BeansException; import org.springframework.beans.factory.config.BeanExpressionResolver; import org.springframework.beans.factory.config.BeanFactoryPostProcessor; import org.springframework.beans.factory.config.ConfigurableListableBeanFactory; import org.springframework.context.expression.StandardBeanExpressionResolver; import org.springframework.stereotype.Component; @Component public class SpelBeanFactoryPostProcessor implements BeanFactoryPostProcessor { @Override public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException { BeanExpressionResolver beanExpressionResolver = beanFactory.getBeanExpressionResolver(); if (beanExpressionResolver instanceof StandardBeanExpressionResolver) { StandardBeanExpressionResolver resolver = (StandardBeanExpressionResolver) beanExpressionResolver; resolver.setExpressionPrefix(&quot;%{&quot;); resolver.setExpressionSuffix(&quot;}&quot;); } } } ä¸Šæµ‹è¯•ä»£ç  package com.javacode2018.spel.test1; import org.springframework.beans.factory.annotation.Value; import org.springframework.stereotype.Component; @Component public class LessonModel { @Value(&quot;ä½ å¥½,%{@name},%{@msg}&quot;) private String desc; @Override public String toString() { return &quot;LessonModel{&quot; + &quot;desc='&quot; + desc + '\\'' + '}'; } } @nameï¼šå®¹å™¨ä¸­ name çš„ bean @msgï¼šå®¹å™¨ä¸­ msg çš„ bean ä¸‹é¢æˆ‘ä»¬æ¥ä¸ªé…ç½®ç±»ï¼Œé¡ºä¾¿å®šä¹‰ name å’Œ msg è¿™ 2 ä¸ª beanï¼Œé¡ºä¾¿æ‰«æä¸Šé¢ 2 ä¸ªé…ç½®ç±» package com.javacode2018.spel.test1; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.ComponentScan; import org.springframework.context.annotation.Configuration; @ComponentScan @Configuration public class MainConfig { @Bean public String name() { return &quot;è·¯ç²‰&quot;; } @Bean public String msg() { return &quot;æ¬¢è¿å’Œæˆ‘ä¸€èµ·å­¦ä¹ javaå„ç§æŠ€æœ¯ï¼&quot;; } } æµ‹è¯•ç”¨ä¾‹ @Test public void test12() { AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(); context.register(MainConfig.class); context.refresh(); LessonModel lessonModel = context.getBean(LessonModel.class); System.out.println(lessonModel); } è¿è¡Œè¾“å‡º LessonModel{desc='ä½ å¥½,è·¯ç²‰,æ¬¢è¿å’Œæˆ‘ä¸€èµ·å­¦ä¹ javaå„ç§æŠ€æœ¯ï¼'} æ€»ç»“ Spel åŠŸèƒ½è¿˜æ˜¯æ¯”è¾ƒå¼ºå¤§çš„ï¼Œå¯ä»¥è„±ç¦» spring ç¯å¢ƒç‹¬ç«‹è¿è¡Œ spel å¯ä»¥ç”¨åœ¨ä¸€äº›åŠ¨æ€è§„åˆ™çš„åŒ¹é…æ–¹é¢ï¼Œæ¯”å¦‚ç›‘æ§ç³»ç»Ÿä¸­ç›‘æ§è§„åˆ™çš„åŠ¨æ€åŒ¹é…ï¼›å…¶ä»–çš„ä¸€äº›æ¡ä»¶åŠ¨æ€åˆ¤æ–­ç­‰ç­‰ æœ¬æ–‡å†…å®¹æ¯”è¾ƒé•¿ï¼Œå»ºè®®å¤§å®¶æŠŠæ¡ˆä¾‹éƒ½æ•²ä¸€éï¼Œå¯ä»¥è®¾ç½®ä¸€äº›æ–­ç‚¹å»ç ”ç©¶ä¸€ä¸‹æºç ï¼Œæœ‰é—®é¢˜çš„ï¼Œæ¬¢è¿å¤§å®¶ç•™è¨€äº¤æµã€‚ æ¡ˆä¾‹æºç  https://gitee.com/javacode2018/spring-series ","tags":[{"index":-1,"name":"Java","slug":"SOje8Joqr","used":true,"link":"https://xuyj1111.github.io/SOje8Joqr/"},{"index":-1,"name":"è½¬è½½","slug":"JDrWa3FBq","used":true,"link":"https://xuyj1111.github.io/JDrWa3FBq/"}],"title":"ã€è½¬è½½ã€‘ç©è½¬Springä¸­å¼ºå¤§çš„spelè¡¨è¾¾å¼ï¼","feature":"","link":"https://xuyj1111.github.io/HSVGIODQf/","stats":{"text":"32 min read","time":1869000,"words":6875,"minutes":32},"date":"2023-02-16 16:45:50","dateFormat":"2023-02-16"},{"content":" æ³¨è§£@JsonIgnoreProperties, by å¼„ç‰x ä¸€ã€jackson çš„ mavern ä¾èµ– &lt;dependency&gt; &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt; &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt; &lt;version&gt;2.5.3&lt;/version&gt; &lt;/dependency&gt; äºŒã€ä½¿ç”¨çš„èƒŒæ™¯ springboot é¡¹ç›®ä¸­å®šä¹‰äº†å¾ˆå¤šç±»ï¼Œæˆ‘ä»¬åœ¨ rest è¿”å›ä¸­ç›´æ¥è¿”å›æˆ–è€…åœ¨è¿”å›å¯¹è±¡ä¸­ä½¿ç”¨è¿™äº›ç±»ï¼Œspring å·²ç»ä½¿ç”¨ jackson è‡ªåŠ¨å¸®æˆ‘ä»¬å®Œæˆè¿™äº›çš„ to jsonã€‚ä½†æ˜¯æœ‰æ—¶å€™è‡ªåŠ¨è½¬çš„ json å†…å®¹å¤ªå¤šï¼Œæˆ–è€…æ ¼å¼ä¸ç¬¦åˆæˆ‘ä»¬çš„æœŸæœ›ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ç±»çš„ to json è¿‡ç¨‹ï¼Œæˆ–è€…è¯´å¸Œæœ›è‡ªå®šä¹‰ç±»çš„ json è¿‡ç¨‹ã€‚ ä¸‰ã€@JsonProperty 1ã€æ¦‚å¿µï¼š æ­¤æ³¨è§£ç”¨äºå±æ€§ä¸Šï¼Œä½œç”¨æ˜¯æŠŠè¯¥å±æ€§çš„åç§°åºåˆ—åŒ–ä¸ºå¦å¤–ä¸€ä¸ªåç§°ï¼Œå¦‚æŠŠ trueName å±æ€§åºåˆ—åŒ–ä¸º nameï¼Œ@JsonProperty(â€œnameâ€)ã€‚ å¯¹å±æ€§åç§°é‡å‘½åï¼Œæ¯”å¦‚åœ¨å¾ˆå¤šåœºæ™¯ä¸‹ Java å¯¹è±¡çš„å±æ€§æ˜¯æŒ‰ç…§è§„èŒƒçš„é©¼å³°ä¹¦å†™ï¼Œä½†åœ¨æ•°æ®åº“è®¾è®¡æ—¶ä½¿ç”¨çš„æ˜¯ä¸‹åˆ’çº¿è¿æ¥æ–¹å¼ï¼Œæ­¤å¤„åœ¨è¿›è¡Œæ˜ å°„çš„æ—¶å€™å°±å¯ä»¥ä½¿ç”¨è¯¥æ³¨è§£ã€‚ 2ã€ç”¨æ³• ä¾‹å¦‚ï¼šä½¿ç”¨è¯¥æ³¨è§£å°†ä»¥ä¸‹è¡¨ç»“æ„è½¬åŒ–ä¸º Javabeanï¼š public class CustomerInfo{ private int id; //ä½¿ç”¨ @JsonPropertyæ³¨è§£å°†è¡¨ç»“æ„ä¸­çš„å­—æ®µæ˜ å°„åˆ°å®ä½“ç±»ä¸­ @JsonProperty(&quot;customer_name&quot;) private String customerName; @JsonProperty(&quot;customer_id&quot;) private String customerId; @JsonProperty(&quot;product_id&quot;) private String productId; @JsonProperty(&quot;source_address&quot;) private String sourceAddress; public int getId() { return id; } public void setId(int id) { this.id = id; } public String getCustomerName() { return customerName; } public void setCustomerName(String customerName) { this.customerName = customerName; } public String getCustomerId() { return customerId; } public void setCustomerId(String customerId) { this.customerId = customerId; } public String getProductId() { return productId; } public void setProductId(String productId) { this.productId = productId; } public String getSourceAddress() { return sourceAddress; } public void setSourceAddress(String sourceAddress) { this.sourceAddress = sourceAddress; } } å››ã€@JsonIgnore 1ã€æ¦‚å¿µ ç”¨äºå±æ€§æˆ–è€…æ–¹æ³•ä¸Šï¼ˆæœ€å¥½æ˜¯å±æ€§ä¸Šï¼‰ï¼Œç”¨æ¥å®Œå…¨å¿½ç•¥è¢«æ³¨è§£çš„å­—æ®µå’Œæ–¹æ³•å¯¹åº”çš„å±æ€§ï¼Œå³ä¾¿è¿™ä¸ªå­—æ®µæˆ–æ–¹æ³•å¯ä»¥è¢«è‡ªåŠ¨æ£€æµ‹åˆ°æˆ–è€…è¿˜æœ‰å…¶ä»–çš„æ³¨è§£ï¼Œä¸€èˆ¬æ ‡è®°åœ¨å±æ€§æˆ–è€…æ–¹æ³•ä¸Šï¼Œè¿”å›çš„ json æ•°æ®å³ä¸åŒ…å«è¯¥å±æ€§ã€‚ 2ã€ç”¨æ³• ä½¿ç”¨æƒ…æ™¯ï¼šéœ€è¦æŠŠä¸€ä¸ª List è½¬æ¢æˆ json æ ¼å¼çš„æ•°æ®ä¼ é€’ç»™å‰å°ã€‚ä½†å®ä½“ç±»ä¸­åŸºæœ¬å±æ€§å­—æ®µçš„å€¼éƒ½å­˜å‚¨åœ¨å¿«ç…§å±æ€§å­—æ®µä¸­ã€‚æ­¤æ—¶æˆ‘å¯ä»¥åœ¨ä¸šåŠ¡å±‚ä¸­åšå¤„ç†ï¼ŒæŠŠå¿«ç…§å±æ€§å­—æ®µçš„å€¼èµ‹ç»™å®ä½“ç±»ä¸­å¯¹åº”çš„åŸºæœ¬å±æ€§å­—æ®µã€‚æœ€åï¼Œæˆ‘å¸Œæœ›è¿”å›çš„ json æ•°æ®ä¸­ä¸åŒ…å«è¿™ä¸¤ä¸ªå¿«ç…§å­—æ®µï¼Œé‚£ä¹ˆåœ¨å®ä½“ç±»ä¸­å¿«ç…§å±æ€§ä¸ŠåŠ æ³¨è§£ @JsonIgnoreï¼Œé‚£ä¹ˆæœ€åè¿”å›çš„ json æ•°æ®ï¼Œå°†ä¸ä¼šåŒ…å« customerId å’Œ productId ä¸¤ä¸ªå±æ€§å€¼ã€‚ public class CustomerInfo { private int id; //ä½¿ç”¨ @JsonIgnoreæ³¨è§£åœ¨ç”Ÿæˆjsonæ•°æ®æ—¶ï¼Œå¿½ç•¥è¯¥å­—æ®µ private String customerName; @JsonIgnore private String customerId; @JsonIgnore private String productId; private String sourceAddress; public int getId() { return id; } public void setId(int id) { this.id = id; } public String getCustomerName() { return customerName; } public void setCustomerName(String customerName) { this.customerName = customerName; } public String getCustomerId() { return customerId; } public void setCustomerId(String customerId) { this.customerId = customerId; } public String getProductId() { return productId; } public void setProductId(String productId) { this.productId = productId; } public String getSourceAddress() { return sourceAddress; } public void setSourceAddress(String sourceAddress) { this.sourceAddress = sourceAddress; } } äº”ã€@JsonIgnoreProperties 1ã€æ¦‚å¿µï¼š æ˜¯ç±»æ³¨è§£ï¼Œä½œç”¨æ˜¯ json åºåˆ—åŒ–æ—¶å°† java bean ä¸­çš„ä¸€äº›å±æ€§å¿½ç•¥æ‰ï¼Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–éƒ½å—å½±å“ã€‚ 2ã€ç”¨æ³•ï¼š @JsonIgnoreProperties(ignoreUnknown = true)ï¼Œå°†è¿™ä¸ªæ³¨è§£å†™åœ¨ç±»ä¸Šä¹‹åï¼Œå°±ä¼šå¿½ç•¥ç±»ä¸­ä¸å­˜åœ¨çš„å­—æ®µã€‚ ä½¿ç”¨ @Data @JsonIgnoreProperties(value = {&quot;fullName&quot;, &quot;comment&quot;}) public class User { private String id; private String name; private String fullName; private String comment; private String mail; @JsonIgnore private String address; @JsonFormat(timezone = &quot;GMT+8&quot;, pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;) private Date regDate; private Date reg2Date; } è¯´æ˜ï¼šUser ç±»çš„ fullName å’Œ comment å­—æ®µä¼šè¢« @JsonIgnoreProperties æ³¨è§£å¿½ç•¥ã€‚address å­—æ®µä¼šè¢« @JsonIgnore æ³¨è§£å¿½ç•¥ã€‚regDate ä¼šæŒ‰ç…§ @JsonFormat(timezone = â€œGMT+8â€, pattern = â€œyyyy-MM-dd HH:mm:ssâ€) è¿›è¡Œæ ¼å¼è½¬ã€‚ æˆ‘ä»¬çš„ controller ç¤ºä¾‹ä»£ç ï¼š @ApiOperation(value = &quot;æŒ‰ç”¨æˆ·idåˆ é™¤&quot;, notes=&quot;private&quot;) @ApiImplicitParams({ @ApiImplicitParam(name = &quot;userId&quot;, defaultValue = &quot;2&quot;, value = &quot;userID&quot;, required = true, dataType = &quot;string&quot;, paramType = &quot;path&quot;), }) @DeleteMapping(value = &quot;/users/{userId}&quot;, produces = &quot;application/json;charset=UTF-8&quot;) public User delUser(@PathVariable String userId) { User user = (User)userSvc.deleteById(userId); log.info(&quot;rest del user={} by id={}&quot;, user, userId); return user; } å¯ä»¥çœ‹åˆ°è¿”å›çš„å¯¹è±¡æ˜¯ Userï¼Œç„¶å commentã€fullNameã€address å±æ€§è¢«å¿½ç•¥äº†ï¼ŒregDate çš„æ ¼å¼è¿›è¡Œè½¬æ¢ã€‚ å…­ã€@JsonFormat 1ã€æ¦‚å¿µï¼š ç”¨äºå±æ€§æˆ–è€…æ–¹æ³•ä¸Šï¼ˆæœ€å¥½æ˜¯å±æ€§ä¸Šï¼‰ï¼Œå¯ä»¥æ–¹ä¾¿çš„æŠŠ Date ç±»å‹ç›´æ¥è½¬åŒ–ä¸ºæˆ‘ä»¬æƒ³è¦çš„æ¨¡å¼ã€‚ 2ã€ç”¨æ³•ï¼š @JsonFormat(pattern=&quot;yyyy-MM-dd HH:mm:ss&quot;) private Date updateTime; ä¸ƒã€@JsonSerialize ç”¨äºå±æ€§æˆ–è€… getter æ–¹æ³•ä¸Šï¼Œç”¨äºåœ¨åºåˆ—åŒ–æ—¶åµŒå…¥æˆ‘ä»¬è‡ªå®šä¹‰çš„ä»£ç ï¼Œæ¯”å¦‚åºåˆ—åŒ–ä¸€ä¸ª double æ—¶åœ¨å…¶åé¢é™åˆ¶ä¸¤ä½å°æ•°ç‚¹ã€‚ å…«ã€@JsonDeserialize ç”¨äºå±æ€§æˆ–è€… setter æ–¹æ³•ä¸Šï¼Œç”¨äºåœ¨ååºåˆ—åŒ–æ—¶å¯ä»¥åµŒå…¥æˆ‘ä»¬è‡ªå®šä¹‰çš„ä»£ç ï¼Œç±»ä¼¼äºä¸Šé¢çš„ @JsonSerializeã€‚ ä¹ã€@JsonInclude å±æ€§å€¼ä¸º null çš„ä¸å‚ä¸åºåˆ—åŒ–ã€‚ä¾‹å­ï¼š@JsonInclude(Include.NON_NULL)ã€‚ ","tags":[{"index":-1,"name":"Java","slug":"SOje8Joqr","used":true,"link":"https://xuyj1111.github.io/SOje8Joqr/"},{"index":-1,"name":"è½¬è½½","slug":"JDrWa3FBq","used":true,"link":"https://xuyj1111.github.io/JDrWa3FBq/"}],"title":"ã€è½¬è½½ã€‘jackson çš„å‡ ä¸ªæ³¨è§£","feature":"","link":"https://xuyj1111.github.io/Kj_kWSjDE/","stats":{"text":"6 min read","time":316000,"words":1199,"minutes":6},"date":"2023-02-15 10:26:58","dateFormat":"2023-02-15"},{"content":" å‚è€ƒæ–‡ç« ï¼šHttpMessageConverter æ¶ˆæ¯è½¬æ¢å™¨ï¼Œby å°äºŒä¸Šé…’8 My GitHub Demo ï¼šCLICK HERE HttpMessageConverterä¸‹æœ‰å¤šä¸ªHttpMessageConverterï¼ŒHttpMessageConverter æ˜¯ SpringMVC ä¸­æä¾›çš„ä¸€ä¸ªç­–ç•¥æ¥å£ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ¶ˆæ¯è½¬æ¢å™¨ç±»ï¼ŒSpring Mvc ä¸­å°±æ˜¯ç”± HttpMessageConverter è´Ÿè´£è½¬æ¢ HTTP çš„è¯·æ±‚å’Œå“åº” é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Boot ä¼šè‡ªåŠ¨åŠ è½½å¦‚ä¸‹æ¶ˆæ¯ç±»å‹è½¬æ¢å™¨ğŸ‘‡ StringHttpMessageConverterè´Ÿè´£è¯»å–å­—ç¬¦ä¸²æ ¼å¼çš„æ•°æ®å’Œå†™å‡ºäºŒè¿›åˆ¶æ ¼å¼çš„æ•°æ®(å½“è¿”å›å€¼æ˜¯æˆ–è€…æ¥å—å€¼æ˜¯ String ç±»å‹æ—¶ï¼Œæ˜¯ç”±è¿™ä¸ªå¤„ç†) MappingJacksonHttpMessageConverterè´Ÿè´£è¯»å–å’Œå†™å…¥ json æ ¼å¼çš„æ•°æ®ï¼›(å½“è¿”å›å€¼æ˜¯å¯¹è±¡æˆ–è€…Listï¼Œå°±ç”±è¿™ä¸ªå¤„ç†) ByteArrayHttpMessageConverterè´Ÿè´£è¯»å–äºŒè¿›åˆ¶æ ¼å¼çš„æ•°æ®å’Œå†™å‡ºäºŒè¿›åˆ¶æ ¼å¼çš„æ•°æ®ï¼› FormHttpMessageConverterè´Ÿè´£è¯»å– form æäº¤çš„æ•°æ®ï¼ˆèƒ½è¯»å–çš„æ•°æ®æ ¼å¼ä¸º application/x-www-form-urlencodedï¼Œä¸èƒ½è¯»å– multipart/form-data æ ¼å¼æ•°æ®ï¼‰ï¼›è´Ÿè´£å†™å…¥ application/x-www-from-urlencoded å’Œ multipart/form-data æ ¼å¼çš„æ•°æ®ï¼› ResourceHttpMessageConverterè´Ÿè´£è¯»å–èµ„æºæ–‡ä»¶å’Œå†™å‡ºèµ„æºæ–‡ä»¶æ•°æ®ï¼› SourceHttpMessageConverterè´Ÿè´£è¯»å–å’Œå†™å…¥ xml ä¸­ javax.xml.transform.Source å®šä¹‰çš„æ•°æ®ï¼› Jaxb2RootElementHttpMessageConverterè´Ÿè´£è¯»å–å’Œå†™å…¥ xml æ ‡ç­¾æ ¼å¼çš„æ•°æ®ï¼› AtomFeedHttpMessageConverterè´Ÿè´£è¯»å–å’Œå†™å…¥ Atom æ ¼å¼çš„æ•°æ®ï¼› RssChannelHttpMessageConverterè´Ÿè´£è¯»å–å’Œå†™å…¥ RSS æ ¼å¼çš„æ•°æ®ï¼› æ‰§è¡Œæµç¨‹ğŸ‘‡ ","tags":[{"index":-1,"name":"Java","slug":"SOje8Joqr","used":true,"link":"https://xuyj1111.github.io/SOje8Joqr/"},{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"}],"title":"ã€Javaã€‘HttpMessageConverters ç±»","feature":"","link":"https://xuyj1111.github.io/nZRRBCWiX/","stats":{"text":"2 min read","time":74000,"words":326,"minutes":2},"date":"2023-02-14 14:32:10","dateFormat":"2023-02-14"},{"content":" Mysqlçš„4ç§äº‹åŠ¡ç‰¹æ€§ã€4ç§éš”ç¦»çº§åˆ«ã€7ç§ä¼ æ’­è¡Œä¸ºï¼Œby lu2hiqiang 4 ç§äº‹åŠ¡ç‰¹æ€§ åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡åŒ…å«çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šï¼Œå¼ºè°ƒçš„æ˜¯äº‹åŠ¡çš„ä¸å¯åˆ†å‰²æ€§ï¼› ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼š äº‹åŠ¡æ‰§è¡Œå‰å’Œæ‰§è¡Œåå¿…é¡»å¤„äºä¸€æ¬¡æ€§çŠ¶æ€ï¼Œäº‹åŠ¡æ‰§è¡Œå‰åæ•°æ®çš„å®Œæ•´æ€§å¿…é¡»ä¿æŒä¸€è‡´ï¼Œä¾‹å¦‚ï¼šè½¬è´¦ï¼› éš”ç¦»æ€§ï¼ˆisolationï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸åº”å—åˆ°å…¶ä»–äº‹åŠ¡çš„å½±å“ï¼Œå³å¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´è¦ç›¸äº’éš”ç¦» æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šäº‹åŠ¡ä¸€æ—¦ç»“æŸï¼Œæ•°æ®å°±æŒä¹…åˆ°æ•°æ®åº“ 5 ç§éš”ç¦»çº§åˆ« å¦‚æœä¸è€ƒè™‘äº‹åŠ¡çš„éš”ç¦»æ€§ä¼šå¼•å‘ä»¥ä¸‹å®‰å…¨æ€§é—®é¢˜ï¼š è„è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡è¿˜æœªæäº¤çš„æ•°æ®ï¼› ä¸å¯é‡å¤è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡å·²ç»æäº¤çš„ update çš„æ•°æ®å¯¼è‡´å¤šæ¬¡æŸ¥è¯¢ç»“æœä¸ä¸€è‡´ï¼›ã€è¡Œé”ã€‘ å¹»è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°å¦ä¸€ä¸ªäº‹åŠ¡å·²ç»æäº¤çš„ insert çš„æ•°æ®å¯¼è‡´å¤šæ¬¡æŸ¥è¯¢ç»“æœä¸ä¸€è‡´ï¼›ã€è¡¨é”ã€‘ è§£å†³è¯»é—®é¢˜ï¼šè®¾ç½®éš”ç¦»çº§åˆ«ï¼ˆ4 ç§ï¼‰ # æŸ¥çœ‹å½“å‰å…¨å±€äº‹åŠ¡éš”ç¦»çº§åˆ«: # MySQL5.6 åŠå…¶æ›´æ—©çš„ç‰ˆæœ¬ select @@global.tx_isolation; # MySQL5.7 åŠæ›´é«˜ç‰ˆæœ¬ select @@global.transaction_isolation; # ä¿®æ”¹ MySQL å…¨å±€é»˜è®¤äº‹åŠ¡éš”ç¦»çº§åˆ« # MySQL5.6 åŠå…¶æ›´æ—©çš„ç‰ˆæœ¬ set global tx_isolation='read-uncommitted'; set global tx_isolation='read-committed'; set global tx_isolation='repeatable-read'; set global tx_isolation='serializable'; # MySQL5.7 åŠæ›´é«˜ç‰ˆæœ¬ set global transaction_isolation='read-uncommitted'; set global transaction_isolation='read-committed'; set global transaction_isolation='repeatable-read'; set global transaction_isolation='serializable'; æœªæäº¤è¯»ï¼ˆread uncommitedï¼‰: æ‰€æœ‰äº‹åŠ¡éƒ½å¯ä»¥çœ‹åˆ°å…¶ä»–æœªæäº¤äº‹åŠ¡çš„æ‰§è¡Œç»“æœï¼›æ­¤éš”ç¦»çº§åˆ«å¾ˆå°‘åœ¨å®é™…åº”ç”¨ä¸­ä½¿ç”¨ï¼Œå¯èƒ½ä¼šå‘ç”Ÿè„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼›ã€è¯»ä¸åŠ é”ï¼›å†™ç¬é—´åŠ è¯»é”ï¼Œäº‹åŠ¡ç»“æŸé‡Šæ”¾ã€‘ å·²æäº¤è¯»ï¼ˆread commitedï¼‰ï¼šäº‹åŠ¡åªèƒ½çœ‹åˆ°å·²ç»æäº¤äº‹åŠ¡æ‰€æ”¹å˜çš„æ•°æ®ï¼Œå¯èƒ½ä¼šå‘ç”Ÿä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼›ã€è¯»ç¬é—´åŠ è¯»é”ï¼Œè¯»å®Œä¹‹åç«‹å³é‡Šæ”¾ï¼›å†™ç¬é—´åŠ å†™é”ï¼Œäº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ã€‘ å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰ï¼šmysql é»˜è®¤éš”ç¦»çº§åˆ«ï¼ŒåŒä¸€äº‹åŠ¡çš„å¤šä¸ªå®ä¾‹åœ¨å¹¶å‘è¯»å–æ•°æ®æ—¶ï¼Œä¼šçœ‹åˆ°åŒæ ·çš„æ•°æ®è¡Œï¼Œå¯èƒ½ä¼šå‘ç”Ÿå¹»è¯»ï¼›ï¼ˆæ³¨ï¼š InnoDB å’Œ Falcon å­˜å‚¨å¼•æ“é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼ŒMultiversion Concurrency Controlï¼‰æœºåˆ¶è§£å†³äº†è¯¥é—®é¢˜ï¼‰ã€è¯»ç¬é—´åŠ è¯»é”ï¼Œäº‹åŠ¡å®Œæˆä¹‹åæ‰é‡Šæ”¾é”ï¼›å†™ç¬é—´åŠ å†™é”ï¼Œäº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ã€‘ ä¸²è¡ŒåŒ–ï¼ˆserializableï¼‰ï¼šæœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå®ƒå¼ºåˆ¶äº‹åŠ¡é¡ºåºï¼Œä½¿ä¹‹ä¸å¯èƒ½ç›¸äº’å†²çªï¼Œå¯é¿å…ä¸‰ç§è¯»ï¼Œä½†å¯èƒ½å¯¼è‡´å¤§é‡çš„è¶…æ—¶ç°è±¡å’Œé”ç«äº‰ã€‚ã€è¯»ç¬é—´åŠ è¯»é”ï¼›å†™ç¬é—´åŠ å†™é”ã€‘ åªæœ‰ä¸²è¡ŒåŒ–æ˜¯è¡¨é” ï¼Œå…¶ä»–éƒ½æ˜¯è¡Œé” æ³¨æ„ï¼šéš”ç¦»æ€§ä¸å¹¶å‘æ€§ï¼Œæ­¤æ¶ˆå½¼é•¿ã€‚ äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸åŒå®é™…æ˜¯å› ä¸ºç”Ÿäº§ read view çš„æ—¶é—´ä¸åŒå¯¼è‡´çš„ 7 ç§ä¼ æ’­è¡Œä¸º PROPAGATION_REQUIRED æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœä¸å­˜åœ¨ å°±æ–°å»ºä¸€ä¸ª (é»˜è®¤) PROPAGATION_SUPPORTS æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¸ä½¿ç”¨äº‹åŠ¡ PROPAGATION_MANDATORY æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœä¸å­˜åœ¨ï¼ŒæŠ›å‡ºå¼‚å¸¸ ä¿è¯æ²¡æœ‰åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ PROPAGATION_REQUIRES_NEW å¦‚æœæœ‰äº‹åŠ¡å­˜åœ¨ï¼ŒæŒ‚èµ·å½“å‰äº‹åŠ¡ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ PROPAGATION_NOT_SUPPORTED ä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœæœ‰äº‹åŠ¡å­˜åœ¨ï¼ŒæŒ‚èµ·å½“å‰äº‹åŠ¡ PROPAGATION_NEVER ä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœæœ‰äº‹åŠ¡å­˜åœ¨ï¼ŒæŠ›å‡ºå¼‚å¸¸ PROPAGATION_NESTED å¦‚æœå½“å‰äº‹åŠ¡å­˜åœ¨ï¼Œåˆ™åµŒå¥—äº‹åŠ¡æ‰§è¡Œ åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸€èˆ¬å…ˆæ‰§è¡Œä¸ä¼šå¯¹å¤–ç•Œé€ æˆå½±å“çš„æ“ä½œï¼ˆå¯ä»¥å›æ»šçš„æ“ä½œï¼‰ï¼Œåæ‰§è¡Œä¸å¯æ§ï¼Œæˆ–è€…ä¸èƒ½å›æ»šçš„æ“ä½œï¼Œä¸å¯å›æ»šæ“ä½œåº”å½“æœ‰ä¸”åªæœ‰ä¸€ä¸ªã€‚ æ•°æ®åº“é‡å¤§çš„ä¼˜åŒ– åŸå› ï¼šéšç€æ•°æ®é‡çš„å¢å¤šï¼Œsql è¯­å¥æ•ˆç‡ä¸‹é™ã€‚ è§£å†³æ–¹æ¡ˆï¼šæŒ‰ç…§è¿™ä¸ªé¡ºåºä¼˜åŒ–ï¼›åŠ ç´¢å¼•ï¼Œè¡¨åˆ†åŒºï¼ˆåˆ†æµï¼‰ï¼Œåˆ†åº“åˆ†è¡¨ã€è¯»å†™åˆ†ç¦»ï¼› åˆ†åŒºçš„ä¼˜ç‚¹ï¼š ä¸å½±å“ä¸šåŠ¡ æ”¾ä¸åŒç£ç›˜ä¸Š å¯ä»¥å¤‡ä»½ã€å›å¤ï¼Œé€æ­¥è¿›è¡Œï¼› ","tags":[{"index":-1,"name":"è½¬è½½","slug":"JDrWa3FBq","used":true,"link":"https://xuyj1111.github.io/JDrWa3FBq/"},{"index":-1,"name":"MySQL","slug":"eng41sp6q","used":true,"link":"https://xuyj1111.github.io/eng41sp6q/"}],"title":"ã€è½¬è½½ã€‘Mysqlçš„4ç§äº‹åŠ¡ç‰¹æ€§ã€4ç§éš”ç¦»çº§åˆ«ã€7ç§ä¼ æ’­è¡Œä¸º","feature":"","link":"https://xuyj1111.github.io/bJ4DMMqiI/","stats":{"text":"4 min read","time":225000,"words":1049,"minutes":4},"date":"2023-02-12 15:26:47","dateFormat":"2023-02-12"},{"content":" å‚è€ƒæ–‡ç« ï¼šSpringâ€”â€”äº‹åŠ¡æ³¨è§£@Transactionalï¼Œby ä¸ƒæµ·å¥äºº @Transactional æ¥æºäº Springï¼Œç”¨æ¥ç®¡ç†äº‹åŠ¡ã€‚è¯¥æ³¨è§£å±äº Spring çš„å£°æ˜å¼äº‹åŠ¡ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯ç¼–ç¨‹å¼äº‹åŠ¡ï¼Œç¼–ç¨‹å¼å¯¹ä»£ç å…·æœ‰ä¾µå…¥æ€§ï¼Œä¸æ¨èä½¿ç”¨ã€‚ æ³¨è§£çš„ä½¿ç”¨ å¯ä»¥ç”¨åœ¨æ¥å£ã€ç±»ã€æ–¹æ³•ï¼š æ¥å£ï¼šä¸æ¨èï¼ŒSpring AOP ä½¿ç”¨ CGLib æ—¶ï¼Œæ³¨è§£ä¼šå¤±æ•ˆ ç±»ï¼šç”Ÿæ•ˆäºç±»ä¸­æ‰€æœ‰ public æ–¹æ³• æ–¹æ³•ï¼šç±»å’Œæ–¹æ³•åŒæ—¶é…ç½®ï¼Œæ–¹æ³•æ³¨è§£ä¼šè¦†ç›–ç±»æ³¨è§£ æ³¨è§£å±æ€§ public @interface Transactional { /** * å½“åœ¨é…ç½®æ–‡ä»¶ä¸­æœ‰å¤šä¸ª TransactionManager , å¯ä»¥ç”¨è¯¥å±æ€§æŒ‡å®šé€‰æ‹©å“ªä¸ªäº‹åŠ¡ç®¡ç†å™¨ã€‚ */ @AliasFor(&quot;transactionManager&quot;) String value() default &quot;&quot;; /** * åŒä¸Šã€‚ */ @AliasFor(&quot;value&quot;) String transactionManager() default &quot;&quot;; /** * äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºï¼Œé»˜è®¤å€¼ä¸º REQUIREDã€‚ */ Propagation propagation() default Propagation.REQUIRED; /** * äº‹åŠ¡çš„éš”ç¦»è§„åˆ™ï¼Œé»˜è®¤å€¼é‡‡ç”¨ DEFAULTã€‚ */ Isolation isolation() default Isolation.DEFAULT; /** * äº‹åŠ¡è¶…æ—¶æ—¶é—´ã€‚ */ int timeout() default TransactionDefinition.TIMEOUT_DEFAULT; /** * æ˜¯å¦åªè¯»äº‹åŠ¡ */ boolean readOnly() default false; /** * ç”¨äºæŒ‡å®šèƒ½å¤Ÿè§¦å‘äº‹åŠ¡å›æ»šçš„å¼‚å¸¸ç±»å‹ã€‚ */ Class&lt;? extends Throwable&gt;[] rollbackFor() default {}; /** * åŒä¸Šï¼ŒæŒ‡å®šç±»åã€‚ */ String[] rollbackForClassName() default {}; /** * ç”¨äºæŒ‡å®šä¸ä¼šè§¦å‘äº‹åŠ¡å›æ»šçš„å¼‚å¸¸ç±»å‹ */ Class&lt;? extends Throwable&gt;[] noRollbackFor() default {}; /** * åŒä¸Šï¼ŒæŒ‡å®šç±»å */ String[] noRollbackForClassName() default {}; } å¤±æ•ˆçš„åœºæ™¯ æ³¨è§£åœ¨é public æ–¹æ³•ä¸Š æ³¨è§£åœ¨ final æ–¹æ³•ä¸Š åŒä¸€ä¸ªç±»ä¸­ï¼ŒæŸæ–¹æ³•è°ƒç”¨äº‹åŠ¡æ–¹æ³• è§£å†³åŠæ³•ä¸€ï¼šäº‹åŠ¡æ–¹æ³•æ–°å†™ä¸€ä¸ª Serviceï¼Œç„¶åç±»ä¸­æ³¨å…¥ä½¿ç”¨ è§£å†³æ–¹æ³•äºŒï¼šå½“å‰ç±»ä¸­ï¼Œæ³¨å…¥è‡ªå·±ï¼Œå‚è€ƒSpringâ€”â€”å¾ªç¯ä¾èµ–&amp;ä¸‰çº§ç¼“å­˜ è§£å†³åŠæ³•ä¸‰ï¼šä½¿ç”¨AopContext.currentProxy()è·å–å½“å‰ç±»çš„ä»£ç†å¯¹è±¡ @Servcie public class ServiceA { public void save(User user) { queryData1(); queryData2(); ((ServiceA)AopContext.currentProxy()).doSave(user); } @Transactional(rollbackFor=Exception.class) public void doSave(User user) { addData1(); updateData2(); } } äº‹åŠ¡æ–¹æ³•æ‰€åœ¨ç±»ï¼Œæ²¡æœ‰è¢« Spring ç®¡ç†ï¼Œä¾‹å¦‚æ²¡æœ‰åŠ @Serviceæ³¨è§£ æ•°æ®åº“å­˜å‚¨å¼•æ“ä¸æ”¯æŒäº‹åŠ¡ï¼šmysql çš„ myisam ä¸æ”¯æŒäº‹åŠ¡ ä¸¤ä¸ªæ–¹æ³•ä¸åœ¨åŒä¸€çº¿ç¨‹ä¸­ï¼Œå³æ˜¯ä¸¤ä¸ªä¸åŒçš„äº‹åŠ¡ Spring ä¸­çš„ä¼ æ’­æ–¹å¼å’Œéš”ç¦»çº§åˆ« ä¸ƒç§ä¼ æ’­æ–¹å¼ğŸ‘‡ // å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ã€‚è¿™æ˜¯é»˜è®¤å€¼ 1. Propagation.REQUIRED // åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ· 2. Propagation.REQUIRES_NEW // å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™ä»¥éäº‹åŠ¡çš„æ–¹å¼ç»§ç»­è¿è¡Œ 3. Propagation.SUPPORTS // ä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ· 4. Propagation.NOT_SUPPORTED // ä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ 5. Propagation.NEVER // å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ 6. Propagation.MANDATORY /* å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªäº‹åŠ¡ä½œä¸ºå½“å‰äº‹åŠ¡çš„åµŒå¥—äº‹åŠ¡æ¥è¿è¡Œ å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™è¯¥å–å€¼ç­‰ä»·äºTransactionDefinition.PROPAGATION_REQUIRED */ 7. Propagation.NESTED äº”ç§éš”ç¦»çº§åˆ«ğŸ‘‡ // ä½¿ç”¨åç«¯æ•°æ®åº“é»˜è®¤çš„éš”ç¦»çº§åˆ« å¯¹äºMYSQLæ¥è¯´å°±æ˜¯å¯é‡å¤è¯» 1. Isolation.DEFAULT // æ˜¯æœ€ä½çš„éš”ç¦»çº§åˆ«ï¼Œå…è®¸è¯»å–å°šæœªæäº¤çš„æ•°æ®å˜æ›´(ä¼šå‡ºç°è„è¯»,ä¸å¯é‡å¤è¯»)ï¼ŒåŸºæœ¬ä¸ä½¿ç”¨ 2. Isolation.READ_UNCOMMITTED // å…è®¸è¯»å–å¹¶å‘äº‹åŠ¡å·²ç»æäº¤çš„æ•°æ®(ä¼šå‡ºç°ä¸å¯é‡å¤è¯»å’Œå¹»è¯») 3. Isolation.READ_COMMITTED // äº‹ç‰©å¼€å¯åï¼Œå¯¹åŒä¸€å­—æ®µçš„å¤šæ¬¡è¯»å–ç»“æœéƒ½æ˜¯ä¸€è‡´çš„ï¼Œé™¤éæ•°æ®æ˜¯è¢«æœ¬èº«äº‹åŠ¡è‡ªå·±æ‰€ä¿®æ”¹(ä¼šå‡ºç°å¹»è¯») 4. Isolation.REPEATABLE_READ // æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå®Œå…¨æœä»ACIDçš„éš”ç¦»çº§åˆ«ï¼Œä¹Ÿæ˜¯æœ€æ…¢çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œå› ä¸ºå®ƒé€šå¸¸æ˜¯é€šè¿‡å®Œå…¨é”å®šäº‹åŠ¡ç›¸å…³çš„æ•°æ®åº“è¡¨æ¥å®ç°çš„ 5. Isolation.SERIALIZABLE ","tags":[{"index":-1,"name":"Java","slug":"SOje8Joqr","used":true,"link":"https://xuyj1111.github.io/SOje8Joqr/"},{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"}],"title":"ã€Javaã€‘@Transactionalæ³¨è§£","feature":"","link":"https://xuyj1111.github.io/q62qJQE0u/","stats":{"text":"4 min read","time":215000,"words":944,"minutes":4},"date":"2023-02-12 14:56:34","dateFormat":"2023-02-12"},{"content":" å‚è€ƒæ–‡ç«  mysqlé”ï¼ˆå…¨å±€é”ã€è¡¨é”ã€è¡Œé”ã€é¡µé”ã€æ’ä»–é”ã€å…±äº«é”ï¼Œby Î¶è·é€¸ã“ Mysqlä¸­çš„å…±äº«é”å’Œæ’ä»–é”ï¼Œby Bronze5 mysqlé—´éš™é”ã€è¡¨é”ã€è¡Œé”ï¼Œè¯»é”ï¼ˆå…±äº«é”ï¼‰ã€å†™é”ï¼ˆæ’ä»–é”ï¼‰ï¼Œæ„å‘é”ï¼Œby ?Bad guy? è¯»æ“ä½œ = æŸ¥è¯¢ = select å†™æ“ä½œ = æ›´æ–° = updateã€deleteã€insert ä¹è§‚é”æ˜¯é€šè¿‡ä»£ç æ§åˆ¶çš„ï¼Œä¸éœ€è¦æ•°æ®åº“åŠ é” åŸºæœ¬æ€æƒ³ï¼šåœ¨å¹¶å‘ç¯å¢ƒä¸‹ï¼Œé€šè¿‡æ— é˜»å¡çš„æ–¹å¼é¿å…å†²çªï¼Œæé«˜ç³»ç»Ÿå¹¶å‘æ€§ã€‚ åšæ³•ï¼šåœ¨æ•°æ®åº“è®°å½•ä¸Šæ·»åŠ ç‰ˆæœ¬å·ï¼ˆæ—¶é—´æˆ³ï¼‰æ¥å®ç°ã€‚å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹æ•°æ®å‰ï¼Œæ£€æŸ¥æ•°æ®çš„ç‰ˆæœ¬å·æ˜¯å¦è¿‡æ—¶ï¼Œè‹¥è¿‡æ—¶ï¼Œè¯´æ˜è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹ï¼Œä¸ä½œæ“ä½œï¼Œé‡æ–°è¯»å–æ•°æ®ï¼›è‹¥æœªè¿‡æ—¶ï¼Œè¿›è¡Œæ“ä½œå¹¶ä¿®æ”¹ç‰ˆæœ¬å· ç¼ºç‚¹ï¼šå¹¶å‘é‡è¿‡å¤§æ—¶ï¼Œä¼šå¯¼è‡´å¤§é‡å¤±è´¥å’Œé‡è¯•ï¼Œå½±å“æ€§èƒ½ã€‚å®é™…åº”ç”¨ä¸­éœ€è¦ä¸å…¶ä»–æŠ€æœ¯ç»“åˆ ä»¥ä¸‹ä»‹ç»å››ç§æ‚²è§‚é”ğŸ‘‡ è¡¨é” è¡Œé” å…±äº«é”ï¼šåˆç§°â€œè¯»é”â€ã€â€œSé”â€ æ’ä»–é”ï¼šåˆç§°â€œå†™é”â€ã€â€œXé”â€ MySQL ä¸­ï¼Œéœ€è¦æ³¨æ„å­˜å‚¨å¼•æ“ï¼ŒInnoDB å’Œ MyISAM å¯¹é”çš„æ”¯æŒä¸åŒã€‚æœ¬æ–‡ä¸­â€œå…±äº«é”â€å’Œâ€œæ’ä»–é”â€çš„ä»‹ç»æ˜¯åœ¨ InnoDB ç¯å¢ƒä¸‹ è¡¨é”å’Œè¡Œé” è¡¨é”å’Œè¡Œé”æ˜¯èŒƒå›´ï¼Œå³å¯èƒ½æ˜¯å…±äº«é”é”ä½äº†è¡¨/è¡Œï¼Œä¹Ÿå¯èƒ½æ˜¯æ’ä»–é”é”ä½äº†è¡¨/è¡Œ å­˜å‚¨å¼•æ“çš„ä¸åŒï¼ŒåŠ é”ä¹Ÿä¸åŒğŸ‘‡ MyISAMï¼šæŸ¥è¯¢æ—¶ï¼Œè‡ªåŠ¨ç»™æ¶‰åŠçš„æ‰€æœ‰è¡¨åŠ è¯»é”ï¼›æ›´æ–°æ—¶ï¼Œè‡ªåŠ¨ç»™æ¶‰åŠçš„è¡¨åŠ å†™é”ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸éœ€è¦ç”¨æˆ·å¹²é¢„ã€ä»…æ”¯æŒè¡¨é”ã€‘ InnoDBï¼šã€æ”¯æŒè¡¨é”ï¼Œè¡Œé”ã€‘ éœ€è¦ä½¿ç”¨åŠ é”è¯­å¥ï¼ˆè§å…±äº«é”å’Œæ’ä»–é”ï¼‰ ä¸ä½¿ç”¨åŠ é”è¯­å¥ä¸ºå‰æï¼Œselect æ—¶ä¸ä¼šåŠ é”ï¼Œupdateã€deleteã€insert æ—¶ä¼šè‡ªåŠ¨åŠ æ’ä»–é” ä¸èµ°ç´¢å¼•ï¼Œè¡Œé”ä¼šè‡ªåŠ¨å‡çº§è¡¨é” å…±äº«é” ç‰¹æ€§ğŸ‘‡ å¤šä¸ªäº‹åŠ¡éƒ½å¯¹æŸä¸€æ•°æ®é›†/è¡¨åŠ äº†å…±äº«é”ï¼Œä»…æ”¯æŒè¯» å†™æ“ä½œä¼šè‡ªåŠ¨åŠ æ’ä»–é”ï¼Œå…±äº«é”ä¼šé˜»å¡æ’ä»–é”ï¼Œå› æ­¤ä¸æ”¯æŒå†™æ“ä½œ åªæœ‰å½“å‰äº‹åŠ¡åŠ å…±äº«é”ï¼Œå½“å‰äº‹åŠ¡è¯»å†™éƒ½æ”¯æŒ åŠ é”è¯­å¥ğŸ‘‡ -- å¯¹è¡¨åŠ å…±äº«é” LOCK TABLE table_name READ; -- å¯¹æ•°æ®é›†åŠ å…±äº«é” SELECT * FROM table_name WHERE ... lock in share mode; -- é‡Šæ”¾æ‰€æœ‰é” UNLOCK TABLE; åœºæ™¯ğŸ‘‡ äº‹åŠ¡1 ä¸ºæŸä¸€æ•°æ®é›†åŠ å…±äº«é”ï¼Œäº‹åŠ¡2 ä¹Ÿå¯¹è¯¥æ•°æ®é›†åŠ å…±äº«é”ã€‚ ä¸¤äº‹åŠ¡éƒ½å¯ä»¥è¯» äº‹åŠ¡1 å¯¹è¯¥æ•°æ®é›†æ‰§è¡Œæ›´æ–°æ“ä½œï¼Œä¼šç­‰å¾…ï¼›è‹¥å¯¹å…¶ä»–æ•°æ®é›†æ›´æ–°ï¼Œä¸ä¼šç­‰å¾…ã€æ›´æ–°æ“ä½œä¼šå¸¦æ¥æ’ä»–é”ï¼Œå…±äº«é”ä¼šé˜»å¡æ’ä»–é”ï¼Œå› æ­¤ç­‰å¾…ï¼›å…¶ä»–æ•°æ®é›†æ²¡æœ‰é”ï¼Œå› æ­¤ä¸ç­‰å¾…ã€‘ äº‹åŠ¡1 ç­‰å¾…æƒ…å†µä¸‹ï¼Œæäº¤äº‹åŠ¡2ï¼Œäº‹åŠ¡1 æ›´æ–°æ“ä½œæ‰§è¡Œå®Œæˆã€æäº¤äº‹åŠ¡2ï¼Œåªå‰©ä¸‹äº‹åŠ¡1ï¼Œå› æ­¤è¯»å†™éƒ½æ”¯æŒã€‘ p.s. åœ¨æ­¥éª¤1 ä¹‹åï¼Œäº‹åŠ¡2 æ‰§è¡Œ name æ¡ä»¶çš„ä¿®æ”¹è¯­å¥ï¼Œåˆ™ä¸ç®¡æ­¥éª¤2 å¯¹å“ªä¸ªæ•°æ®é›†æ›´æ–°æ“ä½œï¼Œéƒ½ä¼šç­‰å¾…ã€nameä¸æ˜¯ç´¢å¼•å­—æ®µï¼Œè¡Œé”ä¼šå‡çº§æˆè¡¨é”ã€‘ äº‹åŠ¡1 begin; select * from t1 where id = 1 lock in share mode; update t1 set data = JSON_REPLACE(data, '$.key1', 'value1') where id = 1; commit; äº‹åŠ¡2 begin; select * from t1 where id = 1 lock in share mode; &lt;!-- name æ¡ä»¶çš„ä¿®æ”¹è¯­å¥ğŸ‘‡ --&gt; -- select * from t1 where name = 'haha' lock in share mode; commit; æ’ä»–é” ç‰¹æ€§ğŸ‘‡ ä»…æ”¯æŒå½“å‰è·å–æ’ä»–é”çš„äº‹åŠ¡ï¼Œè¿›è¡Œè¯»å†™æ“ä½œ å†™æ“ä½œä¼šè‡ªåŠ¨åŠ ä¸Šæ’ä»–é” åŠ é”è¯­å¥ğŸ‘‡ -- å¯¹è¡¨åŠ æ’ä»–é” LOCK TABLE table_name WRITE; -- å¯¹æ•°æ®é›†åŠ æ’ä»–é” SELECT * FROM table_name WHERE ... for update; -- é‡Šæ”¾æ‰€æœ‰é” UNLOCK TABLE; LOCK TABLES å’Œ UNLOCK TABLES LOCK TABLESå¯ä»¥é”å®šç”¨äºå½“å‰çº¿ç¨‹çš„è¡¨ã€‚å¦‚æœè¡¨è¢«å…¶ä»–çº¿ç¨‹é”å®šï¼Œåˆ™å½“å‰çº¿ç¨‹ä¼šç­‰å¾…ï¼Œç›´åˆ°å¯ä»¥è·å–æ‰€æœ‰é”å®šä¸ºæ­¢ UNLOCK TABLESå¯ä»¥é‡Šæ”¾å½“å‰çº¿ç¨‹è·å¾—çš„ä»»ä½•é”å®šã€‚å½“å‰çº¿ç¨‹æ‰§è¡Œå¦ä¸€ä¸ªLOCK TABLESæ—¶ï¼Œ æˆ–å½“ä¸æœåŠ¡å™¨çš„è¿æ¥è¢«å…³é—­æ—¶ï¼Œæ‰€æœ‰ç”±å½“å‰çº¿ç¨‹é”å®šçš„è¡¨è¢«éšå«åœ°è§£é” æ³¨æ„äº‹é¡¹ğŸ‘‡ åœ¨ç”¨LOCK TABLESå¯¹ InnoDB è¡¨åŠ é”æ—¶ï¼Œè¦æŠŠ AUTOCOMMIT è®¾ä¸º 0ï¼Œå¦åˆ™ MySQL ä¸ä¼šç»™è¡¨åŠ é” UNLOCK TABLESä¼šéšå«çš„æäº¤äº‹åŠ¡ï¼Œå³COMMIT COMMITæˆ–ROLLBACKå¹¶ä¸èƒ½é‡Šæ”¾ç”¨LOCK TABLESåŠ çš„è¡¨çº§é”ï¼Œå¿…é¡»ç”¨UNLOCK TABLESé‡Šæ”¾è¡¨é” ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"MySQL","slug":"eng41sp6q","used":true,"link":"https://xuyj1111.github.io/eng41sp6q/"}],"title":"ã€MySQLã€‘å„ç§é”çš„ä»‹ç»","feature":"","link":"https://xuyj1111.github.io/jkZZ_73nV/","stats":{"text":"4 min read","time":239000,"words":1076,"minutes":4},"date":"2023-02-10 15:12:17","dateFormat":"2023-02-10"},{"content":" jdk ä¸­çš„å¯é‡å…¥é”æœ‰synchronizedå’ŒReentrantLock å¯é‡å…¥é”ï¼Œä¹Ÿç§°ä¸ºé€’å½’é”ã€‚ä¸€ä¸ªæŒæœ‰é”çš„çº¿ç¨‹ï¼Œåœ¨é‡Šæ”¾é”ä¹‹å‰ï¼Œå¦‚æœå†æ¬¡è®¿é—®äº†è¯¥åŒæ­¥é”çš„å…¶ä»–æ–¹æ³•ï¼Œè¿™ä¸ªçº¿ç¨‹ä¸éœ€è¦å†æ¬¡ç«äº‰é”ï¼Œåªéœ€è¦è®°å½•é‡å…¥æ¬¡æ•°ã€‚é‡å…¥é”çš„è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†è§£å†³æ­»é”çš„é—®é¢˜ p.s. ä»¥ synchronized ä¸¾ä¾‹ï¼Œè‹¥ä¸€ä¸ª synchronized æ–¹æ³•1 è°ƒç”¨ synchronized æ–¹æ³•2ï¼Œä¸¤æ–¹æ³•çš„é”éƒ½æ˜¯åŒä¸€ä¸ªï¼Œåˆ™æŸçº¿ç¨‹æ‰§è¡Œæ–¹æ³•1æ—¶ï¼Œä¼šä¸€å¹¶æ‰§è¡Œæ–¹æ³•2ï¼Œå¹¶ä¸ä¼šå› ä¸ºæ–¹æ³•1æ‹¿äº†é”ï¼Œæ–¹æ³•2æ²¡æœ‰è€Œä¸æ‰§è¡Œ synchronized synchronized æœ‰å››ç§ç”¨æ³•ï¼š ä¿®é¥°å®ä¾‹æ–¹æ³• ä¿®é¥°é™æ€æ–¹æ³• ä¿®é¥°å®ä¾‹æ–¹æ³•çš„ä»£ç å— ä¿®é¥°é™æ€æ–¹æ³•çš„ä»£ç å— synchronized ä»£ç å—çš„å‚æ•°ï¼šthisè¡¨ç¤ºå½“å‰ç±»å¯¹è±¡ï¼ˆé™æ€æ–¹æ³•ä¸­ä¸èƒ½ç”¨ï¼‰ï¼›xxx.classè¡¨ç¤ºç±»æœ¬èº«ï¼›è¿˜å¯ä»¥ä¼ å…¥å…¶ä»–å‚æ•° // ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼šé”çš„æ˜¯ç±»å¯¹è±¡ public synchronized void printHello() { System.out.println(&quot;hello&quot;); } // ä¿®é¥°é™æ€æ–¹æ³•ï¼šé”çš„æ˜¯ç±»æœ¬èº« public static synchronized void printHi() { System.out.println(&quot;hi&quot;); } // ä¿®é¥°å®ä¾‹æ–¹æ³•çš„ä»£ç å— public void printHello() { synchronized (this) { System.out.println(&quot;hello&quot;); } } // ä¿®é¥°é™æ€æ–¹æ³•çš„ä»£ç å— public static void printHi() { synchronized (MultithreadDemo.class) { System.out.println(&quot;hello&quot;); } } ReentrantLock ReentrantLock ç±»å®ç°äº† Lockæ¥å£ï¼Œé™¤æ­¤ä»¥å¤–è¿˜æœ‰å…¶ä»–å®ç°ç±»ğŸ‘‡ å¸¸ç”¨æ–¹æ³• lock()ï¼šç­‰å¾…é”ï¼Œæ— è§†ä¸­æ–­ lockInterruptibly()ï¼šç­‰å¾…é”ï¼Œè€ƒè™‘ä¸­æ–­ã€‚ä¸­æ–­ä¼šæŠ›å‡º InterruptedException tryLock(long timeout, TimeUnit unit)ï¼šæŒ‡å®šæ—¶é—´ç­‰å¾…é”ï¼Œè€ƒè™‘ä¸­æ–­ã€‚æŒ‡å®šæ—¶é—´å†…è·å¾—é”è¿”å› trueï¼Œå¦åˆ™ falseï¼Œä¸­æ–­ä¼šæŠ›å‡º InterruptedException tryLock()ï¼šç›´æ¥è·å–é”ã€‚æˆåŠŸ trueï¼Œå¦åˆ™ falseï¼Œç›¸å½“äºtryLock(0, TimeUnit unit) unlock()ï¼šè§£é”ã€‚å¿…é¡»æœ‰æŒæœ‰é”çš„çº¿ç¨‹æ‰§è¡Œï¼Œå¦åˆ™æŠ›å‡º IllegalMonitorStateException ä¸ºäº†é¿å…æ­»é”ï¼Œunlock()æœ€å¥½æ”¾åœ¨ finally ä¸­ ReentrantLock æ˜¯å¯é‡å…¥é”ï¼Œå› æ­¤ä¸€ä¸ªçº¿ç¨‹å¯èƒ½å¤šæ¬¡åŠ é”ï¼Œä½†æ˜¯unlock()æ‰§è¡Œä¸€æ¬¡è§£é”ä¸€æ¬¡ï¼Œå› æ­¤åŠ å‡ æ¬¡é”ï¼Œå°±è¦è§£é”å‡ æ¬¡ lock() å’Œ unlock() çš„ç®€å•ä½¿ç”¨ğŸ‘‡ private Lock lock = new ReentrantLock(); public void run () { lock.lock(); try { for (int i = 0; i &lt; 5; i++) System.out.println(Thread.currentThread().getName() + &quot;:&quot; + i); } finally { lock.unlock(); } } lock()ã€lockInterruptibly()ã€tryLock(long timeout, TimeUnit unit) åœ¨çº¿ç¨‹ä¸­æ–­æƒ…å†µä¸‹çš„è¡¨ç°ğŸ‘‡ ReentrantLock lock = new ReentrantLock(); Thread t1 = new Thread(new Runnable() { @Override public void run() { try { lock.lock(); System.out.println(&quot;t1æ‹¿åˆ°é”&quot;); Thread.sleep(1000L); System.out.println(&quot;t1æ‰§è¡Œç»“æŸ&quot;); } catch (InterruptedException e) { e.printStackTrace(); } finally { lock.unlock(); } } }); Thread t2 = new Thread(new Runnable() { @Override public void run() { boolean flag = true; try { System.out.println(&quot;t2ç­‰å¾…æ‹¿é”&quot;); // ****************** start ********************** // lock.lock(); // lock.lockInterruptibly(); flag = lock.tryLock(200, TimeUnit.MILLISECONDS); // ****************** end ********************** if (flag) { System.out.println(&quot;t2æ‹¿åˆ°é”&quot;); System.out.println(&quot;t2æ‰§è¡Œç»“æŸ&quot;); } else { System.out.println(&quot;æŒ‡å®šæ—¶é—´å†…æ²¡æœ‰æ‹¿åˆ°é”ï¼Œover&quot;); } } catch (Exception e) { e.printStackTrace(); } finally { if (flag) { lock.unlock(); } } } }); t1.start(); // ä¿è¯ t1 æ‹¿åˆ°é” Thread.sleep(10L); t2.start(); // ä¿è¯ t2 åœ¨ç­‰å¾…é” Thread.sleep(10L); // è‹¥éšè—çº¿ç¨‹ä¸­æ–­è¯­å¥ï¼Œt2 æ­£å¸¸ç­‰å¾…é” æˆ– æŒ‡å®šæ—¶é—´å†…ç­‰å¾… t2.interrupt(); // åœ¨æµ‹è¯•ç±»ä¸­éœ€è¦ä¿æŒè¿è¡Œä¸€ä¼š Thread.sleep(2000L); å…¶ä»–æ–¹æ³• int getHoldCount()ï¼šå½“å‰é”çš„åŠ é”æ¬¡æ•°ï¼Œå¦‚æœæ— çº¿ç¨‹æŒæœ‰é”å°±è¿”å›0 int getQueueLength()ï¼šå½“å‰ç«äº‰æ­¤é”é˜Ÿåˆ—é•¿åº¦ int getWaitQueueLength(Condition condition)ï¼šå½“å‰é”ç­‰å¾…é˜Ÿåˆ—é•¿åº¦ã€‚éœ€è¦ä¸Conditionè”åˆä½¿ç”¨ boolean isFair()ï¼šæ˜¯å¦æ˜¯å…¬å¹³é” boolean isLocked()ï¼šå½“å‰é”æ˜¯å¦å¤„äºé”å®šçŠ¶æ€ boolean isHeldByCurrentThread()ï¼šå½“å‰é”æ˜¯å¦è¢«å½“å‰çº¿ç¨‹æŒæœ‰ boolean hasWaiters(Condition condition)ï¼šå½“å‰conditionæ˜¯å¦æœ‰çº¿ç¨‹åœ¨ç­‰å¾…ï¼Œéœ€è¦ä¸Conditionè”åˆä½¿ç”¨ boolean hasQueuedThread(Thread thread)ï¼šç›®æ ‡çº¿ç¨‹æ˜¯å¦åœ¨è¿™ä¸ªé”çš„ç«äº‰é˜Ÿåˆ—ä¸­ boolean hasQueuedThreads()ï¼šæ˜¯å¦æœ‰çº¿ç¨‹åœ¨å½“å‰é”çš„ç«äº‰é˜Ÿåˆ—ä¸­ ä¸¤è€…åŒºåˆ« ","tags":[{"index":-1,"name":"Java","slug":"SOje8Joqr","used":true,"link":"https://xuyj1111.github.io/SOje8Joqr/"},{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"}],"title":"ã€Javaã€‘jdk ä¸­çš„å¯é‡å…¥é”","feature":"","link":"https://xuyj1111.github.io/DoVZDpDB6/","stats":{"text":"4 min read","time":230000,"words":907,"minutes":4},"date":"2023-02-09 14:25:27","dateFormat":"2023-02-09"},{"content":" ä» MySQL5.7.8 å¼€å§‹ï¼Œæ”¯æŒå­—æ®µä½¿ç”¨ JSON æ•°æ®ç±»å‹ JSON æ•°æ®ç±»å‹ï¼ˆå®˜ç½‘ï¼‰ JSON å‡½æ•°ç›®å½•ï¼ˆå®˜ç½‘ï¼‰ å¼€å§‹ åˆ›å»ºè¡¨å’Œå­—æ®µ CREATE TABLE t1 ( `id` BIGINT(20) NOT NULL AUTO_INCREMENT, `data` JSON, PRIMARY KEY (`id`) ); JSON ç±»å‹æ”¯æŒâ€œJSONå¯¹è±¡â€å’Œâ€œJSONæ•°ç»„â€ğŸ‘‡ JSON å¯¹è±¡ï¼š{&quot;k1&quot;: &quot;value&quot;, &quot;k2&quot;: 10} JSON æ•°ç»„ï¼š[&quot;abc&quot;, 10, null, true, false] JSON æ•°ç»„å’Œ JSON å¯¹è±¡å…è®¸äº’ç›¸åµŒå¥—ğŸ‘‡ [99, {&quot;id&quot;: &quot;HK500&quot;, &quot;cost&quot;: 75.99}, [&quot;hot&quot;, &quot;cold&quot;]] {&quot;k1&quot;: &quot;value&quot;, &quot;k2&quot;: [10, 20]} æ’å…¥æ•°æ®ç¤ºä¾‹ğŸ‘‡INSERT INTO t1(data) VALUES('{&quot;key1&quot;: &quot;value1&quot;, &quot;key2&quot;: &quot;value2&quot;}');INSERT INTO t1(data) VALUES('[&quot;a&quot;, 1, &quot;2015-07-27 09:43:47.000000&quot;] '); JSON èµ‹å€¼ç»™å˜é‡ JSON å€¼å¯ä»¥èµ‹å€¼ç»™å˜é‡ï¼Œä½†ä¸æ˜¯ JSON ç±»å‹ï¼Œè€Œæ˜¯è½¬æ¢ä¸ºå­—ç¬¦ä¸²SET @j = JSON_OBJECT('key', 'value');è½¬æ¢çš„å­—ç¬¦ä¸²å…·æœ‰å­—ç¬¦é›†â€œutf8mb4â€ï¼Œæ’åºè§„åˆ™â€œutf8mb4_binâ€ã€‚æ‰§è¡ŒSELECT CHARSET(@j),COLLATION(@j)å¯æŸ¥çœ‹utf8mb4_bin æ˜¯äºŒè¿›åˆ¶æ’åºè§„åˆ™ï¼Œæ‰€ä»¥ JSON å€¼åŒºåˆ†å¤§å°å†™ã€‚nullã€trueã€falseåœ¨ JSON ä¸­å¿…é¡»æ˜¯å°å†™å­—æ¯ mysql&gt; SELECT JSON_VALID('null'), JSON_VALID('Null'); +--------------------+--------------------+ | JSON_VALID('null') | JSON_VALID('Null') | +--------------------+--------------------+ | 1 | 0 | +--------------------+--------------------+ åˆ›å»º JSON JSON_ARRAY([val[, val] ...]) åˆ›å»º JSON æ•°æ®ğŸ‘‡ mysql&gt; SELECT JSON_ARRAY(1, &quot;abc&quot;, NULL, TRUE, CURTIME()); +---------------------------------------------+ | JSON_ARRAY(1, &quot;abc&quot;, NULL, TRUE, CURTIME()) | +---------------------------------------------+ | [1, &quot;abc&quot;, null, true, &quot;10:47:25.000000&quot;] | +---------------------------------------------+ JSON_OBJECT([key, val[, key, val] ...]) åˆ›å»º JSON å¯¹è±¡ğŸ‘‡ mysql&gt; SELECT JSON_OBJECT('id', 87, 'name', 'carrot'); +-----------------------------------------+ | JSON_OBJECT('id', 87, 'name', 'carrot') | +-----------------------------------------+ | {&quot;id&quot;: 87, &quot;name&quot;: &quot;carrot&quot;} | +-----------------------------------------+ JSON_QUOTE(string) ç”Ÿæˆ JSON å­—ç¬¦ä¸²æ–‡å­—ğŸ‘‡ mysql&gt; SELECT JSON_QUOTE('null'), JSON_QUOTE('&quot;null&quot;'), JSON_QUOTE('[1, 2, 3]'); +--------------------+----------------------+-------------------------+ | JSON_QUOTE('null') | JSON_QUOTE('&quot;null&quot;') | JSON_QUOTE('[1, 2, 3]') | +--------------------+----------------------+-------------------------+ | &quot;null&quot; | &quot;\\&quot;null\\&quot;&quot; | &quot;[1, 2, 3]&quot; | +--------------------+----------------------+-------------------------+ åˆå¹¶ JSON JSON_MERGE(json_doc, json_doc[, json_doc] ...)ğŸ‘‡ -- åˆå¹¶å¤šä¸ªæ•°ç»„ mysql&gt; SELECT JSON_MERGE('[1, 2]', '[&quot;a&quot;, &quot;b&quot;]', '[true, false]'); +-----------------------------------------------------+ | JSON_MERGE('[1, 2]', '[&quot;a&quot;, &quot;b&quot;]', '[true, false]') | +-----------------------------------------------------+ | [1, 2, &quot;a&quot;, &quot;b&quot;, true, false] | +-----------------------------------------------------+ -- åˆå¹¶å¤šä¸ªå¯¹è±¡ mysql&gt; SELECT JSON_MERGE('{&quot;a&quot;: 1, &quot;b&quot;: 2}', '{&quot;c&quot;: 3, &quot;a&quot;: 4}'); +----------------------------------------------------+ | JSON_MERGE('{&quot;a&quot;: 1, &quot;b&quot;: 2}', '{&quot;c&quot;: 3, &quot;a&quot;: 4}') | +----------------------------------------------------+ | {&quot;a&quot;: [1, 4], &quot;b&quot;: 2, &quot;c&quot;: 3} | +----------------------------------------------------+ -- åˆå¹¶å¤šä¸ªå€¼ mysql&gt; SELECT JSON_MERGE('1', '2'); +----------------------+ | JSON_MERGE('1', '2') | +----------------------+ | [1, 2] | +----------------------+ -- åˆå¹¶æ•°ç»„å’Œå¯¹è±¡ mysql&gt; SELECT JSON_MERGE('[10, 20]', '{&quot;a&quot;: &quot;x&quot;, &quot;b&quot;: &quot;y&quot;}'); +------------------------------------------------+ | JSON_MERGE('[10, 20]', '{&quot;a&quot;: &quot;x&quot;, &quot;b&quot;: &quot;y&quot;}') | +------------------------------------------------+ | [10, 20, {&quot;a&quot;: &quot;x&quot;, &quot;b&quot;: &quot;y&quot;}] | +------------------------------------------------+ è‹¥ JSON æ•°æ®ä¸­çš„ key ç›¸åŒï¼Œä¹Ÿä¼šåˆå¹¶æ•°æ® mysql&gt; INSERT INTO t1(`data`) VALUES &gt; ('{&quot;x&quot;: 17, &quot;x&quot;: &quot;red&quot;}'), &gt; ('{&quot;x&quot;: 17, &quot;x&quot;: &quot;red&quot;, &quot;x&quot;: [3, 5, 7]}'); mysql&gt; SELECT c1 FROM t1; +-----------+ | c1 | +-----------+ | {&quot;x&quot;: 17} | | {&quot;x&quot;: 17} | +-----------+ æœç´¢ JSON JSON_EXTRACT(json_doc, path[, path] ...)ğŸ‘‡ -- æ ¹æ®ç´¢å¼•ï¼ŒæŸ¥æ‰¾ value mysql&gt; SELECT JSON_EXTRACT('[10, 20, [30, 40]]', '$[1]'); +--------------------------------------------+ | JSON_EXTRACT('[10, 20, [30, 40]]', '$[1]') | +--------------------------------------------+ | 20 | +--------------------------------------------+ mysql&gt; SELECT JSON_EXTRACT('[10, 20, [30, 40]]', '$[1]', '$[0]'); +----------------------------------------------------+ | JSON_EXTRACT('[10, 20, [30, 40]]', '$[1]', '$[0]') | +----------------------------------------------------+ | [20, 10] | +----------------------------------------------------+ mysql&gt; SELECT JSON_EXTRACT('[10, 20, [30, 40]]', '$[2][*]'); +-----------------------------------------------+ | JSON_EXTRACT('[10, 20, [30, 40]]', '$[2][*]') | +-----------------------------------------------+ | [30, 40] | +-----------------------------------------------+ -- æ ¹æ® keyï¼ŒæŸ¥æ‰¾ value mysql&gt; SELECT JSON_EXTRACT('{&quot;id&quot;: 14, &quot;name&quot;: &quot;Aztalan&quot;}', '$.name'); +---------------------------------------------------------+ | JSON_EXTRACT('{&quot;id&quot;: 14, &quot;name&quot;: &quot;Aztalan&quot;}', '$.name') | +---------------------------------------------------------+ | &quot;Aztalan&quot; | +---------------------------------------------------------+ JSON_KEYS(json_doc[, path])ğŸ‘‡ -- æœªæŒ‡å®š pathï¼Œé»˜è®¤è¿”å›ç¬¬ä¸€å±‚çš„ keys mysql&gt; SELECT JSON_KEYS('{&quot;a&quot;: 1, &quot;b&quot;: {&quot;c&quot;: 30}}'); +---------------------------------------+ | JSON_KEYS('{&quot;a&quot;: 1, &quot;b&quot;: {&quot;c&quot;: 30}}') | +---------------------------------------+ | [&quot;a&quot;, &quot;b&quot;] | +---------------------------------------+ -- æŒ‡å®š pathï¼Œè¿”å›æŒ‡å®šèŠ‚ç‚¹ä¸‹çš„ keys mysql&gt; SELECT JSON_KEYS('{&quot;a&quot;: 1, &quot;b&quot;: {&quot;c&quot;: 30}}', '$.b'); +----------------------------------------------+ | JSON_KEYS('{&quot;a&quot;: 1, &quot;b&quot;: {&quot;c&quot;: 30}}', '$.b') | +----------------------------------------------+ | [&quot;c&quot;] | +----------------------------------------------+ JSON_SEARCH(json_doc, one_or_all, search_str[, escape_char[, path] ...]) è¿”å› JSON æ–‡æ¡£ä¸­åŒ¹é…å­—ç¬¦ä¸²çš„è·¯å¾„ğŸ‘‡ mysql&gt; SET @j = '[&quot;abc&quot;, [{&quot;k&quot;: &quot;10&quot;}, &quot;def&quot;], {&quot;x&quot;:&quot;abc&quot;}, {&quot;y&quot;:&quot;bcd&quot;}]'; -- one è¡¨ç¤ºåªåŒ¹é…ç¬¬ä¸€ä¸ª mysql&gt; SELECT JSON_SEARCH(@j, 'one', 'abc'); +-------------------------------+ | JSON_SEARCH(@j, 'one', 'abc') | +-------------------------------+ | &quot;$[0]&quot; | +-------------------------------+ -- all è¡¨ç¤ºåŒ¹é…æ‰€æœ‰ mysql&gt; SELECT JSON_SEARCH(@j, 'all', 'abc'); +-------------------------------+ | JSON_SEARCH(@j, 'all', 'abc') | +-------------------------------+ | [&quot;$[0]&quot;, &quot;$[2].x&quot;] | +-------------------------------+ -- search_str å¯ä»¥åªç”¨ &quot;%&quot; å’Œ &quot;_&quot; é€šé…ç¬¦ mysql&gt; SELECT JSON_SEARCH(@j, 'all', '%a%'); +-------------------------------+ | JSON_SEARCH(@j, 'all', '%a%') | +-------------------------------+ | [&quot;$[0]&quot;, &quot;$[2].x&quot;] | +-------------------------------+ -- escape_charï¼šæŒ‡å®šè½¬ä¹‰å­—ç¬¦ï¼Œå¿…é¡»æ˜¯å¸¸é‡ï¼ˆä¸ºç©ºæˆ–ä¸€ä¸ªå­—ç¬¦ï¼‰ã€‚å‚æ•°å€¼ä¸º NULL æˆ– ä¸å­˜åœ¨æ—¶ï¼Œé»˜è®¤ &quot;\\&quot; -- æŒ‰ç…§æ ¼å¼ï¼Œå¿…é¡»è¦æŒ‡å®šè½¬ä¹‰å­—ç¬¦ï¼Œæ‰å¯ä»¥ä½¿ç”¨ pathï¼Œpath å³æŒ‡å®šåŒ¹é…çš„è·¯å¾„ mysql&gt; SELECT JSON_SEARCH(@j, 'all', '%b%', '', '$[3]'); +-------------------------------------------+ | JSON_SEARCH(@j, 'all', '%b%', '', '$[3]') | +-------------------------------------------+ | &quot;$[3].y&quot; | +-------------------------------------------+ æ’å…¥/ä¿®æ”¹/åˆ é™¤ JSON JSON_INSERT(json_doc, path, val[, path, val] ...)ğŸ‘‡ mysql&gt; SET @j = '{ &quot;a&quot;: 1, &quot;b&quot;: [2, 3]}'; mysql&gt; SELECT JSON_INSERT(@j, '$.a', 10, '$.c', '[true, false]'); +----------------------------------------------------+ | JSON_INSERT(@j, '$.a', 10, '$.c', '[true, false]') | +----------------------------------------------------+ | {&quot;a&quot;: 1, &quot;b&quot;: [2, 3], &quot;c&quot;: &quot;[true, false]&quot;} | +----------------------------------------------------+ -- ä¸Šæ–¹çš„&quot;[true, false]&quot;ä¸ºå­—ç¬¦ä¸²ï¼Œè‹¥è¦è½¬ä¸º JSONï¼Œéœ€è¦ç”¨åˆ° CAST å‡½æ•° mysql&gt; SELECT JSON_INSERT(@j, '$.a', 10, '$.c', CAST('[true, false]' AS JSON)); +------------------------------------------------------------------+ | JSON_INSERT(@j, '$.a', 10, '$.c', CAST('[true, false]' AS JSON)) | +------------------------------------------------------------------+ | {&quot;a&quot;: 1, &quot;b&quot;: [2, 3], &quot;c&quot;: [true, false]} | +------------------------------------------------------------------+ JSON_REPLACE(json_doc, path, val[, path, val] ...) æ›¿æ¢JSONæ–‡æ¡£ä¸­çš„ç°æœ‰å€¼å¹¶è¿”å›ç»“æœğŸ‘‡ -- æ–‡æ¡£ä¸­å­˜åœ¨åˆ™æ›¿æ¢ï¼Œä¸å­˜åœ¨å¿½ç•¥ mysql&gt; SELECT JSON_REPLACE('{ &quot;a&quot;: 1, &quot;b&quot;: [2, 3]}', '$.a', 10, '$.c', '[true, false]'); +---------------------------------------------------------------------------+ | JSON_REPLACE('{ &quot;a&quot;: 1, &quot;b&quot;: [2, 3]}', '$.a', 10, '$.c', '[true, false]') | +---------------------------------------------------------------------------+ | {&quot;a&quot;: 10, &quot;b&quot;: [2, 3]} | +---------------------------------------------------------------------------+ JSON_SET(json_doc, path, val[, path, val] ...) åœ¨JSONæ–‡æ¡£ä¸­æ’å…¥æˆ–æ›´æ–°æ•°æ®å¹¶è¿”å›ç»“æœğŸ‘‡ -- JSON_SET = JSON_INSERT + JSON_REPLACE mysql&gt; SELECT JSON_SET('{ &quot;a&quot;: 1, &quot;b&quot;: [2, 3]}', '$.a', 10, '$.c', '[true, false]'); +-----------------------------------------------------------------------+ | JSON_SET('{ &quot;a&quot;: 1, &quot;b&quot;: [2, 3]}', '$.a', 10, '$.c', '[true, false]') | +-----------------------------------------------------------------------+ | {&quot;a&quot;: 10, &quot;b&quot;: [2, 3], &quot;c&quot;: &quot;[true, false]&quot;} | +-----------------------------------------------------------------------+ JSON_REMOVE(json_doc, path[, path] ...) åˆ é™¤å¹¶è¿”å›ç»“æœğŸ‘‡ mysql&gt; SELECT JSON_REMOVE('[&quot;a&quot;, [&quot;b&quot;, &quot;c&quot;], &quot;d&quot;]', '$[1]'); +-----------------------------------------------+ | JSON_REMOVE('[&quot;a&quot;, [&quot;b&quot;, &quot;c&quot;], &quot;d&quot;]', '$[1]') | +-----------------------------------------------+ | [&quot;a&quot;, &quot;d&quot;] | +-----------------------------------------------+ å…¶ä»– JSON å‡½æ•° JSON_TYPE(json_val) åˆ¤æ–­å€¼çš„ç±»å‹ğŸ‘‡ mysql&gt; SELECT JSON_TYPE('[&quot;a&quot;, &quot;b&quot;, 1]'), -&gt; JSON_TYPE('{&quot;key1&quot;: &quot;value1&quot;, &quot;key2&quot;: &quot;value2&quot;}'), -&gt; JSON_TYPE('&quot;hello&quot;'); +----------------------------+---------------------------------------------------+----------------------+ | JSON_TYPE('[&quot;a&quot;, &quot;b&quot;, 1]') | JSON_TYPE('{&quot;key1&quot;: &quot;value1&quot;, &quot;key2&quot;: &quot;value2&quot;}') | JSON_TYPE('&quot;hello&quot;') | +----------------------------+---------------------------------------------------+----------------------+ | ARRAY | OBJECT | STRING | +----------------------------+---------------------------------------------------+----------------------+ JSON_LENGTH(json_doc[, path]) è¿”å› JSON æ–‡æ¡£çš„é•¿åº¦ğŸ‘‡ -- æœªæŒ‡å®š pathï¼Œé»˜è®¤è¿”å›ç¬¬ä¸€å±‚çš„é•¿åº¦ mysql&gt; SELECT JSON_LENGTH('[1, 2, {&quot;a&quot;: 3}]'); +---------------------------------+ | JSON_LENGTH('[1, 2, {&quot;a&quot;: 3}]') | +---------------------------------+ | 3 | +---------------------------------+ mysql&gt; SELECT JSON_LENGTH('{&quot;a&quot;: 1, &quot;b&quot;: {&quot;c&quot;: 30}}'); +-----------------------------------------+ | JSON_LENGTH('{&quot;a&quot;: 1, &quot;b&quot;: {&quot;c&quot;: 30}}') | +-----------------------------------------+ | 2 | +-----------------------------------------+ -- æŒ‡å®š pathï¼Œè¿”å›æŒ‡å®šèŠ‚ç‚¹ä¸‹çš„é•¿åº¦ mysql&gt; SELECT JSON_LENGTH('{&quot;a&quot;: 1, &quot;b&quot;: {&quot;c&quot;: 30}}', '$.b'); +------------------------------------------------+ | JSON_LENGTH('{&quot;a&quot;: 1, &quot;b&quot;: {&quot;c&quot;: 30}}', '$.b') | +------------------------------------------------+ | 1 | +------------------------------------------------+ JSON_VALID(val) æ ¡éªŒJSONå€¼æ˜¯å¦æœ‰æ•ˆğŸ‘‡ mysql&gt; SELECT JSON_VALID('{&quot;a&quot;: 1}'), JSON_VALID('hello'), JSON_VALID('&quot;hello&quot;'); +------------------------+---------------------+-----------------------+ | JSON_VALID('{&quot;a&quot;: 1}') | JSON_VALID('hello') | JSON_VALID('&quot;hello&quot;') | +------------------------+---------------------+-----------------------+ | 1 | 0 | 1 | +------------------------+---------------------+-----------------------+ JSON æ–°è¿ç®—ç¬¦ æ’å…¥æ•°æ®INSERT INTO t1(data) VALUES (JSON_OBJECT(&quot;mascot&quot;, &quot;Our mascot is a dolphin named \\&quot;Sakila\\&quot;.&quot;));å¯ä»¥æ ¹æ® key æŸ¥æ‰¾åŒ¹é…é¡¹SELECT data-&gt;&quot;$.mascot&quot; FROM t1ï¼Œç”¨åˆ°äº†&quot;-&gt;&quot;åˆ—è·¯å¾„è¿ç®—ç¬¦ -- è¿™ç§å†™æ³•ä¼šä¸æ¯æ¡æ•°æ®éƒ½åŒ¹é…æŸ¥è¯¢ä¸€æ¬¡ï¼Œæœªæ‰¾åˆ°çš„è¿”å› null mysql&gt; SELECT data-&gt;&quot;$.mascot&quot; FROM t1; +---------------------------------------------+ | data-&gt;&quot;$.mascot&quot; | +---------------------------------------------+ | NULL | | NULL | | &quot;Our mascot is a dolphin named \\&quot;Sakila\\&quot;.&quot; | +---------------------------------------------+ -- ä½¿ç”¨å­æŸ¥è¯¢è§£å†³ä¸Šé¢é—®é¢˜ï¼Œå¿…é¡»è¦æŠŠå­æŸ¥è¯¢å‘½åä¸ºæ´¾ç”Ÿè¡¨ã€ä¹Ÿå¯ä»¥ä½¿ç”¨ JSON_EXTRACT å‡½æ•°ã€‘ mysql&gt; SELECT data-&gt;&quot;$.mascot&quot; FROM (SELECT data FROM t1 WHERE `id` = 3) AS tt; +---------------------------------------------+ | data-&gt;&quot;$.mascot&quot; | +---------------------------------------------+ | &quot;Our mascot is a dolphin named \\&quot;Sakila\\&quot;.&quot; | +---------------------------------------------+ ä½¿ç”¨&quot;-&gt;&gt;&quot;å†…è”è·¯å¾„è¿ç®—ç¬¦ mysql&gt; SELECT data-&gt;&gt;&quot;$.mascot&quot; FROM t1; +-----------------------------------------+ | data-&gt;&gt;&quot;$.mascot&quot; | +-----------------------------------------+ | NULL | | NULL | | Our mascot is a dolphin named &quot;Sakila&quot;. | +-----------------------------------------+ ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"MySQL","slug":"eng41sp6q","used":true,"link":"https://xuyj1111.github.io/eng41sp6q/"}],"title":"ã€MySQLã€‘JSON æ•°æ®ç±»å‹","feature":"","link":"https://xuyj1111.github.io/vA57Xu34i/","stats":{"text":"10 min read","time":581000,"words":1796,"minutes":10},"date":"2023-02-08 14:39:28","dateFormat":"2023-02-08"},{"content":" MySQL PREPAREé¢„å¤„ç†ï¼Œby Kevinå´” MySQL PREPARE é¢„å¤„ç†æŠ€æœ¯æ„ä¹‰åœ¨äºï¼Œæ˜¯ä¸ºäº†å‡è½»æœåŠ¡å™¨å‹åŠ›çš„ä¸€ç§æŠ€æœ¯ã€‚ å°±æ˜¯è¯´ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒæŸéœ€æ±‚æŸä¸€æ¡ SQL è¯­å¥å¯èƒ½ä¼šè¢«åå¤è°ƒç”¨æ‰§è¡Œï¼Œæˆ–è€…æ¯æ¬¡æ‰§è¡Œçš„æ—¶å€™åªæœ‰ä¸ªåˆ«çš„å€¼ä¸åŒã€‚ æ¯”å¦‚ï¼š SELECT çš„ WHERE å­å¥å€¼ä¸åŒï¼› UPDATE çš„ SET å­å¥å€¼ä¸åŒï¼› INSERT çš„ VALUES å€¼ä¸åŒï¼› å¦‚æœæ¯æ¬¡éƒ½éœ€è¦ç»è¿‡ä¸Šé¢çš„è¯æ³•è¯­ä¹‰è§£æã€è¯­å¥ä¼˜åŒ–ã€åˆ¶å®šæ‰§è¡Œè®¡åˆ’ç­‰ï¼Œåˆ™æ•ˆç‡å°±æ˜æ˜¾ä¸‹é™ã€‚ 1. é¢„å¤„ç† MySQL æä¾›äº†å¯¹æœåŠ¡å™¨ç«¯å‡†å¤‡è¯­å¥çš„æ”¯æŒï¼Œå°±å«é¢„å¤„ç†ã€‚ è¿™ç§æ”¯æŒåˆ©ç”¨äº†é«˜æ•ˆçš„å®¢æˆ·æœº / æœåŠ¡å™¨äºŒè¿›åˆ¶åè®®ï¼Œä½¿ç”¨å¸¦æœ‰å‚æ•°å€¼å ä½ç¬¦çš„é¢„ç¼–è¯‘è¯­å¥æœ‰ä»¥ä¸‹å¥½å¤„: å‡å°‘æ¯æ¬¡æ‰§è¡Œè¯­å¥æ—¶è§£æè¯­å¥çš„å¼€é”€ã€‚é€šå¸¸ï¼Œæ•°æ®åº“åº”ç”¨ç¨‹åºå¤„ç†å¤§é‡å‡ ä¹ç›¸åŒçš„è¯­å¥ï¼Œåªå¯¹å­å¥ä¸­çš„å­—é¢å€¼æˆ–å˜é‡å€¼è¿›è¡Œæ›´æ”¹ï¼Œä¾‹å¦‚ç”¨äºæŸ¥è¯¢å’Œåˆ é™¤çš„ WHEREã€ç”¨äºæ›´æ–°çš„ SET å’Œç”¨äºæ’å…¥çš„ valuesã€‚ é˜²æ­¢ SQL æ³¨å…¥æ”»å‡»ã€‚å‚æ•°å€¼å¯ä»¥åŒ…å«æœªè½¬ä¹‰çš„ SQL å¼•å·å’Œåˆ†éš”ç¬¦ã€‚ é¢„å¤„ç†æ¥å£ åº”ç”¨ç¨‹åºä¸­çš„é¢„å¤„ç†è¯­å¥ å¯ä»¥é€šè¿‡å®¢æˆ·ç«¯ç¼–ç¨‹æ¥å£ä½¿ç”¨æœåŠ¡å™¨ç«¯å‡†å¤‡å¥½çš„è¯­å¥ï¼ŒåŒ…æ‹¬ç”¨äº C ç¨‹åºçš„ MySQL C API å®¢æˆ·ç«¯åº“ï¼Œç”¨äº Java ç¨‹åºçš„ MySQL Connector/Jï¼Œä»¥åŠç”¨äºä½¿ç”¨ã€‚NET æŠ€æœ¯çš„ç¨‹åºçš„ MySQL Connector/NETã€‚ä¾‹å¦‚ï¼ŒC API æä¾›äº†ä¸€ç»„å‡½æ•°è°ƒç”¨ï¼Œè¿™äº›å‡½æ•°è°ƒç”¨æ„æˆäº†å®ƒçš„é¢„ç¼–è¯‘è¯­å¥ API 2.SQL è„šæœ¬ä¸­çš„å‡†å¤‡è¯­å¥ è¿˜æœ‰ä¸€ä¸ªç”¨äºé¢„å¤„ç†è¯­å¥çš„æ›¿ä»£ SQL æ¥å£ã€‚ä½†ä¸éœ€è¦ç¼–ç¨‹ï¼Œåœ¨ SQL çº§åˆ«ç›´æ¥å¯ç”¨ï¼Œå¯ä»¥åœ¨ä»»ä½•å¯ä»¥å°† SQL è¯­å¥å‘é€åˆ°è¦æ‰§è¡Œçš„æœåŠ¡å™¨çš„ç¨‹åºä¸­ä½¿ç”¨å®ƒï¼Œä¾‹å¦‚ mysql å®¢æˆ·ç«¯ç¨‹åºã€‚ 2. é¢„å¤„ç†åº”ç”¨æ–¹å¼ é¢„å¤„ç†è¯­å¥çš„ SQL è¯­æ³•åŸºäºä¸‰ä¸ª SQL è¯­å¥: PREPARE è¯­å¥å‡†å¤‡æ‰§è¡Œã€‚ EXECUTE æ‰§è¡Œä¸€æ¡é¢„å¤„ç†è¯­å¥ã€‚ DEALLOCATE PREPARE é‡Šæ”¾ä¸€ä¸ªé¢„å¤„ç†è¯­å¥ã€‚ A. ä¾‹å­ï¼š é¢„å¤„ç†è¯­å¥æ— æ³•è·¨ SESSION æ“ä½œï¼š mysql&gt;CREATE TABLE `t1` ( `id` int NOT NULL, NAME varchar(20), KEY `idx_id` (`id`) ) ENGINE=InnoDB ; mysql&gt;INSERT INTO t1(id,name) values(1,'A'),(2,'B'),(3,'C'),(4,'D'),(5,'E'),(6,'F'); #è®¾å®šé¢„å¤„ç†è¯­å¥ mysql&gt;PREPARE stmt1 FROM 'SELECT * FROM t1 WHERE a=? '; #è®¾ç½®ä¼ é€’å˜é‡ mysql&gt;SET @a = 8; #æ‰§è¡Œè¯­å¥ mysql&gt;EXECUTE stmt1 USING @a; #é‡Šæ”¾é¢„å¤„ç†è¯­å¥ mysql&gt;DEALLOCATE PREPAR stmt1; B. é¢„å¤„ç†å¯¹æ‰§è¡Œè®¡åˆ’å˜åŒ–è·Ÿè¸ª é€šè¿‡è§‚å¯Ÿ status æŒ‡æ ‡ Select_scanï¼ˆæ‰§è¡Œå…¨è¡¨æœç´¢æŸ¥è¯¢çš„æ•°é‡ï¼‰å˜åŒ–åˆ¤æ–­æ˜¯å¦ä¼šå—åˆ°æ•°æ®é‡å˜æ›´çš„å½±å“ã€‚ é¢„å¤„ç† sql è¯­å¥éšç€æ•°æ®é‡çš„å˜åŒ–æ‰§è¡Œè®¡åˆ’ä¹Ÿåœ¨å˜æ›´ã€‚ C. å­˜å‚¨è¿‡ç¨‹åŒ…å«é¢„å¤„ç† é¢„å¤„ç†è¯­å¥åœ¨å­˜å‚¨çš„ä¾‹ç¨‹ä¸­åˆ›å»ºé¢„å¤„ç†è¯­å¥ï¼Œåˆ™åœ¨å­˜å‚¨çš„ä¾‹ç¨‹ç»“æŸæ—¶ä¸ä¼šé‡Šæ”¾è¯¥è¯­å¥ã€‚ DELIMITER // DROP PROCEDURE IF EXISTS proc_prepared; CREATE PROCEDURE proc_prepared() BEGIN DECLARE a INT; DECLARE i INT; PREPARE stmt1 FROM 'SELECT * FROM t1 WHERE id&gt;? '; SET @a = 5; EXECUTE stmt1 USING @a; END // DELIMITER ; call proc_prepared(); å­˜å‚¨è¿‡ç¨‹ä¹‹åå•ç‹¬è°ƒç”¨é¢„å¤„ç†è¯­å¥ï¼Œè¿”å›ç»“æœé›†ï¼šè¯´æ˜é¢„å¤„ç†æ²¡æœ‰é”€æ¯ SET @a = 5; EXECUTE stmt1 USING @a; +----+------+ | id | NAME | +----+------+ | 6 | F | ã€‚ã€‚ã€‚ å­˜å‚¨è¿‡ç¨‹ä¹‹åå•ç‹¬è°ƒç”¨é¢„å¤„ç†è¯­å¥ï¼Œè¿”å›ç»“æœé›†ï¼šè¯´æ˜é¢„å¤„ç†æ²¡æœ‰é”€æ¯ SET @a = 5; EXECUTE stmt1 USING @a; +----+------+ | id | NAME | +----+------+ | 6 | F | ã€‚ã€‚ã€‚ D. é€šè¿‡ profile æŸ¥çœ‹è§£æè¯­å¥çš„å¼€é”€ é€šè¿‡ profile å„ç§è¯­å¥æ‰§è¡Œæ—¶é—´ï¼Œè§£æè¯­å¥èŠ±è´¹çš„æ—¶é—´éƒ½åœ¨ 0.01 ç§’ä»¥å†…ã€‚å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚ æ‰€ä»¥ç›®å‰åœ¨é¢„å¤„ç†æ–¹é¢ä¸Šæ²¡æœ‰å‘ç°æ˜æ˜¾çš„ä¼˜åŠ¿ã€‚ 3. æ€»ç»“ é¢„ç¼–è¯‘åˆå§‹çš„ä½œç”¨ï¼š æé«˜æ•ˆç‡ï¼šäº‹å…ˆè§£æã€æ£€æŸ¥ã€ç¼–è¯‘ç­‰å·¥ä½œã€‚ æé«˜å®‰å…¨æ€§ï¼šé¢„é˜² SQL æ³¨å…¥ å±€é™æ€§å’Œå®é™…æ•ˆæœï¼š é¢„å¤„ç†å› ä¸ºå±€é™åœ¨ session çº§åˆ«ï¼Œç°åœ¨æ— æ³•ä½“ç°çœŸæ­£çš„ä»·å€¼ã€‚å› ä¸º mysql GA ç‰ˆæœ¬æ²¡æœ‰çº¿ç¨‹æ± æ¦‚å¿µï¼Œæ¯ä¸ªé“¾æ¥å°±æ˜¯æ¯ä¸ª session è§£æç¼–è¯‘è¯­å¥çš„å¼€é”€ åŸºæœ¬å¯¹äº mysql ç¯å¢ƒæ¥è¯´å¿½ç•¥ä¸è®¡ æ‰§è¡Œè®¡åˆ’ä¹Ÿæ˜¯éšç€æ•°æ®é‡è€Œå˜åŒ–çš„ã€‚ ä»å±€é™æ€§å’Œå®é™…æ•ˆæœæ¥çœ‹ï¼Œç›®å‰æ²¡æœ‰å‘æŒ¥åº”æœ‰çš„åŠŸèƒ½ã€‚ä¸é€‚åˆå£°åœºç¯å¢ƒä¸­ä½¿ç”¨ã€‚ ","tags":[{"index":-1,"name":"è½¬è½½","slug":"JDrWa3FBq","used":true,"link":"https://xuyj1111.github.io/JDrWa3FBq/"},{"index":-1,"name":"MySQL","slug":"eng41sp6q","used":true,"link":"https://xuyj1111.github.io/eng41sp6q/"}],"title":"ã€è½¬è½½ã€‘MySQLé¢„å¤„ç†","feature":"","link":"https://xuyj1111.github.io/yZ13CWGFl/","stats":{"text":"5 min read","time":253000,"words":1105,"minutes":5},"date":"2023-02-05 17:52:26","dateFormat":"2023-02-05"},{"content":"MySQL åˆ†ä¸ºå†…è¿æ¥å’Œå¤–è¿æ¥ï¼š å†…è¿æ¥ï¼šinner joinã€cross joinã€joinã€ä¸‰è€…åœ¨ MySQL ä¸­æ˜¯ç›¸åŒçš„ã€‘ éšå¼ï¼šSELECT [cols_list] from è¡¨ 1,è¡¨ 2 where [condition] æ˜¾å¼ï¼šSELECT [cols_list] from è¡¨ 1 INNER JOIN è¡¨ 2 ON [å…³è”æ¡ä»¶] where [å…¶ä»–ç­›é€‰æ¡ä»¶] å¤–è¿æ¥ï¼šleft joinã€right joinã€full joinã€MySQL ä¸æ”¯æŒ full joinï¼Œå¯ä»¥ä½¿ç”¨left join union right joinæ›¿ä»£ã€‘ è¡¨è¿æ¥çš„å…³è”æ¡ä»¶æœ‰ä¸‰ç§ï¼š WHERE ONï¼šä¸ JOIN ä¸€èµ·ä½¿ç”¨ USINGï¼šä¸ JOIN ä¸€èµ·ä½¿ç”¨ï¼Œè¦æ±‚ä¸¤ä¸ªè¡¨çš„å­—æ®µåç›¸åŒï¼Œä¸”å…³è”æ¡ä»¶ä¸ºç›¸ç­‰ ç¬›å¡å°”ç§¯ğŸ‘‡ å®šä¹‰ï¼šè¡¨è¿æ¥çš„ç»“æœï¼Œæ˜¯å¤šä¸ªè¡¨çš„ä¹˜ç§¯ äº§ç”Ÿçš„åŸå› æ˜¯ï¼šç¼ºå°‘å…³è”æ¡ä»¶æˆ–è€…å…³è”æ¡ä»¶ä¸å‡†ç¡®ã€å¤–è¿æ¥å¿…é¡»å†™å…³è”æ¡ä»¶ï¼Œå¦åˆ™è¯­æ³•é”™è¯¯ã€‘ SELECT name,Java FROM student,souce; SELECT name,Java FROM student INNER JOIN souce; SELECT name,Java FROM student JOIN souce; SELECT name,Java FROM student CROSS JOIN souce; å„ç§è¿æ¥å›¾ç¤ºğŸ‘‡ ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"MySQL","slug":"eng41sp6q","used":true,"link":"https://xuyj1111.github.io/eng41sp6q/"}],"title":"ã€MySQLã€‘è¡¨çš„å„ç§è¿æ¥","feature":"","link":"https://xuyj1111.github.io/oGPyoz9xf/","stats":{"text":"1 min read","time":57000,"words":223,"minutes":1},"date":"2023-02-05 17:26:52","dateFormat":"2023-02-05"},{"content":"æ–°å»ºæ³¨è§£ @Retention(RetentionPolicy.RUNTIME) @Target(ElementType.TYPE) public @interface SimpleAnno { String name(); int age(); } å…¶ä¸­ä½¿ç”¨åˆ°ä¸¤ä¸ªæ³¨è§£ï¼š @Retentionï¼šå®šä¹‰æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸ @Targetï¼šè¡¨ç¤ºæ³¨è§£ä½œç”¨èŒƒå›´ï¼Œè¶…è¿‡è¿™ä¸ªä½œç”¨èŒƒå›´ï¼Œç¼–è¯‘çš„æ—¶å€™å°±ä¼šæŠ¥é”™ ä½¿ç”¨æ³¨è§£ åœ¨éœ€è¦ä½¿ç”¨çš„ç±»ä¸Šæ·»åŠ æ³¨è§£ğŸ‘‡ @Data @SimpleAnno(name = &quot;ç‹é“æŸ±&quot;, age = 59) public class TestAnnoDTO { private String name; private int age; } ä½¿ç”¨å¯¹è±¡å‰å¯ä»¥è·å–æ³¨è§£ä¸Šçš„å€¼ï¼Œæ ¹æ®å€¼åšä¸ç”¨çš„æ“ä½œï¼Œä¸€èˆ¬å†™åœ¨ factory ç±»ä¸­ğŸ‘‡ @Test public void testAnnotation() { TestAnnoDTO testAnnoDTO = new TestAnnoDTO(); Class&lt;? extends TestAnnoDTO&gt; aClass = testAnnoDTO.getClass(); SimpleAnno annotation = aClass.getAnnotation(SimpleAnno.class); if (Objects.isNull(annotation)) { System.out.println(&quot;è¯¥ç±»æ²¡æœ‰ä½¿ç”¨ [SimpleAnno] æ³¨è§£&quot;); } else { testAnnoDTO.setName(annotation.name()); testAnnoDTO.setAge(annotation.age()); System.out.println(testAnnoDTO); } } ","tags":[{"index":-1,"name":"Java","slug":"SOje8Joqr","used":true,"link":"https://xuyj1111.github.io/SOje8Joqr/"},{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"}],"title":"ã€Javaã€‘è‡ªå®šä¹‰æ³¨è§£","feature":"","link":"https://xuyj1111.github.io/TjTPK-Axn/","stats":{"text":"1 min read","time":49000,"words":180,"minutes":1},"date":"2023-02-05 16:53:03","dateFormat":"2023-02-05"},{"content":" show engines;æ˜¾ç¤ºç³»ç»Ÿæ‰€æ”¯æŒçš„å¼•æ“ç±»å‹ show variables like 'default_storage_engine%';æŸ¥çœ‹ç³»ç»Ÿçš„é»˜è®¤å­˜å‚¨å¼•æ“ set default_storage_engine = å­˜å‚¨å¼•æ“;è®¾ç½®é»˜è®¤å­˜å‚¨å¼•æ“ï¼Œä½†é‡å¯å®¢æˆ·ç«¯åï¼Œä»ä¸º InnoDB show variables like 'log_error';æŸ¥çœ‹è¿è¡Œé”™è¯¯æ—¥å¿—çš„ç›®å½• show variables like 'log_bin';æŸ¥çœ‹æ˜¯å¦å¼€å¯ binlog select @@tx_isolation;æŸ¥çœ‹å½“å‰ä¼šè¯éš”ç¦»çº§åˆ« select @@global.tx_isolation;æŸ¥çœ‹ç³»ç»Ÿéš”ç¦»çº§åˆ« set session transaction isolation level éš”ç¦»çº§åˆ«;è®¾ç½®å½“å‰ä¼šè¯éš”ç¦»çº§åˆ« set global transaction isolation level éš”ç¦»çº§åˆ«;è®¾ç½®å½“å‰ä¼šè¯éš”ç¦»çº§åˆ« å­—ç¬¦é›†ğŸ‘‡ æŸ¥çœ‹æ•°æ®åº“ç¼–ç  SHOW CREATE DATABASE db_name; æŸ¥çœ‹è¡¨ç¼–ç  SHOW CREATE TABLE tbl_name; æŸ¥çœ‹å­—æ®µç¼–ç  SHOW FULL COLUMNS FROM tbl_name; ä¿®æ”¹æ•°æ®åº“å­—ç¬¦é›† ALTER DATABASE db_name DEFAULT CHARACTER SET character_name [COLLATE ...]; æŠŠè¡¨é»˜è®¤çš„å­—ç¬¦é›†å’Œæ‰€æœ‰å­—ç¬¦åˆ—ï¼ˆCHAR,VARCHAR,TEXTï¼‰æ”¹ä¸ºæ–°çš„å­—ç¬¦é›† ALTER TABLE tbl_name CONVERT TO CHARACTER SET character_name [COLLATE ...] ç¤ºä¾‹ï¼šALTER TABLE logtest CONVERT TO CHARACTER SET utf8 COLLATE utf8_general_ci; åªæ˜¯ä¿®æ”¹è¡¨çš„é»˜è®¤å­—ç¬¦é›† ALTER TABLE tbl_name DEFAULT CHARACTER SET character_name [COLLATE...]; ç¤ºä¾‹ï¼šALTER TABLE logtest DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci; ä¿®æ”¹å­—æ®µçš„å­—ç¬¦é›† ALTER TABLE tbl_name CHANGE c_name c_name CHARACTER SET character_name [COLLATE ...]; ç¤ºä¾‹ï¼šALTER TABLE logtest CHANGE title title VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_general_ci; è¡¨ğŸ‘‡ ä¿®æ”¹è¡¨å rename table old_table to new_tableï¼› æ’å…¥å¦ä¸€ä¸ªè¡¨æ•°æ® insert into table02 select * from table01; å¤åˆ¶è¡¨æ•°æ®å’Œè¡¨ç»“æ„ create table table02 select * from table01; åªå¤åˆ¶è¡¨ç»“æ„ create table table02 like table01; ä¿®æ”¹å¯†ç ğŸ‘‡ update mysql.user set authentication_string=password('123456') where user='root' and Host ='localhost'; flush privileges;åˆ·æ–°æƒé™ åˆ›å»ºåº“ğŸ‘‡ CREATE DATABASE [IF NOT EXISTS] &lt;æ•°æ®åº“å&gt; [[DEFAULT] CHARACTER SET &lt;å­—ç¬¦é›†å&gt;] [[DEFAULT] COLLATE &lt;æ ¡å¯¹è§„åˆ™å&gt;]; ç¤ºä¾‹ï¼šCREATE DATABASE IF NOT EXISTS mygame CHARACTER SET utf8mb4 COLLATE utf8mb4_german2_ci; ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"MySQL","slug":"eng41sp6q","used":true,"link":"https://xuyj1111.github.io/eng41sp6q/"}],"title":"ã€Mysqlã€‘ä¸€äº›å‘½ä»¤","feature":"","link":"https://xuyj1111.github.io/dMqKAi0Gt/","stats":{"text":"2 min read","time":114000,"words":416,"minutes":2},"date":"2023-02-03 16:21:36","dateFormat":"2023-02-03"},{"content":"docker ç®€å•ä»‹ç» docker æ˜¯ä¸€ä¸ªåº”ç”¨å®¹å™¨å¼•æ“ï¼Œé‡è¦æ¦‚å¿µæœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š é•œåƒ å®¹å™¨ æ•°æ®å· é•œåƒå’Œå®¹å™¨çš„å…³ç³»ï¼Œä¸é¢å‘å¯¹è±¡ä¸­çš„ç±»å’Œå®ä¾‹ä¸€æ ·ï¼Œé•œåƒæ˜¯é™æ€çš„å®šä¹‰ï¼Œå®¹å™¨æ˜¯é•œåƒè¿è¡Œçš„å®ä½“ã€‚å®¹å™¨å¯ä»¥è¢«åˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤ã€æš‚åœç­‰ï¼Œå®¹å™¨æœ¬è´¨ä¸Šæ˜¯è¿›ç¨‹ã€‚ é¦–å…ˆéœ€è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ¦‚å¿µï¼š docker åœ¨ Windows å’Œ Mac ä¸Šéƒ½æœ‰æ¡Œé¢ç«¯äº†ï¼Œæ­¤æ—¶çš„ Windows/Mac åˆ™è¢«ç§°ä¸ºâ€œå®¿ä¸»æœºâ€ å®¹å™¨å­˜å‚¨å±‚çš„ç”Ÿå‘½å‘¨æœŸå’Œå®¹å™¨ä¸€æ ·ï¼Œå®¹å™¨åœæ­¢ï¼Œåˆ™å­˜å‚¨å±‚ä¸¢å¤± å®¹å™¨ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œä¸èƒ½ç›´æ¥è®¿é—® æ•°æ®å·çš„ä½œç”¨åˆ™æ˜¯ç”¨æ¥å°†å®¹å™¨æ•°æ®æŒä¹…åŒ–ï¼Œå’Œä½¿å®¹å™¨ä¹‹é—´ã€å®¹å™¨å’Œå®¿ä¸»æœºä¹‹é—´æ•°æ®ä¼ è¾“ å®‰è£… Docker Desktop å‚»ç“œå®‰è£… é…ç½®é•œåƒåŠ é€Ÿå™¨ç½‘å€ï¼Œä½¿ç”¨é˜¿é‡Œé•œåƒï¼Œéœ€è¦ç™»å½•è‡ªå·±è´¦å· å‘½ä»¤ docker [command] --helpå¸®åŠ©å‘½ä»¤ é•œåƒå‘½ä»¤ğŸ‘‡ docker imagesåˆ—å‡ºæ‰€æœ‰é•œåƒ docker inspect é•œåƒåæŸ¥çœ‹é•œåƒçš„è¯¦ç»†ä¿¡æ¯ docker search é•œåƒå æˆ–è€… ä»“åº“åç§°/é•œåƒåæŸ¥è¯¢é•œåƒã€é»˜è®¤å®˜æ–¹ä»“åº“åä¸º libraryã€‘ docker pull é•œåƒå æˆ–è€… ä»“åº“åç§°/é•œåƒåä¸‹è½½é•œåƒ docker rmi [å¯é€‰å‚æ•°] é•œåƒå [é•œåƒå...] -fï¼šå¼ºåˆ¶åˆ é™¤ å®¹å™¨å‘½ä»¤ğŸ‘‡ docker psåˆ—å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ docker inspect å®¹å™¨id æˆ– å®¹å™¨åæŸ¥çœ‹å®¹å™¨çš„è¯¦ç»†ä¿¡æ¯ docker run [å¯é€‰å‚æ•°] é•œåƒå [å‘å¯åŠ¨å®¹å™¨ä¸­ä¼ å…¥çš„å‘½ä»¤] -iï¼šæ‰“å¼€æ ‡å®¹å™¨çš„æ ‡å‡†è¾“å…¥æ¥å£ï¼Œé€šå¸¸-idæˆ–-itä½¿ç”¨ -dï¼šåå°è¿è¡Œ -tï¼šå®¹å™¨å¯åŠ¨åè¿›å…¥å‘½ä»¤è¡Œ --nameï¼šä¸ºåˆ›å»ºçš„å®¹å™¨å‘½åï¼Œé»˜è®¤éšæœºï¼Œä¸æ”¯æŒä¸­æ–‡å­—ç¬¦ -vï¼šç›®å½•æ˜ å°„ï¼Œå®¿ä¸»æœºç›®å½•:å®¹å™¨ç›®å½•ï¼Œåœ¨å®¿ä¸»æœºä¸Šä¿®æ”¹ä¼šåŒæ­¥åˆ°å®¹å™¨ä¸Šã€æŒä¹…åŒ–ã€‘ ä¸€ä¸ªå®¹å™¨å¯ä»¥æ˜ å°„å¤šä¸ªç›®å½• ä¸¤ä¸ªå®¹å™¨æ˜ å°„åŒä¸€ä¸ªç›®å½•ï¼Œå®ç°ä¸¤ä¸ªå®¹å™¨çš„æ•°æ®äº¤æ¢ -pï¼šç«¯å£æ˜ å°„ï¼Œå®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ docker exec [å¯é€‰å‚æ•°] å®¹å™¨å /bin/bash -iï¼šæ‰“å¼€æ ‡å®¹å™¨çš„æ ‡å‡†è¾“å…¥æ¥å£ï¼Œé€šå¸¸-idæˆ–-itä½¿ç”¨ -dï¼šåå°è¿è¡Œ -tï¼šå®¹å™¨å¯åŠ¨åè¿›å…¥å‘½ä»¤è¡Œ docker start å®¹å™¨id æˆ– å®¹å™¨åå¯åŠ¨å®¹å™¨ docker stop å®¹å™¨id æˆ– å®¹å™¨ååœæ­¢å®¹å™¨ docker rm [å¯é€‰å‚æ•°] å®¹å™¨id æˆ– å®¹å™¨å [IMAGE...]åˆ é™¤å®¹å™¨ã€è¿è¡ŒçŠ¶æ€åˆ é™¤å¤±è´¥ï¼Œåœæ­¢çŠ¶æ€æ‰å¯åˆ é™¤ã€‘ -fï¼šå¼ºåˆ¶åˆ é™¤ -lï¼šç§»é™¤å®¹å™¨é—´çš„ç½‘ç»œè¿æ¥ï¼Œå¹¶éå®¹å™¨æœ¬èº« -vï¼šåˆ é™¤ä¸å®¹å™¨å…³è”çš„å· åœ¨ centos å®¹å™¨ä¸­æ‰§è¡Œhostnamectl set-hostname åå­—å‘½ä»¤ï¼Œæƒ³è¦ä¿®æ”¹ä¸»æœºåï¼Œå‡ºç°æŠ¥é”™ï¼Œç„¶åä»¥ç‰¹æƒæ¨¡å¼å†ç”Ÿæˆå®¹å™¨è§£å†³docker run -itd --name master01 --privileged å®¹å™¨å /usr/sbin/initï¼Œå‚è€ƒæ–‡æ¡£docker run --privilegedå‚æ•° æ•°æ®å·å®¹å™¨ğŸ‘‡ å¯ä»¥ä½¿ç”¨docker runå‘½ä»¤çš„-vå‚æ•°å¯åŠ¨æ•°æ®å·å®¹å™¨ï¼Œå®ç°å®¹å™¨å’Œå®¿ä¸»æœºçš„æ•°æ®å…±äº« docker run -itd --name=c3 -v /volume centos /bin/bash æŒ‰ç…§æ ¼å¼ï¼Œåº”è¯¥æ˜¯â€œå®¿ä¸»æœºç›®å½•:å®¹å™¨ç›®å½•â€ï¼Œæ­¤å¤„å†™æ³•çœç•¥/volumeï¼Œå³/volume:/volume è¿˜å¯ä»¥ä½¿ç”¨--volumes-fromå‚æ•°æŒ‡å®šçˆ¶å®¹å™¨ docker run -itd --name=c1 --volumes-from c3 centos /bin/bash å†å¯åŠ¨ c2 docker run -itd --name=c2 --volumes-from c3 centos /bin/bashï¼Œå®ç°ä¸‹å›¾ç»“æ„ï¼šc1 å’Œ c2 å®é™…ä¸Šéƒ½å…³è”åˆ°å®¿ä¸»æœºï¼Œå³ä½¿ c3 æŒ‚äº†ï¼Œc1ã€c2ã€å®¿ä¸»æœºä¹‹é—´è¿˜æ˜¯èƒ½æ•°æ®å…±äº« é•œåƒåˆ¶ä½œğŸ‘‡ å¦‚æœåœ¨å®¹å™¨ä¸­è¿è¡Œä¿®æ”¹äº†è‹¥å¹²æ–‡ä»¶ï¼Œå¹¶äº§ç”Ÿäº†æ•°æ®ï¼Œæƒ³è¦ä¼ è¾“ç»™åˆ«äººä½¿ç”¨ï¼Œå°±éœ€è¦å°†å®¹å™¨è½¬æ¢ä¸ºé•œåƒï¼Œä½†é•œåƒä¸èƒ½ç›´æ¥ä¼ è¾“ï¼Œè¿˜éœ€è¦å†å°†é•œåƒè½¬ä¸ºå‹ç¼©æ–‡ä»¶ï¼Œæ¥æ”¶æ–¹æ”¶åˆ°å‹ç¼©æ–‡ä»¶åï¼Œè¿˜éœ€è¦è§£å‹æ–‡ä»¶æˆé•œåƒï¼Œæ‰å¯ä½¿ç”¨ docker commit å®¹å™¨id é•œåƒåç§°:ç‰ˆæœ¬å·å®¹å™¨è½¬æ¢ä¸ºé•œåƒ docker save -o å‹ç¼©æ–‡ä»¶åç§° é•œåƒåç§°:ç‰ˆæœ¬å·é•œåƒè½¬æ¢ä¸ºå‹ç¼©æ–‡ä»¶ docker load -i å‹ç¼©æ–‡ä»¶åç§°è§£å‹æ–‡ä»¶æˆé•œåƒ Dockerfile æ–‡ä»¶ éœ€è¦æ”¾åœ¨å®¹å™¨çš„ç¬¬ä¸€å±‚ç›®å½•ï¼Œä¸”ä¸èƒ½åç¼€åã€‚Dockerfile æœ‰ä¸€å¥—è¯­æ³•ï¼Œæ­¤å¤„ä¸åšç¬”è®° kubernetes ä½œä¸ºåç«¯ä»…äº†è§£å¤§æ¦‚ï¼Œæ²¡æœ‰å¯¹å…¶æ·±å…¥å­¦ä¹  å‰æƒ…æè¦ åœ¨ docker å®¹å™¨åŒ–æŠ€æœ¯çš„å‘å±•åï¼Œå¼€å‘è¿‡ç¨‹ä¸­å¯¹å®¹å™¨çš„æ•°é‡é€æ­¥å¢åŠ ï¼Œè¿›è€Œäº§ç”Ÿäº†ç®¡ç†å®¹å™¨çš„éœ€æ±‚ã€‚docker æœ‰ä¸‰å‰‘å®¢ï¼š Docker Machineï¼šç®¡ç†å•å°æˆ–å¤šå°ä¸»æœºæœ¬èº« Docker Composeï¼šç®¡ç†å•ä¸»æœºå®¹å™¨ Docker Swarmï¼šç®¡ç†å¤šä¸»æœºå®¹å™¨ å…¶ä¸­çš„ Docker Swarm å’Œ Kubernetes è§’è‰²å®šä½ç›¸åŒï¼Œä½†ç›®å‰æµè¡Œä½¿ç”¨ Kubernetesã€‚ ä»‹ç» è¯¦ç»†å­¦ä¹ å‚è€ƒhttps://juejin.cn/post/6952331691524358174#heading-0 å®‰è£…ï¼š åœ¨ Docker Destop ä¸­å¯åŠ¨å³å¯ åŠŸèƒ½ï¼š è‡ªåŠ¨è£…ç®±ï¼šè‡ªåŠ¨éƒ¨ç½²å®¹å™¨ è‡ªåŠ¨ä¿®å¤ï¼šä¼šé‡å¯å®¹å™¨ï¼Œä¼šé‡æ–°éƒ¨ç½²ï¼Œä¼šé‡æ–°è°ƒåº¦ï¼Œå®¹å™¨æ­£å¸¸æ‰å¯¹å¤–æä¾›æœåŠ¡ æ°´å¹³æ‰©å±•ï¼šå¯¹å®¹å™¨è§„æ¨¡æ‰©å¤§æˆ–è£å‰ª æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ æ»šåŠ¨æ›´æ–°ï¼šä¸€æ¬¡æ€§æˆ–æ‰¹é‡å¼æ›´æ–° ç‰ˆæœ¬å›é€€ çƒ­éƒ¨ç½² è‡ªåŠ¨å­˜å‚¨æ•°æ®ï¼Œå¯ä»¥å­˜å‚¨åœ¨æœ¬åœ°ã€äº‘ç«¯ç­‰ ...... èµ„æºå¯¹è±¡ï¼š podï¼šk8s ç®¡ç†è°ƒåº¦æœ€å°çš„å•ä½ã€‚1 ä¸ª pod ä¸­å¯ä»¥åŒ…å« 1 ä¸ªæˆ–å¤šä¸ªå®¹å™¨ namespaceï¼šé›†ç¾¤å†…éƒ¨çš„é€»è¾‘åˆ†å‰²ã€‚pod åœ¨ ns å†… nodeï¼šk8s é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ è¿˜æœ‰å¾ˆå¤šèµ„æºå¯¹è±¡ï¼Œç›®å‰æ²¡æœ‰å¯¹å…¶å­¦ä¹  å‘½ä»¤ å®˜æ–¹å‘½ä»¤æ–‡æ¡£ kubectl [command] --helpå¸®åŠ©å‘½ä»¤ kubectl apply -fæ–‡ä»¶æ‰§è¡Œæ–‡ä»¶ kubectl cluster-info dumpæŸ¥çœ‹é›†ç¾¤ä¿¡æ¯ kubectl get nodesæŸ¥çœ‹é›†ç¾¤èŠ‚ç‚¹ configğŸ‘‡ kubectl é»˜è®¤ä¼šä» ~/.kube ç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶åä¸º config çš„æ–‡ä»¶ï¼Œä¹Ÿèƒ½é€šè¿‡è®¾ç½®ç¯å¢ƒå˜ KUBECONFIG æˆ–è€…é€šè¿‡è®¾ç½®å»æŒ‡å®šå…¶å®ƒ kubeconfig æ–‡ä»¶ã€‚kubeconfigå°±æ˜¯ä¸ºè®¿é—®é›†ç¾¤æ‰€ä½œçš„é…ç½®ï¼Œå‚è€ƒæ–‡ç« https://blog.csdn.net/w2009211777/article/details/123798721 å¢åŠ æ–°é›†ç¾¤çš„é…ç½®ç¤ºä¾‹ï¼š kubectl config set-cluster jdcloud --server=https://xxx.xxx.xxx.xxx:xxxx --insecure-skip-tls-verify kubectl config set-credentials jdcloud --token=xxxxxx kubectl config set-context devtest --cluster=jdcloud --namespace=devtest --user=jdcloud kubectl config get-contextsæŸ¥çœ‹ç¯å¢ƒ kubectl config use-context docker-desktopåˆ‡æ¢ç¯å¢ƒ podğŸ‘‡ kubectl describe pod podåæŸ¥çœ‹podé…ç½®ä¿¡æ¯ kubectl get pod -o wideï¼šæŸ¥çœ‹æ›´å¤šä¿¡æ¯ï¼Œä¾‹å¦‚node -n namespaceåï¼šæŸ¥çœ‹æŸ ns ä¸‹çš„ pod kubectl delete pod podå -n namespaceå kubectl logs podåæŸ¥çœ‹podæ—¥å¿— -n namespaceå -c å®¹å™¨åï¼šè‹¥æœ‰å¤šä¸ªå®¹å™¨åˆ™æŒ‡å®šï¼Œpodå†…å•ä¸ªå®¹å™¨å¯çœç•¥ -fï¼šæŒç»­çœ‹æ—¥å¿— --tail=10ï¼šè·å–æœ€è¿‘åæ¡æ—¥å¿— kubectl exec -it podå -- /bin/bashè¿›å…¥podå®¹å™¨ï¼ˆexité€€å‡ºï¼‰ -c å®¹å™¨åï¼šè‹¥æœ‰å¤šä¸ªå®¹å™¨åˆ™æŒ‡å®šï¼Œpodå†…å•ä¸ªå®¹å™¨å¯çœç•¥ kubectl get pod podå -o jsonpath=&quot;{.spec['containers','initContainers'][*].name}&quot; -n namespaceåæŸ¥çœ‹podä¸‹æ‰€æœ‰å®¹å™¨ kubectl get pod,svcæŸ¥çœ‹podåŠå…¶ipå’Œç«¯å£ namespaceğŸ‘‡ kubectl get nsæŸ¥è¯¢æ‰€æœ‰ namespace kubectl get ns namespaceåæŸ¥è¯¢æŸä¸ª namespace kubectl describe ns namespaceåæŸ¥è¯¢æŸä¸ª namespace è¯¦æƒ… kubectl create ns namespaceååˆ›å»º namespace kubectl delete ns namespaceååˆ é™¤ namespace å®‰è£… Kubernetes Dashboard é¦–å…ˆéœ€è¦æ‰“å¼€ Docker Desktopï¼Œå¯åŠ¨ k8s æ‰§è¡Œå‘½ä»¤ï¼Œä¸‹è½½ Kubernetes Dashboard kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/master/aio/deploy/recommended.yaml æ–°å»ºç”¨æˆ· æ–°å»ºæ–‡ä»¶â€œadmin-user.yamlâ€ æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œå†æ‰§è¡Œå‘½ä»¤kubectl create -f admin-user.yaml apiVersion: v1 kind: ServiceAccount metadata: name: admin-user namespace: kubernetes-dashboard ç»‘å®šç”¨æˆ·å…³ç³» æ–°å»ºæ–‡ä»¶â€œadmin-user-role-binding.yamlâ€ æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œå†æ‰§è¡Œå‘½ä»¤kubectl create -f admin-user-role-binding.yaml apiVersion: rbac.authorization.k8s.io/v1 kind: ClusterRoleBinding metadata: name: admin-user roleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-admin subjects: - kind: ServiceAccount name: admin-user namespace: kubernetes-dashboard ã€è‹¥æ’¤é”€ï¼Œæ‰§è¡Œkubectl delete -f ç›¸åº”çš„yamlæ–‡ä»¶ã€‘ 4. è·å–tokenkubectl -n kubernetes-dashboard describe secret $(kubectl -n kubernetes-dashboard get secret | grep admin-user | awk '{print $1}') 5. å¯åŠ¨æœåŠ¡kubectl proxy 6. è®¿é—® http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/ 7. é€‰æ‹©â€œTokenâ€ï¼Œè¾“å…¥ä¸Šé¢è¿”å›çš„ tokenï¼Œå³å¯ç™»é™† p.s. è·å– token çš„ç¬¬äºŒä¸ªæ–¹å¼ï¼š kubectl get secret -n kubernetes-dashboard ä½¿ç”¨ä¸Šå›¾çš„â€œadmin-user-token-f674xâ€ï¼Œæ‹¼æ¥å‘½ä»¤kubectl describe secret admin-user-token-f674x -n kubernetes-dashboard ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"ä½¿ç”¨æ‰‹å†Œ","slug":"0shj16Tx0","used":true,"link":"https://xuyj1111.github.io/0shj16Tx0/"}],"title":"docker å’Œ kubernetes çš„ä½¿ç”¨","feature":"","link":"https://xuyj1111.github.io/LmWWpUbJC/","stats":{"text":"9 min read","time":484000,"words":2008,"minutes":9},"date":"2023-02-01 11:34:30","dateFormat":"2023-02-01"},{"content":"æ ‡ç­¾ æ‰€æœ‰æ–‡ç« åˆ†ä¸ºä¸¤å¤§ç±»ï¼ŒåŸåˆ›å’Œè½¬è½½ æ‚è®°å…¶ä»–çŸ¥è¯†ï¼Œä¸Javaã€MySQLã€Redisç­‰äº’æ–¥ ä½¿ç”¨æ‰‹å†Œä¸ºç®€å•ä»‹ç»æŸä¸€è½®å­ï¼Œå¦‚ä½•å¼•å…¥å’Œä½¿ç”¨ è§„èŒƒæ˜¯ä¸ºè‡ªå·±åˆ¶å®šçš„ä¸€äº›è§„èŒƒ æ€»ç»“ã€ç®—æ³•ã€MySQLã€Javaç­‰æ ‡ç­¾ä¸åšè§£é‡Š ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"è§„èŒƒ","slug":"pL5x1IP1J","used":true,"link":"https://xuyj1111.github.io/pL5x1IP1J/"}],"title":"ã€TOPã€‘å°æœ¬æœ¬çš„ä¸€äº›ä»‹ç»","feature":"","link":"https://xuyj1111.github.io/VTHVX8QhD/","stats":{"text":"1 min read","time":15000,"words":75,"minutes":1},"date":"2023-01-30 11:21:32","dateFormat":"2023-01-30"},{"content":"ä»‹ç» elastic-job æ˜¯åŸºäº Zookeeperã€Quartz å¼€å‘çš„åˆ†å¸ƒå¼å®šæ—¶ä»»åŠ¡ï¼Œè§£å†³äº† Quartz ä¸æ”¯æŒåˆ†å¸ƒå¼çš„é—®é¢˜ï¼Œä½¿ç”¨ Zookeeper å®ç°åˆ†å¸ƒå¼ã€‚ åˆ†å¸ƒå¼ï¼ˆé›†ç¾¤ï¼‰çš„å¥½å¤„æ˜¯ï¼š åˆ†å¸ƒæ€§ï¼šæ¯ä¸ªæœåŠ¡éƒ½å¯ä»¥å•ç‹¬éƒ¨ç½²ï¼ŒæœåŠ¡ä¹‹é—´é€šè¿‡ç½‘ç»œé€šä¿¡ ä¼¸ç¼©æ€§ï¼šå¯å¯¹æ¥ç‚¹è¿›è¡Œè½¯ç¡¬ä»¶æ‰©å®¹ï¼Œæœ‰ä¸€å®šä¼¸ç¼©æ€§ é«˜å¯ç”¨ï¼šé›†ç¾¤å…·æœ‰é«˜å¯ç”¨ ä½¿ç”¨ Zookeeper çš„ä½“ç° ä»»åŠ¡çš„ä¿¡æ¯å­˜å‚¨åœ¨ Zookeeper çš„èŠ‚ç‚¹ä¸Š å®ç°é€‰ä¸¾æœºåˆ¶ï¼šåœ¨å¤šä¸ªå®ä¾‹ä¸­é€‰æ‹© 1 ä¸ªæ‰§è¡Œ job ä¸»è¦çš„é…ç½®ä¿¡æ¯ namespaceï¼šå‘½åç©ºé—´ï¼Œç”¨äºæœåŠ¡é…ç½®ã€‚å¯¹åº” Zk çš„é¦–å±‚èŠ‚ç‚¹åï¼Œä¸Šå›¾ä¸­çš„mine_job jobNameï¼šjobåã€‚å¯¹åº” Zk çš„ç¬¬äºŒå±‚èŠ‚ç‚¹åï¼Œä¸Šå›¾ä¸­çš„MySimpleJobã€MyDataflowJob cronè¡¨è¾¾å¼ï¼šé…ç½®å®šæ—¶ åˆ†ç‰‡æ•° åˆ†ç‰‡å‚æ•°ï¼šæ ¼å¼åˆ†ç‰‡åºåˆ—å·=å‚æ•°å€¼ï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”ã€åˆ†ç‰‡åºåˆ—å·æœ€å°0ï¼Œæœ€å¤§åˆ†ç‰‡æ•°-1ã€‘ åˆ†ç‰‡ï¼šå°† job åˆ†ç‰‡åŒ–ï¼Œå¯è¾¾åˆ°ä»»åŠ¡å¹¶è¡Œå¤„ç†çš„æ•ˆæœï¼Œæœ€å¤§é™åº¦æé«˜æ‰§è¡Œä»»åŠ¡çš„ååé‡ã€‚ ä¾‹å¦‚æœ‰ 2 ä¸ªå®ä¾‹ï¼Œåˆ†ç‰‡æ•° 4ï¼Œåˆ™æ¯ä¸ªå®ä¾‹éƒ½è·å¾—æ‰§è¡Œ 2 ç‰‡ï¼› åˆ†ç‰‡å‚æ•°æ˜¯ç”¨æ¥åŒºåˆ†æ¯ä¸ªåˆ†ç‰‡çš„ä½œç”¨ï¼Œä¾‹å¦‚0=text,1=image,2=radio,3=videoï¼Œåˆ†ç‰‡0æ‰§è¡Œæ—¶ï¼Œä¼šæŠŠâ€œtextâ€å€¼ä¼ å…¥ï¼Œå› æ­¤å¯ä»¥åœ¨ä»£ç é‡Œæ ¹æ®å‚æ•°å€¼çš„ä¸åŒåšä¸åŒçš„å¤„ç† äº‹ä»¶è¿½è¸ªåŠŸèƒ½ ç›‘æ§ jobï¼Œéœ€è¦ä¸‹è½½elastic-job-lite-console ä»£ç ä¸­é…ç½®æ•°æ®æºï¼Œè¿è¡ŒæˆåŠŸä¼šè‡ªåŠ¨ç”Ÿæˆä¸¤å¼ è¡¨JOB_EXECUTION_LOGã€JOB_STATUS_TRACE_LOG ä¸‹è½½è§£å‹elastic-job-lite-console åœ¨ä¸‹å›¾ä¸­çš„ç›®å½•ä¸‹ï¼Œæœ‰ä¸¤ä¸ª start æ–‡ä»¶ï¼Œwindows å¯åŠ¨ batï¼ŒLinux å¯åŠ¨ sh localhost:8899æ‰“å¼€ï¼Œå¯†ç åœ¨ conf/auth.properties æ–‡ä»¶ä¸­ï¼Œé»˜è®¤ root/root åœ¨â€œæ³¨å†Œä¸­å¿ƒé…ç½®â€æ·»åŠ ï¼Œè¿æ¥åå³å¯ç›‘æ§ job ä»£ç å¼•å…¥ä½¿ç”¨ ä½¿ç”¨yinjihuançš„elastic-jobï¼Œå…·ä½“ä»‹ç»è§æ­¤é“¾æ¥ æ·»åŠ https://jitpack.io mavenä»“åº“ å¼•å…¥ä¾èµ–implementation 'com.github.yinjihuan:elastic-job-spring-boot-starter:1.0.5' applicationå¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£@EnableElasticJob application.yml æ·»åŠ é…ç½® å®ç°SimpleJobæˆ–DataflowJob&lt;&gt; SimpleJob å’Œ DataflowJob å®ç° SimpleJob çš„ä»»åŠ¡ï¼Œåªéœ€è¦åœ¨executeæ–¹æ³•ä¸­å†™é€»è¾‘ï¼Œä¸”æ ¹æ® cron è¡¨è¾¾å¼æ‰§è¡Œï¼› è€Œ DataflowJobï¼Œéœ€è¦åœ¨fetchDataæ–¹æ³•ä¸­è¯»å–æ•°æ®ï¼Œåœ¨processDataæ–¹æ³•ä¸­æ¥æ”¶æ•°æ®å¹¶å¤„ç†ã€‚è‹¥è¯»å–æ•°æ®ä¸º nullï¼Œåˆ™ job ä¼šåœæ­¢ ","tags":[{"index":-1,"name":"Java","slug":"SOje8Joqr","used":true,"link":"https://xuyj1111.github.io/SOje8Joqr/"},{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"ä½¿ç”¨æ‰‹å†Œ","slug":"0shj16Tx0","used":true,"link":"https://xuyj1111.github.io/0shj16Tx0/"}],"title":"ã€Javaã€‘elastic-jobçš„ä½¿ç”¨","feature":"","link":"https://xuyj1111.github.io/GHc69DDuF/","stats":{"text":"3 min read","time":134000,"words":588,"minutes":3},"date":"2023-01-30 11:18:19","dateFormat":"2023-01-30"},{"content":" è™šæ•°çš„æ„ä¹‰ï¼Œby é˜®ä¸€å³° æœ‰äººåœ¨ Stack Exchange é—®äº†ä¸€ä¸ªé—®é¢˜ï¼š &quot; æˆ‘ä¸€ç›´è§‰å¾—è™šæ•°ï¼ˆimaginary numberï¼‰å¾ˆéš¾æ‡‚ã€‚ ä¸­å­¦è€å¸ˆè¯´ï¼Œè™šæ•°å°±æ˜¯ - 1 çš„å¹³æ–¹æ ¹ã€‚ å¯æ˜¯ï¼Œä»€ä¹ˆæ•°çš„å¹³æ–¹ç­‰äº - 1 å‘¢ï¼Ÿè®¡ç®—å™¨ç›´æ¥æ˜¾ç¤ºå‡ºé”™ï¼ ç›´åˆ°ä»Šå¤©ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰ææ‡‚ã€‚è°èƒ½è§£é‡Šï¼Œè™šæ•°åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ å®ƒæœ‰ä»€ä¹ˆç”¨ï¼Ÿ&quot; å¸–å­çš„ä¸‹é¢ï¼Œå¾ˆå¤šäººç»™å‡ºäº†è‡ªå·±çš„è§£é‡Šï¼Œè¿˜æ¨èäº†ä¸€ç¯‡éå¸¸æ£’çš„æ–‡ç« ã€Šè™šæ•°çš„å›¾è§£ã€‹ã€‚æˆ‘è¯»åæç„¶å¤§æ‚Ÿï¼Œé†é†çŒé¡¶ï¼ŒåŸæ¥è™šæ•°è¿™ä¹ˆç®€å•ï¼Œä¸€ç‚¹ä¹Ÿä¸å¥‡æ€ªå’Œéš¾æ‡‚ï¼ ä¸‹é¢ï¼Œæˆ‘å°±ç”¨è‡ªå·±çš„è¯­è¨€ï¼Œè®²è¿°æˆ‘æ‰€ç†è§£çš„è™šæ•°ã€‚ ä¸€ã€ä»€ä¹ˆæ˜¯è™šæ•°ï¼Ÿ é¦–å…ˆï¼Œå‡è®¾æœ‰ä¸€æ ¹æ•°è½´ï¼Œä¸Šé¢æœ‰ä¸¤ä¸ªåå‘çš„ç‚¹ï¼š+1 å’Œ - 1ã€‚ è¿™æ ¹æ•°è½´çš„æ­£å‘éƒ¨åˆ†ï¼Œå¯ä»¥ç»•åŸç‚¹æ—‹è½¬ã€‚æ˜¾ç„¶ï¼Œé€†æ—¶é’ˆæ—‹è½¬ 180 åº¦ï¼Œ+1 å°±ä¼šå˜æˆ - 1ã€‚ è¿™ç›¸å½“äºä¸¤æ¬¡é€†æ—¶é’ˆæ—‹è½¬ 90 åº¦ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸‹é¢çš„å…³ç³»å¼ï¼š (+1) * (é€†æ—¶é’ˆæ—‹è½¬ 90 åº¦) * (é€†æ—¶é’ˆæ—‹è½¬ 90 åº¦) = (-1) å¦‚æœæŠŠ + 1 æ¶ˆå»ï¼Œè¿™ä¸ªå¼å­å°±å˜ä¸ºï¼š (é€†æ—¶é’ˆæ—‹è½¬ 90 åº¦)^2 = (-1) å°† &quot;é€†æ—¶é’ˆæ—‹è½¬ 90 åº¦&quot; è®°ä¸º i ï¼š i^2 = (-1) è¿™ä¸ªå¼å­å¾ˆçœ¼ç†Ÿï¼Œå®ƒå°±æ˜¯è™šæ•°çš„å®šä¹‰å…¬å¼ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè™šæ•° i å°±æ˜¯é€†æ—¶é’ˆæ—‹è½¬ 90 åº¦ï¼Œi ä¸æ˜¯ä¸€ä¸ªæ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªæ—‹è½¬é‡ã€‚ äºŒã€å¤æ•°çš„å®šä¹‰ æ—¢ç„¶ i è¡¨ç¤ºæ—‹è½¬é‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ i ï¼Œè¡¨ç¤ºä»»ä½•å®æ•°çš„æ—‹è½¬çŠ¶æ€ã€‚ å°†å®æ•°è½´çœ‹ä½œæ¨ªè½´ï¼Œè™šæ•°è½´çœ‹ä½œçºµè½´ï¼Œå°±æ„æˆäº†ä¸€ä¸ªäºŒç»´å¹³é¢ã€‚æ—‹è½¬åˆ°æŸä¸€ä¸ªè§’åº¦çš„ä»»ä½•æ­£å®æ•°ï¼Œå¿…ç„¶å”¯ä¸€å¯¹åº”è¿™ä¸ªå¹³é¢ä¸­çš„æŸä¸ªç‚¹ã€‚ åªè¦ç¡®å®šæ¨ªåæ ‡å’Œçºµåæ ‡ï¼Œæ¯”å¦‚ (1 , i)ï¼Œå°±å¯ä»¥ç¡®å®šæŸä¸ªå®æ•°çš„æ—‹è½¬é‡ï¼ˆ45 åº¦ï¼‰ã€‚ æ•°å­¦å®¶ç”¨ä¸€ç§ç‰¹æ®Šçš„è¡¨ç¤ºæ–¹æ³•ï¼Œè¡¨ç¤ºè¿™ä¸ªäºŒç»´åæ ‡ï¼šç”¨ + å·æŠŠæ¨ªåæ ‡å’Œçºµåæ ‡è¿æ¥èµ·æ¥ã€‚æ¯”å¦‚ï¼ŒæŠŠ (1 , i) è¡¨ç¤ºæˆ 1 + i ã€‚è¿™ç§è¡¨ç¤ºæ–¹æ³•å°±å«åšå¤æ•°ï¼ˆcomplex numberï¼‰ï¼Œå…¶ä¸­ 1 ç§°ä¸ºå®æ•°éƒ¨ï¼Œi ç§°ä¸ºè™šæ•°éƒ¨ã€‚ ä¸ºä»€ä¹ˆè¦æŠŠäºŒç»´åæ ‡è¡¨ç¤ºæˆè¿™æ ·å‘¢ï¼Œä¸‹ä¸€èŠ‚å‘Šè¯‰ä½ åŸå› ã€‚ ä¸‰ã€è™šæ•°çš„ä½œç”¨ï¼šåŠ æ³• è™šæ•°çš„å¼•å…¥ï¼Œå¤§å¤§æ–¹ä¾¿äº†æ¶‰åŠåˆ°æ—‹è½¬çš„è®¡ç®—ã€‚ æ¯”å¦‚ï¼Œç‰©ç†å­¦éœ€è¦è®¡ç®— &quot;åŠ›çš„åˆæˆ&quot;ã€‚å‡å®šä¸€ä¸ªåŠ›æ˜¯ 3 + i ï¼Œå¦ä¸€ä¸ªåŠ›æ˜¯ 1 + 3i ï¼Œè¯·é—®å®ƒä»¬çš„åˆæˆåŠ›æ˜¯å¤šå°‘ï¼Ÿ æ ¹æ® &quot;å¹³è¡Œå››è¾¹å½¢æ³•åˆ™&quot;ï¼Œä½ é©¬ä¸Šå¾—åˆ°ï¼ŒåˆæˆåŠ›å°±æ˜¯ (3 + i) + ( 1 + 3i ) = ( 4 + 4i )ã€‚ è¿™å°±æ˜¯è™šæ•°åŠ æ³•çš„ç‰©ç†æ„ä¹‰ã€‚ å››ã€è™šæ•°çš„ä½œç”¨ï¼šä¹˜æ³• å¦‚æœæ¶‰åŠåˆ°æ—‹è½¬è§’åº¦çš„æ”¹å˜ï¼Œå¤„ç†èµ·æ¥æ›´æ–¹ä¾¿ã€‚ æ¯”å¦‚ï¼Œä¸€æ¡èˆ¹çš„èˆªå‘æ˜¯ 3 + 4i ã€‚ å¦‚æœè¯¥èˆ¹çš„èˆªå‘ï¼Œé€†æ—¶é’ˆå¢åŠ  45 åº¦ï¼Œè¯·é—®æ–°èˆªå‘æ˜¯å¤šå°‘ï¼Ÿ 45 åº¦çš„èˆªå‘å°±æ˜¯ 1 + i ã€‚è®¡ç®—æ–°èˆªå‘ï¼Œåªè¦æŠŠè¿™ä¸¤ä¸ªèˆªå‘ 3 + 4i ä¸ 1 + i ç›¸ä¹˜å°±å¯ä»¥äº†ï¼ˆåŸå› åœ¨ä¸‹ä¸€èŠ‚è§£é‡Šï¼‰ï¼š (3 + 4i) * ( 1 + i ) = ( -1 + 7i ) æ‰€ä»¥ï¼Œè¯¥èˆ¹çš„æ–°èˆªå‘æ˜¯ -1 + 7i ã€‚ å¦‚æœèˆªå‘é€†æ—¶é’ˆå¢åŠ  90 åº¦ï¼Œå°±æ›´ç®€å•äº†ã€‚å› ä¸º 90 åº¦çš„èˆªå‘å°±æ˜¯ i ï¼Œæ‰€ä»¥æ–°èˆªå‘ç­‰äºï¼š (3 + 4i) * i = ( -4 + 3i ) è¿™å°±æ˜¯è™šæ•°ä¹˜æ³•çš„ç‰©ç†æ„ä¹‰ï¼šæ”¹å˜æ—‹è½¬è§’åº¦ã€‚ äº”ã€è™šæ•°ä¹˜æ³•çš„æ•°å­¦è¯æ˜ ä¸ºä»€ä¹ˆä¸€ä¸ªå¤æ•°æ”¹å˜æ—‹è½¬è§’åº¦ï¼Œåªè¦åšä¹˜æ³•å°±å¯ä»¥äº†ï¼Ÿ ä¸‹é¢å°±æ˜¯å®ƒçš„æ•°å­¦è¯æ˜ï¼Œå®é™…ä¸Šå¾ˆç®€å•ã€‚ ä»»ä½•å¤æ•° a + biï¼Œéƒ½å¯ä»¥æ”¹å†™æˆæ—‹è½¬åŠå¾„ r ä¸æ¨ªè½´å¤¹è§’ Î¸ çš„å½¢å¼ã€‚ å‡å®šç°æœ‰ä¸¤ä¸ªå¤æ•° a + bi å’Œ c + diï¼Œå¯ä»¥å°†å®ƒä»¬æ”¹å†™å¦‚ä¸‹ï¼š a + bi = r1 * (cosÎ± + isinÎ±) c + di = r2 * (cosÎ² + isinÎ²) è¿™ä¸¤ä¸ªå¤æ•°ç›¸ä¹˜ï¼Œ(a + bi)( c + di ) å°±ç›¸å½“äº r1 * r2 * (cosÎ± + isinÎ±) * ( cosÎ² + isinÎ² ) å±•å¼€åé¢çš„ä¹˜å¼ï¼Œå¾—åˆ° cosÎ± * cosÎ² - sinÎ± * sinÎ² + i(cosÎ± * sinÎ² + sinÎ± * cosÎ²) æ ¹æ®ä¸‰è§’å‡½æ•°å…¬å¼ï¼Œä¸Šé¢çš„å¼å­å°±ç­‰äº cos(Î±+Î²) + isin(Î±+Î²) æ‰€ä»¥ï¼Œ (a + bi)( c + di ) ï¼ r1 * r2 * ( cos(Î±+Î²) + isin(Î±+Î²) ) è¿™å°±è¯æ˜äº†ï¼Œä¸¤ä¸ªå¤æ•°ç›¸ä¹˜ï¼Œå°±ç­‰äºæ—‹è½¬åŠå¾„ç›¸ä¹˜ã€æ—‹è½¬è§’åº¦ç›¸åŠ ã€‚ ","tags":[{"index":-1,"name":"è½¬è½½","slug":"JDrWa3FBq","used":true,"link":"https://xuyj1111.github.io/JDrWa3FBq/"},{"index":-1,"name":"æ‚è®°","slug":"CseDYEWrD","used":true,"link":"https://xuyj1111.github.io/CseDYEWrD/"}],"title":"ã€è½¬è½½ã€‘è™šæ•°çš„æ„ä¹‰","feature":"","link":"https://xuyj1111.github.io/ZvPCt8HVu/","stats":{"text":"4 min read","time":237000,"words":1062,"minutes":4},"date":"2022-08-26 16:01:43","dateFormat":"2022-08-26"},{"content":" macç¯å¢ƒ è¾“å…¥å‘½ä»¤locate my.cnfï¼ŒæŸ¥æ‰¾mysqlçš„é…ç½®æ–‡ä»¶ï¼Œå¹¶åœ¨[mysqld]ä¸‹å†™å…¥binlogé…ç½® åœ¨ç³»ç»Ÿåå¥½è®¾ç½®ä¸­å…³é—­mysqlæœåŠ¡ é—®é¢˜å‘ç”Ÿï¼šæŒ‰ç†è¯´ä¿®æ”¹äº†é…ç½®æ–‡ä»¶ï¼Œé‡å¯mysqlæœåŠ¡ç«¯ï¼Œå³å¯é…ç½®ç”Ÿæ•ˆã€‚ä½†æ˜¯mysqlå¯åŠ¨å¤±è´¥ æ’æŸ¥é—®é¢˜ï¼š å›é€€åˆ°èƒ½å¯åŠ¨mysqlçŠ¶æ€ï¼Œåœ¨å®¢æˆ·ç«¯æ‰§è¡Œsqlshow variables like 'log_error'ï¼ŒæŸ¥æ‰¾é”™è¯¯æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼ˆè¯¥æ–‡ä»¶è®°å½•äº†mysqlå¯åŠ¨å’Œå…³é—­çš„æƒ…å†µï¼‰ï¼Œå¾—åˆ°é”™è¯¯æ—¥å¿—mysqld: File '/usr/local/mysql/binlog/mysql-bin.index' not found (Errcode: 13 - Permission denied) æ ¹æ®é”™è¯¯æ—¥å¿—åˆ¤æ–­ä¸ºæƒé™é—®é¢˜ï¼ŒåŸå› ä¸ºç³»ç»Ÿåå¥½è®¾ç½®ä¸­çš„å¯åŠ¨é»˜è®¤ä¸º&quot;_mysql&quot;ç”¨æˆ·ï¼Œè€Œmysqlçš„å¤§éƒ¨åˆ†æ–‡ä»¶çš„æƒé™ä»…700ã€‚åœ¨å¼€å¯binlogæœåŠ¡åï¼Œæ¶‰åŠåˆ°&quot;_mysql&quot;ç”¨æˆ·æƒé™ä¸å¤Ÿçš„æ–‡ä»¶ å…³é—­mysqlæœåŠ¡ï¼ŒæŒ‰ä¸Šæ–‡åœ¨my.cnfæ–‡ä»¶ä¸­å¼€å¯binlogåŠŸèƒ½ï¼Œç„¶ååœ¨mysqlçš„binç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤sudo mysqld --user=root ï¼ˆæå‰å»ºç«‹å¥½log_binå’Œlog_bin_indexå¯¹åº”çš„æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ï¼Œæƒé™è®¾ç½®ä¸º755ï¼Œç”¨æˆ·ç”¨æˆ·ç»„ä¸ºroot:_mysqlï¼‰ åˆ°æ­¤ä¸ºæ‰‹åŠ¨å¼€å¯mysqlæœåŠ¡ ä½†æ˜¯ç³»ç»Ÿåå¥½è®¾ç½®ä¸­å¼€å¯æˆ–å…³é—­mysqlæ— æ³•ä½¿ç”¨ï¼Œå¹¶ä¸”å¤±å»å¼€æœºè‡ªå¯åŠ¨åŠŸèƒ½ ä¿®æ”¹ç³»ç»Ÿåå¥½è®¾ç½®mysqlå¯¹åº”çš„æ‰§è¡Œæ–‡ä»¶ï¼š /Library/LaunchDaemons/com.oracle.oss.mysql.mysqld.plistï¼ˆ/Library/LaunchDaemonsè¯¥æ–‡ä»¶å¤¹ä¸­ä¸ºç³»ç»Ÿå¯åŠ¨æ—¶è¿è¡Œæ–‡ä»¶ï¼‰ .plistæ–‡ä»¶ç”¨vimæ‰“å¼€ä¹±ç ï¼Œå¯é€šè¿‡å³é”®-&gt;å¿«é€ŸæŸ¥çœ‹ æ¥æŸ¥çœ‹å†…å®¹ ä¿®æ”¹è¿™ä¸¤å¤„ä¸º&quot;root&quot; ä¿®æ”¹æ–¹å¼ï¼š â€‹ ä¸€ã€pythonï¼ˆpip install biplistæå‰å®‰è£…biplistï¼‰ from biplist import * file='com.oracle.oss.mysql.mysqld.plist' plist=readPlist(file) plist['ProgramArguments']=['/usr/local/mysql/bin/mysqld', '--user=root', '--basedir=/usr/local/mysql', '--datadir=/usr/local/mysql/data', '--plugin-dir=/usr/local/mysql/lib/plugin', '--log-error=/usr/local/mysql/data/mysqld.local.err', '--pid-file=/usr/local/mysql/data/mysqld.local.pid', '--keyring-file-data=/usr/local/mysql/keyring/keyring', '--early-plugin-load=keyring_file=keyring_file.so'] plist['UserName']='root' writePlist(plist, file) # ä¸‹é¢æ–‡ç« ä¸­ä½¿ç”¨ writePlist(plist, plist_path,binary=False) æ¥è§£å†³ä¸­æ–‡ä¹±ç é—®é¢˜ # https://www.jianshu.com/p/24e5d53b21aa â€‹ äºŒã€defaultså‘½ä»¤ï¼šmacè‡ªå¸¦å‘½ä»¤ï¼Œå¯è¯»å–ã€ä¿®æ”¹plistæ–‡ä»¶ æ³¨æ„âš ï¸ï¼šæ–‡ä»¶ä»åŸè·¯å¾„æ‹·è´åˆ°å…¶ä»–è·¯å¾„ä¿®æ”¹ï¼Œæ–‡ä»¶çš„ç”¨æˆ·å’Œç”¨æˆ·ç»„ä¼šè‡ªåŠ¨ä¿®æ”¹ï¼Œè¦†ç›–åŸè·¯å¾„çš„æ–‡ä»¶åéœ€è¦æ‰§è¡Œsudo chown -R root:wheel com.oracle.oss.mysql.mysqld.plist sudo plutil -lint com.oracle.oss.mysql.mysqld.plist æ£€æŸ¥è¯­æ³• sudo launchctl load -w com.oracle.oss.mysql.mysqld.plist åŠ è½½ï¼ˆå¿…é¡»ï¼‰ åˆ°æ­¤ä¿®æ”¹å®Œæˆï¼Œé€šè¿‡sqlshow variables like 'log_bin'æŸ¥çœ‹æ˜¯å¦å¼€å¯ p.s. åœ¨æˆåŠŸå¼€å¯binlogåŠŸèƒ½åï¼Œæ¯æ¬¡å¯åŠ¨mysqlå°±ä¼šç”Ÿæˆä¸€ä¸ªbinlogæ–‡ä»¶ã€‚è‹¥log-bin=/usr/local/mysql/binlogï¼Œåˆ™ä¼šç”Ÿæˆ/usr/local/mysql/binlog.000001æ–‡ä»¶ï¼ˆåç¼€æ•°å­—ä¼šé€’å¢ï¼‰ã€‚å½“ä¿®æ”¹log-binè·¯å¾„æ—¶ï¼Œéœ€è¦è€ƒè™‘åˆ°binlogæ–‡ä»¶çš„è¿ç§»ï¼Œä¸ç„¶å¯åŠ¨mysqlä¼šæŠ¥é”™ ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"MySQL","slug":"eng41sp6q","used":true,"link":"https://xuyj1111.github.io/eng41sp6q/"}],"title":"ã€MySQLã€‘å¼€å¯mysqlçš„binlogåŠŸèƒ½","feature":"","link":"https://xuyj1111.github.io/kI8Q0fvfJ/","stats":{"text":"3 min read","time":176000,"words":695,"minutes":3},"date":"2022-08-16 09:29:40","dateFormat":"2022-08-16"},{"content":" https://leetcode.cn/problems/zigzag-conversion/ é¢˜ç›®æè¿° å°†ä¸€ä¸ªç»™å®šå­—ç¬¦ä¸² s æ ¹æ®ç»™å®šçš„è¡Œæ•° numRows ï¼Œä»¥ä»ä¸Šå¾€ä¸‹ã€ä»å·¦åˆ°å³è¿›è¡Œ Z å­—å½¢æ’åˆ—ã€‚ æ¯”å¦‚è¾“å…¥å­—ç¬¦ä¸²ä¸º &quot;PAYPALISHIRING&quot; è¡Œæ•°ä¸º 3 æ—¶ï¼Œæ’åˆ—å¦‚ä¸‹ï¼š P A H N A P L S I I G Y I R ä¹‹åï¼Œä½ çš„è¾“å‡ºéœ€è¦ä»å·¦å¾€å³é€è¡Œè¯»å–ï¼Œäº§ç”Ÿå‡ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ï¼š&quot;PAHNAPLSIIGYIR&quot;ã€‚ è¯·ä½ å®ç°è¿™ä¸ªå°†å­—ç¬¦ä¸²è¿›è¡ŒæŒ‡å®šè¡Œæ•°å˜æ¢çš„å‡½æ•°ï¼š string convert(string s, int numRows); æ€è·¯ ä¸€å¼€å§‹ä½¿ç”¨äºŒç»´æ•°ç»„ï¼Œä½†æ˜¯å‘ç°æå‰å¼€è¾Ÿæ•°ç»„ç©ºé—´æ¯”è¾ƒéº»çƒ¦ï¼Œå¾ˆå®¹æ˜“NullPointerExceptionæˆ–è€…IndexOutOfBoundsExceptionï¼Œæ‰€ä»¥å†³å®šç”¨é›†åˆ æ ¹æ®é¢˜ç›®ä¸­çš„ Z å­—å½¢ï¼Œåˆ™éœ€è¦å˜é‡è‡ªå¢æˆ–è‡ªå‡æ¥å®šä½è¡Œæ•°ï¼Œå®šä¹‰å˜é‡flagå†³å®šè‡ªå¢æˆ–è‡ªå‡ã€‚å¼€å§‹æƒ³åˆ°ç”¨å¸ƒå°”å‹ true | falseï¼Œåæ ¹æ®ä»–äººè§£é¢˜æ€è·¯ï¼Œä½¿ç”¨æ•´å‹ 1 | -1 æ›´ä¸ºåˆé€‚ å®šä¹‰å˜é‡yyå®šä½è¡Œæ•° public String convert(String s, int numRows) { if (numRows &lt; 2) return s; List&lt;List&lt;String&gt;&gt; lists = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; numRows; i++) { lists.add(new ArrayList&lt;&gt;()); } int flag = -1; int yy = 0; for (char c : s.toCharArray()) { lists.get(yy).add(String.valueOf(c)); if (yy == 0 || yy == numRows - 1) { flag = -flag; } yy += flag; } StringBuilder result = new StringBuilder(); lists.forEach(list -&gt; result.append(String.join(&quot;&quot;, list))); return result.toString(); } ","tags":[{"index":-1,"name":"ç®—æ³•","slug":"t4VskHTZo","used":true,"link":"https://xuyj1111.github.io/t4VskHTZo/"},{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"}],"title":"Z å­—å½¢å˜æ¢","feature":"","link":"https://xuyj1111.github.io/LObGAhooa/","stats":{"text":"2 min read","time":89000,"words":334,"minutes":2},"date":"2022-08-14 16:19:52","dateFormat":"2022-08-14"},{"content":" log4j.properties æ˜¯ log4j çš„é…ç½®æ–‡ä»¶ åœ¨ SpringBoot æ¶æ„ä¸‹ï¼Œè¯¥é…ç½®æ–‡ä»¶è·¯å¾„é»˜è®¤åœ¨resourcesæ–‡ä»¶å¤¹ä¸‹ ç¤ºä¾‹ #å°†ç­‰çº§ä¸ºDEBUGçš„æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°consoleå’Œfileè¿™ä¸¤ä¸ªç›®çš„åœ°ï¼Œconsoleå’Œfileçš„å®šä¹‰åœ¨ä¸‹é¢çš„ä»£ç  log4j.rootLogger=DEBUG,console,file #æ§åˆ¶å°è¾“å‡ºçš„ç›¸å…³è®¾ç½® log4j.appender.console = org.apache.log4j.ConsoleAppender log4j.appender.console.Target = System.out log4j.appender.console.Threshold=DEBUG log4j.appender.console.layout = org.apache.log4j.PatternLayout log4j.appender.console.layout.ConversionPattern=[%c]-%m%n #æ–‡ä»¶è¾“å‡ºçš„ç›¸å…³è®¾ç½® log4j.appender.file = org.apache.log4j.RollingFileAppender log4j.appender.file.File=/Users/edy/logs/all.log log4j.appender.file.MaxFileSize=10mb log4j.appender.file.Threshold=DEBUG log4j.appender.file.layout=org.apache.log4j.PatternLayout log4j.appender.file.layout.ConversionPattern=[%p][%d{yy-MM-dd}][%c]%m%n #æ—¥å¿—è¾“å‡ºçº§åˆ« log4j.logger.org.mybatis=DEBUG log4j.logger.java.sql=DEBUG log4j.logger.java.sql.Statement=DEBUG log4j.logger.java.sql.ResultSet=DEBUG log4j.logger.java.sql.PreparedStatement=DEBUG è¯¦æƒ… log4j.rootLoggerï¼šæŠŠæŒ‡å®šçº§åˆ«ä»¥ä¸Šçš„æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°æŒ‡å®šçš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªä½ç½® è¯­æ³•ï¼šlog4j.rootLogger = [ level ] , appenderName, appenderName, â€¦ levelï¼šæ˜¯æ—¥å¿—ä¼˜å…ˆçº§ï¼Œä¸ºOFFã€FATALã€ERRORã€WARNã€INFOã€DEBUGã€ALLæˆ–è€…æ‚¨å®šä¹‰çš„çº§åˆ«ã€Log4jå»ºè®®åªä½¿ç”¨å››ä¸ªçº§åˆ«ï¼Œä¼˜å…ˆçº§ä»é«˜åˆ°ä½åˆ†åˆ«æ˜¯ERRORã€WARNã€INFOã€DEBUGã€‘ appenderNameï¼šè‡ªå®šä¹‰ä½ç½®åˆ«å log4j.appender.appenderNameï¼šè®¾ç½®è¾“å‡ºä½ç½®ï¼ŒappenderNameä¸ºä¸Šæ–¹è‡ªå®šä¹‰çš„ä½ç½®åˆ«å org.apache.log4j.ConsoleAppenderï¼ˆæ§åˆ¶å°ï¼‰ org.apache.log4j.FileAppenderï¼ˆæ–‡ä»¶ï¼‰ org.apache.log4j.DailyRollingFileAppenderï¼ˆæ¯å¤©äº§ç”Ÿä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼‰ org.apache.log4j.RollingFileAppenderï¼ˆæ–‡ä»¶å¤§å°åˆ°è¾¾æŒ‡å®šå°ºå¯¸çš„æ—¶å€™äº§ç”Ÿä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼‰ org.apache.log4j.WriterAppenderï¼ˆå°†æ—¥å¿—ä¿¡æ¯ä»¥æµæ ¼å¼å‘é€åˆ°ä»»æ„æŒ‡å®šçš„åœ°æ–¹ï¼‰ å…¶ä»–é…ç½®å¯¹åº”ä¸åŒâ€œè¾“å‡ºä½ç½®â€ï¼Œå„è‡ªçš„é…ç½® å ä½ç¬¦ %m è¾“å‡ºä»£ç ä¸­æŒ‡å®šçš„æ—¥å¿—ä¿¡æ¯ %p è¾“å‡ºä¼˜å…ˆçº§ï¼ŒåŠ DEBUGã€INFO ç­‰ %n æ¢è¡Œç¬¦ï¼ˆWindowså¹³å°çš„æ¢è¡Œç¬¦ä¸º &quot;\\n&quot;ï¼ŒUnix å¹³å°ä¸º &quot;\\n&quot;ï¼‰ %r è¾“å‡ºè‡ªåº”ç”¨å¯åŠ¨åˆ°è¾“å‡ºè¯¥ log ä¿¡æ¯è€—è´¹çš„æ¯«ç§’æ•° %c è¾“å‡ºæ‰“å°è¯­å¥æ‰€å±çš„ç±»çš„å…¨å %t è¾“å‡ºäº§ç”Ÿè¯¥æ—¥å¿—çš„çº¿ç¨‹å…¨å %d è¾“å‡ºæœåŠ¡å™¨å½“å‰æ—¶é—´ï¼Œé»˜è®¤æ ¼å¼ä¸º ISO8601ï¼Œä¹Ÿå¯ä»¥åœ¨åé¢æŒ‡å®šæ ¼å¼ã€‚å¦‚ï¼š%d{yyyyå¹´MMæœˆddæ—¥ HH:mm:ss} %l è¾“å‡ºæ—¥å¿—æ—¶é—´å‘ç”Ÿçš„ä½ç½®ï¼ŒåŒ…æ‹¬ç±»åã€å‘ç”Ÿçš„çº¿ç¨‹ï¼Œä»¥åŠåœ¨ä»£ç ä¸­çš„è¡Œæ•°ï¼Œå¦‚ï¼šTest.main(Test.java:10) %F è¾“å‡ºæ—¥å¿—æ¶ˆæ¯äº§ç”Ÿæ—¶æ‰€åœ¨çš„æ–‡ä»¶åç§° %L è¾“å‡ºä»£ç ä¸­çš„è¡Œå· %x è¾“å‡ºå’Œå½“å‰çº¿ç¨‹ç›¸å…³çš„ NDCï¼ˆåµŒå¥—è¯Šæ–­ç¯å¢ƒï¼‰ %% è¾“å‡ºä¸€ä¸ª &quot;%&quot; å­—ç¬¦ å¯ä»¥åœ¨ % ä¸å­—ç¬¦ä¹‹é—´åŠ ä¸Šä¿®é¥°ç¬¦æ¥æ§åˆ¶æœ€å°å®½åº¦ã€æœ€å¤§å®½åº¦å’Œæ–‡æœ¬çš„å¯¹å…¶æ–¹å¼ã€‚å¦‚ï¼š %5c è¾“å‡ºcategoryåç§°ï¼Œæœ€å°å®½åº¦æ˜¯5ï¼Œcategory&lt;5ï¼Œé»˜è®¤çš„æƒ…å†µä¸‹å³å¯¹é½ %-5c è¾“å‡ºcategoryåç§°ï¼Œæœ€å°å®½åº¦æ˜¯5ï¼Œcategory&lt;5ï¼Œ&quot;-&quot;å·æŒ‡å®šå·¦å¯¹é½,ä¼šæœ‰ç©ºæ ¼ %.5c è¾“å‡ºcategoryåç§°ï¼Œæœ€å¤§å®½åº¦æ˜¯5ï¼Œcategory&gt;5ï¼Œå°±ä¼šå°†å·¦è¾¹å¤šå‡ºçš„å­—ç¬¦æˆªæ‰ï¼Œ&lt;5ä¸ä¼šæœ‰ç©ºæ ¼ %20.30c categoryåç§°&lt;20è¡¥ç©ºæ ¼ï¼Œå¹¶ä¸”å³å¯¹é½ï¼Œ&gt;30å­—ç¬¦ï¼Œå°±ä»å·¦è¾¹äº¤è¿œé”€å‡ºçš„å­—ç¬¦æˆªæ‰ ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"æ‚è®°","slug":"CseDYEWrD","used":true,"link":"https://xuyj1111.github.io/CseDYEWrD/"}],"title":"log4j.propertiesçš„é…ç½®è¯¦æƒ…","feature":"","link":"https://xuyj1111.github.io/SuwnAF7n7/","stats":{"text":"4 min read","time":195000,"words":775,"minutes":4},"date":"2022-08-04 15:26:35","dateFormat":"2022-08-04"},{"content":" Shellã€Bashã€Zshè¿™éƒ½æ˜¯å•¥å•Šï¼Œby å°ç™½ç ä¸Šé£ Bash å’Œ Zsh éƒ½æ˜¯ shell å‘½ä»¤è¡Œçª—å£ Bash Bash å…¨ç§°ä¸º Bourne-Again Shellï¼Œæ˜¯å¯¹ sh çš„é‡å†™ç‰ˆï¼Œæ›¿ä»£äº† shï¼Œæ˜¯ Linux çš„é»˜è®¤ Shell é…ç½®æ–‡ä»¶ /etc/profileï¼šä¸ºç³»ç»Ÿçš„æ¯ä¸ªç”¨æˆ·è®¾ç½®ç¯å¢ƒä¿¡æ¯ï¼Œå½“ç”¨æˆ·ç¬¬ä¸€æ¬¡ç™»å½•æ—¶ä¼šæ‰§è¡Œè¯¥æ–‡ä»¶é‡Œçš„å‘½ä»¤ã€‚é»˜è®¤ä¼šç›´æ¥è°ƒç”¨/etc/bashrcã€‚è¯¥æ–‡ä»¶çš„æ”¹åŠ¨éœ€è¦é‡å¯æ‰èƒ½ç”Ÿæ•ˆ /etc/bashrcï¼šä¸ºæ¯ä¸€ä¸ªè¿è¡Œ bash shell çš„ç”¨æˆ·æ‰§è¡Œæ­¤æ–‡ä»¶ã€‚å½“ bash shell è¢«æ‰“å¼€æ—¶ï¼Œä¼šè¯»å–å¹¶æ‰§è¡Œè¯¥æ–‡ä»¶ä¸­çš„å‘½ä»¤ã€‚æ‰€ä»¥ä¿®æ”¹è¯¥æ–‡ä»¶åï¼Œé‡æ–°æ‰“å¼€ Shell å³å¯ç”Ÿæ•ˆ ~/.bash_profileï¼šå’Œ/etc/profileç±»ä¼¼ï¼Œä½†æ˜¯åªå¯¹å½“å‰ç”¨æˆ·ç”Ÿæ•ˆ ~/.bashrcï¼šå’Œ/etc/bashrcç±»ä¼¼ï¼Œä½†æ˜¯åªå¯¹å½“å‰ç”¨æˆ·ç”Ÿæ•ˆ ~/.bash_logoutï¼šå½“æ¯æ¬¡é€€å‡º bash shell æ—¶ï¼Œæ‰§è¡Œè¯¥æ–‡ä»¶ ~/.bash_historyï¼šä¿å­˜äº†å†å²å‘½ä»¤ã€‚åœ¨ Shell ä¸º Bash æ—¶ï¼Œæ¯æ¬¡æ•²å‡»å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šä¿å­˜åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œ Zsh Zsh å³ Z shellï¼ŒZsh å¯¹ sh åšå‡ºäº†å¤§é‡æ”¹è¿›ï¼ŒåŒæ—¶åŠ å…¥äº† Bashã€ksh åŠ tcsh çš„æŸäº›åŠŸèƒ½ ä» 2019 å¹´èµ·ï¼ŒmacOS çš„é»˜è®¤ Shell ä» Bash æ”¹ä¸º Zsh é…ç½®æ–‡ä»¶ ~/.zshenvï¼šå­˜æ”¾çš„ç¯å¢ƒå˜é‡é…ç½®é¡¹åœ¨ä»»ä½•åœºæ™¯ä¸‹éƒ½èƒ½è¢«è¯»å–ï¼Œè¿™é‡Œé€šå¸¸æŠŠ $PATH ç­‰å˜é‡å†™åœ¨è¿™é‡Œï¼Œè¿™æ ·æ— è®ºæ˜¯åœ¨äº¤äº’ shellï¼Œæˆ–è€…è¿è¡Œç¨‹åºéƒ½ä¼šè¯»å–æ­¤æ–‡ä»¶ã€‚ä¸ªäººç†è§£å¯¹æ ‡ Bash çš„ profile ~/.zprofileï¼šå’Œ .zlogin ç±»ä¼¼ï¼Œä½†æ˜¯æ˜¯åœ¨ .zshrc ä¹‹å‰åŠ è½½ ~/.zshrcï¼šåœ¨äº¤äº’å¼ shell ä¸­ä¼šè¯»å–å¹¶æ‰§è¡Œè¯¥æ–‡ä»¶ï¼ŒåŒ…å«è®¾ç½®åˆ«åã€å‡½æ•°ã€é€‰é¡¹ã€é”®ç»‘å®šç­‰å‘½ä»¤ã€‚å¯¹æ ‡ bashrc ~/.zloginï¼šåœ¨ login shell çš„æ—¶å€™è¯»å– ~/.zlogoutï¼šé€€å‡ºç»ˆç«¯çš„æ—¶å€™è¯»å–ï¼Œç”¨äºåšä¸€äº›æ¸…ç†å·¥ä½œã€‚å¯¹æ ‡ bash_logout ~/.zsh_historyï¼šä¿å­˜äº†å†å²å‘½ä»¤ã€‚åœ¨ Shell ä¸º Zsh æ—¶ï¼Œæ¯æ¬¡æ•²å‡»å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šä¿å­˜åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œ è¯»å–é¡ºåºï¼š.zshenv â†’ [.zprofile if login] â†’ [.zshrc if interactive] â†’ [.zlogin if login] â†’ [.zlogout sometimes] .zshrcï¼ˆ.bashrcï¼‰çš„ä½¿ç”¨ åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œå¯è‡ªå®šä¹‰ä¸€äº›æ“ä½œ ç»™å·²å­˜åœ¨çš„å‘½ä»¤èµ·åˆ«åï¼Œå®ç°æ–°å»ºå‘½ä»¤çš„æ“ä½œ ä¾‹ï¼šMac æ²¡æœ‰ updatedbå‘½ä»¤ï¼Œåˆ™åœ¨æ­¤æ–‡ä»¶ä¸­å†™å…¥alias updatedb='echo jayxcyujz | sudo -S /usr/libexec/locate.updatedb' ä¸€äº›å‘½ä»¤ æŸ¥çœ‹å½“å‰ Linux çš„å…¨éƒ¨ Shellï¼šcat /etc/shells æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„ Shellï¼šecho $SHELLæˆ–è€…echo $0 åˆ‡æ¢é»˜è®¤çš„ Shellï¼šchsh -s [shellçš„äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„]ï¼Œä¹‹åè¦é‡æ–°ç™»é™† Shell æ‰èƒ½ç”Ÿæ•ˆå“ˆã€‚ä¾‹å¦‚ï¼š åˆ‡æ¢ä¸º Bashï¼šchsh -s /bin/bash åˆ‡æ¢ä¸º Zshï¼šchsh -s /bin/zsh ä¸€äº›é—®é¢˜ åœ¨ä¿®æ”¹äº†é…ç½®æ–‡ä»¶åï¼Œéœ€è¦source fileNameåŠ è½½é…ç½®æ–‡ä»¶ å›  2019 å¹´èµ·ï¼ŒmacOs çš„ shell æ”¹ä¸º Zshã€‚å› æ­¤åœ¨ Bash çš„é…ç½®æ–‡ä»¶æ— æ•ˆï¼Œä½¿ç”¨sourceå‘½ä»¤ä»…ä¼šåœ¨å½“å‰å‘½ä»¤è¡Œçª—å£æœ‰æ•ˆï¼Œåº”è¯¥åœ¨ Zsh çš„é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"æ‚è®°","slug":"CseDYEWrD","used":true,"link":"https://xuyj1111.github.io/CseDYEWrD/"}],"title":"Bashå’ŒZsh Shellå‘½ä»¤è¡Œçª—å£","feature":"","link":"https://xuyj1111.github.io/Gw0D8kOGj/","stats":{"text":"3 min read","time":161000,"words":695,"minutes":3},"date":"2022-07-13 09:27:04","dateFormat":"2022-07-13"},{"content":" redis ä¸­è¿è¡Œ lua è„šæœ¬æ˜¯åŸå­æ€§çš„ rediså‘½ä»¤æ‰§è¡Œ æ­¤æ–¹å¼éœ€è¦å°† lua è„šæœ¬ä½œä¸ºå­—ç¬¦ä¸²ä¼ å‚ä½¿ç”¨ï¼Œé€‚åˆ lua è„šæœ¬è¾ƒçŸ­çš„æƒ…å†µ ä» Redis 2.6.0 ç‰ˆæœ¬å¼€å§‹ï¼Œé€šè¿‡å†…ç½®çš„ Lua è§£é‡Šå™¨ï¼Œå¯ä»¥ä½¿ç”¨ EVAL å‘½ä»¤å¯¹ Lua è„šæœ¬è¿›è¡Œæ±‚å€¼ EVALå‘½ä»¤ è¯­æ³•ï¼šEVAL script numkeys key [key ...] arg [arg ...] EVALï¼šå›ºå®š scriptï¼šä¸€æ®µ Lua ç¨‹åºï¼Œå­—ç¬¦ä¸² numkeysï¼šæŒ‡å®šé”®åå‚æ•°çš„ä¸ªæ•° key[key ...]ï¼šé”®åå‚æ•°ï¼Œåœ¨ LUA ä¸­ä½¿ç”¨å…¨å±€å˜é‡ KEYS æ•°ç»„è®¿é—®ï¼Œä»¥ 1 ä¸ºåŸºå€å¼€å§‹ arg[arg...]ï¼šé™„åŠ å‚æ•°ï¼Œåœ¨ LUA ä¸­ä½¿ç”¨å…¨å±€å˜é‡ ARGV æ•°ç»„è®¿é—®ï¼Œä»¥ 1 ä¸ºåŸºå€å¼€å§‹ SCRIPT LOADå‘½ä»¤ å°†è„šæœ¬æ·»åŠ åˆ° redis æœåŠ¡å™¨çš„ç¼“å­˜ä¸­ï¼Œå¹¶ä¸ç«‹å³æ‰§è¡Œï¼Œè¿”å› SHA1ã€‚é€šè¿‡ EVALSHAå‘½ä»¤ä½¿ç”¨ SHA1æ‰§è¡Œ SCRIPT FLUSHå‘½ä»¤æ¸…é™¤ç¼“å­˜ è¯­æ³•ï¼šSCRIPT LOAD script SCRIPT LOADï¼šå›ºå®š scriptï¼šä¸€æ®µ Lua ç¨‹åºï¼Œå­—ç¬¦ä¸² EVALSHAå‘½ä»¤ æ‰§è¡Œ redis æœåŠ¡å™¨ä¸­çš„ç¼“å­˜è„šæœ¬ï¼Œä½¿ç”¨å…¶ SHA1 ä½œä¸ºä¼ å‚ è¯­æ³•ï¼šEVALSHA sha1 numkeys key [key ...] arg [arg ...] EVALSHAï¼šå›ºå®š sha1ï¼šSCRIPT LOADå‘½ä»¤çš„æ‰§è¡Œç»“æœ numkeysï¼šæŒ‡å®šé”®åå‚æ•°çš„ä¸ªæ•° key[key ...]ï¼šé”®åå‚æ•°ï¼Œåœ¨ LUA ä¸­ä½¿ç”¨å…¨å±€å˜é‡ KEYS æ•°ç»„è®¿é—®ï¼Œä»¥ 1 ä¸ºåŸºå€å¼€å§‹ arg[arg...]ï¼šé™„åŠ å‚æ•°ï¼Œåœ¨ LUA ä¸­ä½¿ç”¨å…¨å±€å˜é‡ ARGV æ•°ç»„è®¿é—®ï¼Œä»¥ 1 ä¸ºåŸºå€å¼€å§‹ SCRIPT EXISTSå‘½ä»¤ ä¼ å…¥ä¸€ä¸ªæˆ–å¤šä¸ª SHA1ï¼Œåˆ¤æ–­æŒ‡å®šè„šæœ¬æ˜¯å¦åœ¨ç¼“å­˜ä¸­ï¼Œ1è¡¨ç¤ºå­˜åœ¨ï¼Œ0è¡¨ç¤ºä¸å­˜åœ¨ è¯­æ³•ï¼šSCRIPT EXISTS sha1 [sha1 â€¦] SCRIPT EXISTSï¼šå›ºå®š sha1[sha1...]ï¼šä¸€ä¸ªæˆ–å¤šä¸ªè„šæœ¬çš„ SHA1 æ ¡éªŒå’Œ SCRIPT FLUSH å‘½ä»¤ æ¸…é™¤RedisæœåŠ¡ç«¯æ‰€æœ‰ Lua è„šæœ¬ç¼“å­˜ è¯­æ³•ï¼šSCRIPT FLUSH SCRIPT KILLå‘½ä»¤ æ€æ­»æ­£åœ¨è¿è¡Œçš„ lua è„šæœ¬ï¼Œæ­¤è„šæœ¬å½“å‰æ²¡æœ‰æ‰§è¡Œä»»ä½•å†™æ“ä½œæ—¶ï¼Œæ‰ä¼šç”Ÿæ•ˆ è¯­æ³•ï¼šSCRIPT KILL SHUTDOWN NOSAVEå‘½ä»¤ è‹¥ lua è„šæœ¬æ­£åœ¨å†™æ“ä½œï¼ŒSCRIPT KILLå‘½ä»¤æ— æ³•å…³é—­ï¼Œåˆ™ä½¿ç”¨è¯¥å‘½ä»¤å…³é—­ redis æœåŠ¡å™¨ï¼Œé˜²æ­¢å†™å…¥ è¯­æ³•ï¼šSHUTDOWN NOSAVE redis-cliå®¢æˆ·ç«¯æ‰§è¡Œ æ­¤æ–¹å¼å¯ä»¥é€‰æ‹© lua æ–‡ä»¶æ‰§è¡Œ è¯­æ³•ï¼šredis-cli --eval file key [key...] , arg [arg...] fileï¼šæŒ‡å®š lua æ–‡ä»¶ã€æ³¨æ„è·¯å¾„ã€‘ key[key ...]ï¼šé”®åå‚æ•°ï¼Œåœ¨ LUA ä¸­ä½¿ç”¨å…¨å±€å˜é‡ KEYS æ•°ç»„è®¿é—®ï¼Œä»¥ 1 ä¸ºåŸºå€å¼€å§‹ arg[arg...]ï¼šé™„åŠ å‚æ•°ï¼Œåœ¨ LUA ä¸­ä½¿ç”¨å…¨å±€å˜é‡ ARGV æ•°ç»„è®¿é—®ï¼Œä»¥ 1 ä¸ºåŸºå€å¼€å§‹ p.s. ä¸éœ€è¦æŒ‡å®š key çš„æ•°é‡ï¼Œkey å’Œ arg ä¹‹é—´ä½¿ç”¨é€—å·åˆ†éš”ï¼Œé€—å·ä¸¤è¾¹éƒ½éœ€è¦ç©ºæ ¼ lua ä¸­ä½¿ç”¨ redis å‘½ä»¤ redis.call(method, param [param...]) redis.pcall(method, param [param...]) methodï¼šredis æ–¹æ³•åã€å­—ç¬¦ä¸²ã€‘ paramï¼šå¯¹åº” redis æ–¹æ³•æ‰€éœ€çš„å‚æ•° åŒºåˆ«ï¼šé”™è¯¯å¤„ç†ä¸åŒï¼Œcall é‡åˆ°é”™è¯¯åœæ­¢å¹¶æŠ›å‡ºï¼›pcall é‡åˆ°é”™è¯¯ç»§ç»­è¿è¡Œï¼Œæœ€åè¿”å›ä¸€ä¸ªå¸¦ err åŸŸçš„ lua è¡¨ï¼ˆtableç±»å‹ï¼‰ ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"Redis","slug":"FktD58SLR","used":true,"link":"https://xuyj1111.github.io/FktD58SLR/"}],"title":"ã€Redisã€‘ä½¿ç”¨Luaè„šæœ¬","feature":"","link":"https://xuyj1111.github.io/CgFjDynFC/","stats":{"text":"3 min read","time":166000,"words":698,"minutes":3},"date":"2022-07-12 10:58:42","dateFormat":"2022-07-12"},{"content":"ä»‹ç» @Valid å’Œ @Validatedéƒ½æ˜¯ç”¨æ¥å‚æ•°æ ¡éªŒçš„ @Validï¼šæ˜¯ä½¿ç”¨ Hibernate æ ¡éªŒæ—¶ä½¿ç”¨ p.s. javaçš„JSR303å£°æ˜äº†@Validè¿™ç±»æ¥å£ï¼Œè€ŒHibernate-validatorå¯¹å…¶è¿›è¡Œäº†å®ç° @Validatedï¼šæ˜¯ç”¨ Spring æ ¡éªŒæ—¶ä½¿ç”¨ ä¸¤è€…çš„åŒºåˆ« @Validï¼šå¯ä»¥ç”¨åœ¨æ–¹æ³•ã€æ„é€ å‡½æ•°ã€æ–¹æ³•å‚æ•°å’Œæˆå‘˜å±æ€§ä¸Šï¼Œæ”¯æŒåµŒå¥—æ ¡éªŒï¼Œä¸æ”¯æŒåˆ†ç»„åŠŸèƒ½ @Validatedï¼šå¯ä»¥ç”¨åœ¨ç±»å‹ã€æ–¹æ³•å’Œæ–¹æ³•å‚æ•°ä¸Šã€‚ä½†æ˜¯ä¸èƒ½ç”¨åœ¨æˆå‘˜å±æ€§ä¸Šï¼Œä¸æ”¯æŒåµŒå¥—æ ¡éªŒï¼Œæ”¯æŒåˆ†ç»„åŠŸèƒ½ æ ¡éªŒæ³¨è§£ åµŒå¥—æ ¡éªŒ ä½¿ç”¨ @Valid @PostMapping(&quot;/valid&quot;) public void testValid(@RequestBody @Valid TestDTO dto) { System.out.println(&quot;dto: &quot; + dto); } @Data public class TestDTO { @Min(10) private Integer number; /** * @Description: @Valid çš„åµŒå¥—æ ¡éªŒ */ @Valid private InnerDTO innerDTO; @Data public class InnerDTO { @NotNull private Long id; @NotBlank private String name; } } åˆ†ç»„æ ¡éªŒ ä½¿ç”¨ @Validatedï¼Œæ­¤å¤„çš„ç¤ºä¾‹åœ¨GroupInterfaceä¸­ä½¿ç”¨ @GroupSequence æ³¨è§£ï¼Œä»¥æ­¤è¾¾åˆ°æŒ‰ç…§è¯¥æ³¨è§£ä¸­çš„ç»„é¡ºåºä¾æ¬¡æ ¡éªŒï¼Œå¯¹æœªæŒ‡å®šç»„çš„å±æ€§ä¸æ ¡éªŒ è‹¥å†™æˆ@Validated({FirstGroupInterface.class})ï¼Œåˆ™è¡¨ç¤ºåªå¯¹FirstGroupInterfaceç»„çš„å±æ€§æ ¡éªŒ è‹¥å†™æˆ@Validated({FirstGroupInterface.class, SecordGroupInterface.class})ï¼Œåˆ™è¡¨ç¤ºå¯¹å¤šä¸ªç»„çš„å±æ€§æ ¡éªŒï¼Œä½†æ˜¯æ— åº @PostMapping(&quot;/validated&quot;) public void testValidated(@RequestBody @Validated({GroupInterface.class}) TestDTO dto) { System.out.println(&quot;dto: &quot; + dto); } @Data public class TestDTO { /** * @Description: @Validated çš„åˆ†ç»„æ ¡éªŒ */ @NotEmpty(groups={FirstGroupInterface.class}) private String id; @NotEmpty(groups={SecordGroupInterface.class}) private String name; } å…ˆæ ¡éªŒFirstGroupInterfaceç»„ï¼Œå†æ ¡éªŒSecordGroupInterfaceç»„ @GroupSequence({FirstGroupInterface.class, SecordGroupInterface.class}) public interface GroupInterface { } FirstGroupInterfaceå’ŒSecordGroupInterfaceéƒ½æ˜¯ç©ºæ¥å£ ","tags":[{"index":-1,"name":"Java","slug":"SOje8Joqr","used":true,"link":"https://xuyj1111.github.io/SOje8Joqr/"},{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"}],"title":"ã€Javaã€‘ä½¿ç”¨@Validæˆ–@Validatedå‚æ•°æ ¡éªŒ","feature":"","link":"https://xuyj1111.github.io/FOFqe4ayF/","stats":{"text":"2 min read","time":92000,"words":355,"minutes":2},"date":"2022-05-07 16:57:07","dateFormat":"2022-05-07"},{"content":" åŸŸåèƒŒåé‚£äº›äº‹ï¼Œby LeanCloud äº’è”ç½‘ä¸­çš„åœ°å€æ˜¯æ•°å­—çš„ IP åœ°å€ï¼Œä¾‹å¦‚61.135.169.125å°±æ˜¯ç™¾åº¦çš„å®˜ç½‘åœ°å€ä¹‹ä¸€ï¼Œå¦‚æœæ¯æ¬¡è®¿é—®ç™¾åº¦éƒ½éœ€è¦è¾“å…¥ IP çš„è¯ï¼Œä¼°è®¡åˆ°ä»Šå¤©äº’è”ç½‘éƒ½è¿˜æ²¡æœ‰èµ°å‡ºé¸¿è’™é˜¶æ®µã€‚ åœ¨ç½‘ç»œå‘å±•å†å²ä¸Šï¼Œæœ€å¼€å§‹ç¡®å®å°±æ˜¯ç›´æ¥ä½¿ç”¨ IP åœ°å€æ¥è®¿é—®è¿œç¨‹ä¸»æœºçš„ã€‚æ—©æœŸè”ç½‘çš„æ¯å°è®¡ç®—æœºéƒ½æ˜¯é‡‡ç”¨ä¸»æœºæ–‡ä»¶ï¼ˆå³æˆ‘ä»¬ä¿—ç§°çš„ hosts æ–‡ä»¶ï¼‰æ¥è¿›è¡Œåœ°å€é…ç½®å’Œè§£æçš„ï¼Œåæ¥è”ç½‘æœºå™¨è¶Šæ¥è¶Šå¤šï¼Œä¸»æœºæ–‡ä»¶çš„æ›´æ–°å’ŒåŒæ­¥å°±æˆäº†å¾ˆå¤§çš„é—®é¢˜ã€‚äºæ˜¯ï¼Œ1983 å¹´ä¿ç½— Â· è«å¡æ´¾ä¹”æ–¯å‘æ˜äº†åŸŸåè§£ææœåŠ¡å’ŒåŸŸåç³»ç»Ÿï¼Œåœ¨ 1985 å¹´ 1 æœˆ 1 æ—¥ï¼Œä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªåŸŸå nordu.net æ‰è¢«æ³¨å†ŒæˆåŠŸã€‚ åŸŸåæ¯” IP åœ°å€æ›´å®¹æ˜“è®°å¿†ï¼Œæœ¬è´¨ä¸Šåªæ˜¯ä¸ºæ•°å­—åŒ–çš„äº’è”ç½‘èµ„æºæä¾›äº†æ˜“äºè®°å¿†çš„åˆ«åï¼Œå°±åƒåœ¨åŒ—äº¬æèµ·ã€Œæ•…å®«åšç‰©é™¢ã€å°±éƒ½çŸ¥é“æŒ‡çš„æ˜¯ã€Œä¸œåŸåŒºæ™¯å±±å‰è¡— 4 å·ã€çš„é‚£ä¸ªå¤§é™¢å­ä¸€æ ·ã€‚å¦‚æœæŠŠ IP åœ°å€çœ‹æˆç”µè¯å·ç ï¼Œé‚£åŸŸåç³»ç»Ÿå°±æ˜¯é€šè®¯å½•ã€‚æˆ‘ä»¬åœ¨é€šè®¯å½•é‡Œä¿å­˜äº†æœ‹å‹å’Œå®¶äººçš„ä¿¡æ¯ï¼Œæ¯æ¬¡é€šè¿‡åå­—æ‰¾åˆ°æŸäººæ‰“ç”µè¯çš„æ—¶å€™ï¼Œé€šè®¯å½•å°±ä¼šæŸ¥å‡ºä¸ä¹‹å…³è”çš„ç”µè¯å·ç ï¼Œç„¶åæ‹¨å·è¿‡å»ã€‚æˆ‘ä»¬å¯èƒ½è®°ä¸ä¸‹å¤šå°‘å®Œæ•´çš„ç”µè¯å·ç ï¼Œä½†æ˜¯è”ç³»äººçš„åå­—å´æ˜¯ä¸€å®šè®°å¾—çš„ã€‚ æ—¢ç„¶ã€ŒåŸŸåã€åªæ˜¯ä¸€ä¸ªåˆ«åï¼Œå•å‡­è¿™ä¸€ä¸ªåå­—æˆ‘ä»¬å¹¶ä¸èƒ½è®¿é—®åˆ°æ­£ç¡®çš„åœ°å€ï¼Œåªæœ‰èƒ½å°†åŸŸåè§£ææˆå®é™…çš„ç½‘ç»œåœ°å€ï¼Œç½‘ç»œè®¿é—®æ‰èƒ½æˆåŠŸã€‚è¿™ç§è§£æå·¥ä½œç”±ä¸“é—¨çš„ã€ŒåŸŸåç³»ç»Ÿã€ï¼ˆDomain Name Systemï¼Œç®€ç§° DNSï¼‰å®Œæˆï¼ŒDNS ä¹Ÿæ˜¯äº’è”ç½‘çš„æ ¸å¿ƒåŸºç¡€æœåŠ¡ä¹‹ä¸€ã€‚ åŸŸåè§£ææ˜¯æ€ä¹ˆå®Œæˆçš„ DNS è§£æçš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·å­çš„å‘¢ï¼Ÿåœ¨å¼€å§‹è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€çœ‹åŸŸåçš„å±‚æ¬¡ç»“æ„ã€‚ åŸŸåçš„å±‚çº§ç»“æ„ åœ¨è®¨è®ºåŸŸåçš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»å¸¸å¬åˆ°æœ‰äººè¯´ã€Œé¡¶çº§åŸŸåã€ã€ã€Œä¸€çº§åŸŸåã€ã€ã€ŒäºŒçº§åŸŸåã€ç­‰æ¦‚å¿µï¼ŒåŸŸåçº§åˆ«ç©¶ç«Ÿæ˜¯æ€ä¹ˆåˆ’åˆ†çš„å‘¢ï¼Ÿ æ ¹åŸŸåã€‚è¿˜æ˜¯ä»¥ç™¾åº¦ä¸ºä¾‹ï¼Œé€šè¿‡ä¸€äº›åŸŸåè§£æå·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç™¾åº¦å®˜ç½‘åŸŸåæ˜¾ç¤ºä¸º www.baidu.com.ï¼Œç»†å¿ƒçš„äººä¼šæ³¨æ„åˆ°ï¼Œè¿™é‡Œæœ€åæœ‰ä¸€ä¸ª .ï¼Œè¿™ä¸æ˜¯ bugï¼Œè€Œæ˜¯æ‰€æœ‰åŸŸåçš„å°¾éƒ¨éƒ½æœ‰ä¸€ä¸ªæ ¹åŸŸåã€‚www.baidu.com çœŸæ­£çš„åŸŸåæ˜¯ www.baidu.com.rootï¼Œç®€å†™ä¸ºwww.baidu.com.ï¼Œåˆå› ä¸ºæ ¹åŸŸå.rootå¯¹äºæ‰€æœ‰åŸŸåéƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å¹³æ—¶æ˜¯çœç•¥çš„ï¼Œæœ€ç»ˆå°±å˜æˆäº†æˆ‘ä»¬å¸¸è§çš„æ ·å­ã€‚ æ ¹åŸŸåçš„ä¸‹ä¸€çº§å«åšé¡¶çº§åŸŸåï¼ˆtop-level domainï¼Œç¼©å†™ä¸º TLDï¼‰ï¼Œä¹Ÿå«åšä¸€çº§åŸŸåï¼Œå¸¸è§çš„å¦‚ .com / .net / .org / .cn ç­‰ç­‰ï¼Œä»–ä»¬å°±æ˜¯é¡¶çº§åŸŸåã€‚ å†ä¸‹ä¸€çº§å«åšäºŒçº§åŸŸåï¼ˆsecond-level domainï¼Œç¼©å†™ä¸º SLDï¼‰ï¼Œæ¯”å¦‚ baidu.comã€‚è¿™æ˜¯æˆ‘ä»¬èƒ½å¤Ÿè´­ä¹°å’Œæ³¨å†Œçš„æœ€é«˜çº§åŸŸåã€‚ æ¬¡çº§åŸŸåä¹‹ä¸‹ï¼Œå°±æ˜¯ä¸»æœºåï¼ˆhostï¼‰ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºä¸‰çº§åŸŸåï¼Œæ¯”å¦‚ www.baidu.comï¼Œç”±æ­¤å¾€ä¸‹ï¼ŒåŸºæœ¬ä¸Š N çº§åŸŸåå°±æ˜¯åœ¨ N-1 çº§åŸŸåå‰è¿½åŠ ä¸€çº§ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œå¸¸è§çš„åŸŸåå±‚çº§ç»“æ„å¦‚ä¸‹ï¼š ä¸»æœºå.æ¬¡çº§åŸŸå.é¡¶çº§åŸŸå.æ ¹åŸŸå www.baidu.com.root ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬è´­ä¹°ä¸€ä¸ªåŸŸåå°±æ˜¯è´­ä¹°ä¸€ä¸ªäºŒçº§åŸŸåï¼ˆSLDï¼‰çš„ç®¡ç†æƒï¼ˆå¦‚ leancloud.cnï¼‰ï¼Œæœ‰äº†è¿™ä¸ªç®¡ç†æƒæˆ‘ä»¬å°±å¯ä»¥éšæ„è®¾ç½®ä¸‰çº§ã€å››çº§åŸŸåäº†ã€‚ åŸŸåè§£æçš„è¿‡ç¨‹ ä¸åŸŸåçš„åˆ†çº§ç»“æ„å¯¹åº”ï¼ŒDNS ç³»ç»Ÿä¹Ÿæ˜¯ä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œä¸åŒçº§åˆ«çš„åŸŸåç”±ä¸åŒçš„åŸŸåæœåŠ¡å™¨æ¥è§£æï¼Œæ•´ä¸ªè¿‡ç¨‹æ˜¯ä¸€ä¸ªã€Œå±‚çº§å¼ã€çš„ã€‚ å±‚çº§å¼åŸŸåè§£æä½“ç³»çš„ç¬¬ä¸€å±‚å°±æ˜¯æ ¹åŸŸåæœåŠ¡å™¨ï¼Œå…¨ä¸–ç•Œ IPv4 æ ¹åŸŸåæœåŠ¡å™¨åªæœ‰ 13 å°ï¼ˆåå­—åˆ†åˆ«ä¸º A è‡³ Mï¼‰ï¼Œ1 ä¸ªä¸ºä¸»æ ¹æœåŠ¡å™¨åœ¨ç¾å›½ï¼Œå…¶ä½™ 12 ä¸ªå‡ä¸ºè¾…æ ¹æœåŠ¡å™¨ï¼Œå®ƒä»¬è´Ÿè´£ç®¡ç†ä¸–ç•Œå„å›½çš„åŸŸåä¿¡æ¯ã€‚åœ¨æ ¹æœåŠ¡å™¨ä¸‹é¢æ˜¯é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼Œå³ç›¸å…³å›½å®¶åŸŸåç®¡ç†æœºæ„çš„æ•°æ®åº“ï¼Œå¦‚ä¸­å›½äº’è”ç½‘ç»œä¿¡æ¯ä¸­å¿ƒï¼ˆCNNICï¼‰ã€‚ç„¶åæ˜¯å†ä¸‹ä¸€çº§çš„æƒå¨åŸŸåæœåŠ¡å™¨å’Œ ISP çš„ç¼“å­˜æœåŠ¡å™¨ã€‚ ä¸€ä¸ªåŸŸåå¿…é¡»é¦–å…ˆç»è¿‡æ ¹æ•°æ®åº“çš„è§£æåï¼Œæ‰èƒ½è½¬åˆ°é¡¶çº§åŸŸåæœåŠ¡å™¨è¿›è¡Œè§£æï¼Œè¿™ä¸€ç‚¹ä¸ç”Ÿæ´»ä¸­é—®è·¯çš„æƒ…å½¢æœ‰å‡ åˆ†ç›¸ä¼¼ã€‚ å‡è®¾åŒ—äº¬å¸‚è®¾ç«‹äº†ä¸€ä¸ªä¸“é—¨çš„ã€Œé“è·¯å’¨è¯¢å±€ã€ï¼Œé‡Œé¢è®¾ç½®äº†å±€é•¿ã€éƒ¨é•¿ã€å¤„é•¿ã€ç§‘å‘˜å¥½å‡ ä¸ªçº§åˆ«çš„å…¬åŠ¡å‘˜ï¼Œä¸åŒçš„éƒ¨é—¨ã€ç§‘å®¤ã€äººå‘˜è´Ÿè´£è§£ç­”ä¸åŒåŒºåŸŸçš„é“è·¯é—®é¢˜ã€‚è¿™é‡Œçš„äººéƒ½æœ‰ä¸€ä¸ªå…±åŒç‰¹ç‚¹ï¼Œä¿¡å¥‰ã€Œå¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ã€çš„å“²ç†ï¼Œå–œæ¬¢å°†è‡ªå·±äº†è§£åˆ°çš„ä¿¡æ¯è®°å½•åˆ°ç¬”è®°æœ¬ä¸Šã€‚ä½†æ˜¯æœ‰ä¸€ç‚¹é—æ†¾çš„æ˜¯ï¼Œä»–ä»¬å†™å­—ç”¨çš„å¢¨æ°´åªæœ‰ä¸€ç§ï¼Œå«ã€Œé­”æœ¯å¢¨æ°´ã€ï¼Œåˆå†™å­—è¿¹æµ“åšï¼Œä¹‹åä¼šæ…¢æ…¢å˜æ·¡ï¼Œ1 å°æ—¶ä¹‹ååˆ™ä¼šå®Œå…¨æ¶ˆå¤±ã€‚é“è·¯å’¨è¯¢å±€é—¨å£è¿˜æœ‰ä¸€ä¸ªé—¨å«å¤§çˆ·ï¼Œæ‰€æœ‰çš„äººè¦é—®è·¯éƒ½éœ€è¦é€šè¿‡ä»–æ¥ä¼ è¾¾å’Œå›å¤ï¼Œå¸‚æ°‘å¹¶ä¸èƒ½è¿›å…¥åŠå…¬æ¥¼ã€‚ å¦‚æœå¸‚æ°‘ A å…ˆç”Ÿæ¥æ‰¾é—¨å«å¤§çˆ·è¯¢é—®ã€ŒåŒ—æµ·å…¬å›­ã€çš„åœ°å€ï¼Œé—¨å«å¤§çˆ·ä¼šå…ˆçœ‹ä¸€ä¸‹è‡ªå·±çš„ç¬”è®°æœ¬ï¼Œæ‰¾æ‰¾çœ‹ä¹‹å‰æœ‰æ²¡æœ‰äººé—®è¿‡åŒ—æµ·å…¬å›­ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä»–å°±ä¼šæ‹¨æ‰“å†…çº¿å»æ‰¾å±€é•¿æ±‚åŠ©ã€‚å±€é•¿è¯´åŒ—æµ·æ˜¯è¥¿åŸåŒºï¼Œä½ å»é—®è´Ÿè´£è¥¿åŸåŒºé“è·¯ä¿¡æ¯çš„èµµéƒ¨é•¿å§ã€‚é—¨å«å¤§çˆ·åˆå»é—®èµµéƒ¨é•¿ï¼Œèµµéƒ¨é•¿æŸ¥äº†ä¸€ä¸‹ï¼Œè¯´è¿™ä¸ªåœ°å€ä½ å»é—®è´Ÿè´£æ ¸å¿ƒåŒºçš„é’±å¤„é•¿å§ã€‚é—¨å«å¤§çˆ·åˆç»™é’±å¤„é•¿æ‰“è¿‡å»ç”µè¯ï¼Œé’±å¤„é•¿è¯´è¿™ä¸ªåœ°å€æˆ‘ä¹Ÿä¸æŒæ¡å•Šï¼Œä½ å»é—®ä¸€ä¸‹è´Ÿè´£æ™¯å±±ç‰‡åŒºçš„ç§‘å‘˜å°å­™å§ã€‚é—¨å«å¤§çˆ·ä»å°å­™é‚£é‡Œç»ˆäºçŸ¥é“äº†åŒ—æµ·å…¬å›­åœ°å€ï¼Œä»–èµ¶ç´§è®°åˆ°è‡ªå·±çš„å°æœ¬æœ¬ä¸Šï¼Œç„¶åæŠŠç»“æœå‘Šè¯‰äº†å¸‚æ°‘ A å…ˆç”Ÿã€‚æ¥ä¸‹æ¥ä¸€å°æ—¶å†…ï¼Œå¦‚æœè¿˜æœ‰å¸‚æ°‘ B å…ˆç”Ÿå†æ¥é—®åŒ—æµ·å…¬å›­çš„è¯ï¼Œé—¨å«å¤§çˆ·å°±ç›´æ¥ç”¨ç¬”è®°æœ¬ä¸Šè®°è½½çš„ç»“æœå›å¤äº†ã€‚å½“ç„¶ï¼Œå¦‚æœå¸‚æ°‘ C å¥³å£«è¿‡æ¥é—®åˆ«çš„åœ°å€çš„è¯ï¼Œé—¨å«å¤§çˆ·å°±è¦æŠŠå¤„ç† A å…ˆç”Ÿé—®è¯¢çš„æµç¨‹å†èµ°ä¸€éäº†ã€‚ åˆ†çº§æŸ¥è¯¢çš„å®ä¾‹ ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®é™…çš„ä¾‹å­ã€‚å¦‚æœæˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è¾“å…¥https://news.qq.comï¼Œé‚£æµè§ˆå™¨ä¼šä»æ¥æ”¶åˆ°çš„ URL ä¸­æŠ½å–å‡ºåŸŸåå­—æ®µï¼ˆnews.qq.comï¼‰ï¼Œç„¶åå°†å®ƒä¼ ç»™ DNS å®¢æˆ·ç«¯ï¼ˆæ“ä½œç³»ç»Ÿæä¾›ï¼‰æ¥è§£æã€‚ é¦–å…ˆæˆ‘ä»¬è¯´æ˜ä¸€ä¸‹æœ¬æœº DNS é…ç½®ï¼ˆå°±æ˜¯ /etc/resolv.conf æ–‡ä»¶ï¼Œé‡Œé¢æŒ‡å®šäº†æœ¬åœ° DNS æœåŠ¡å™¨çš„åœ°å€ï¼ŒWindows ç³»ç»Ÿå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼‰ï¼š $ cat /etc/resolv.conf nameserver 202.106.0.20 nameserver 202.106.196.115 ç„¶åæˆ‘ä»¬ç”¨ dig è¿™ä¸ªå·¥å…·æŸ¥çœ‹ä¸€ä¸‹ news.qq.com çš„è§£æç»“æœï¼ˆå…¶ä¸­ä¸­æ–‡éƒ¨åˆ†æ˜¯è§£é‡Šè¯´æ˜ï¼‰ï¼š $ dig news.qq.com ; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; news.qq.com è¿™æ˜¯ dig ç¨‹åºçš„ç‰ˆæœ¬å·ä¸è¦æŸ¥è¯¢çš„åŸŸå ;; global options: +cmd ;; Got answer: ä»¥ä¸‹æ˜¯è¦è·å–çš„å†…å®¹ã€‚ ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 47559 ;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 0 è¿™ä¸ªæ˜¯è¿”å›åº”ç­”çš„å¤´éƒ¨ä¿¡æ¯ï¼š 1. opcodeï¼šæ“ä½œç ï¼ŒQUERY ä»£è¡¨æŸ¥è¯¢æ“ä½œï¼› 2. status: çŠ¶æ€ï¼ŒNOERROR ä»£è¡¨æ²¡æœ‰é”™è¯¯; 3. idï¼šç¼–å·ï¼Œåœ¨ DNS åè®®ä¸­é€šè¿‡ç¼–å·åŒ¹é…è¿”å›å’ŒæŸ¥è¯¢ï¼› 4. flags: æ ‡å¿—ï¼Œå«ä¹‰å¦‚ä¸‹: - qrï¼šqueryï¼ŒæŸ¥è¯¢æ ‡å¿—ï¼Œä»£è¡¨æ˜¯æŸ¥è¯¢æ“ä½œ - rdï¼šrecursion desiredï¼Œä»£è¡¨å¸Œæœ›è¿›è¡Œé€’å½’æŸ¥è¯¢æ“ä½œ; - raï¼šrecursive availableï¼Œä»£è¡¨æŸ¥è¯¢çš„æœåŠ¡å™¨æ”¯æŒé€’å½’æŸ¥è¯¢æ“ä½œ; 5. QUERY æŸ¥è¯¢æ•°ï¼Œä¸ä¸‹é¢ QUESTION SECTION çš„è®°å½•æ•°ä¸€ä¸€å¯¹åº”ï¼› 6. ANSWER ç»“æœæ•°ï¼Œä¸ä¸‹é¢çš„ ANSWER SECTION çš„è®°å½•æ•°ä¸€ä¸€å¯¹åº”ï¼› 7. AUTHORITY æƒå¨å›å¤æ•°ï¼Œå¦‚æœæŸ¥è¯¢ç»“æœç”±ç®¡ç†åŸŸåçš„åŸŸåæœåŠ¡å™¨è€Œä¸æ˜¯ç¼“å­˜æœåŠ¡å™¨æä¾›çš„ï¼Œåˆ™ç§°ä¸ºæƒå¨å›å¤ã€‚ 0 è¡¨ç¤ºæ‰€æœ‰ç»“æœéƒ½ä¸æ˜¯æƒå¨å›å¤ï¼› 8. ADDITIONAL é¢å¤–è®°å½•æ•°ï¼› ;; QUESTION SECTION: ;news.qq.com. IN A æŸ¥è¯¢éƒ¨åˆ†,ä»å·¦åˆ°å³éƒ¨åˆ†æ„ä¹‰å¦‚ä¸‹: 1ã€è¦æŸ¥è¯¢çš„åŸŸåï¼› 2ã€è¦æŸ¥è¯¢ä¿¡æ¯çš„ç±»åˆ«ï¼ŒIN ä»£è¡¨ç±»åˆ«ä¸º IP åè®®ï¼Œå³ Internetã€‚ 3ã€æŸ¥è¯¢çš„è®°å½•ç±»å‹ï¼ŒA è®°å½•(Address)ä»£è¡¨è¦æŸ¥è¯¢ IPv4 åœ°å€ã€‚ ;; ANSWER SECTION: news.qq.com. 136 IN CNAME https.qq.com. https.qq.com. 476 IN A 125.39.52.26 å›åº”éƒ¨åˆ†ï¼Œä»å·¦åˆ°å³å„éƒ¨åˆ†æ„ä¹‰ï¼š 1ã€å¯¹åº”çš„åŸŸå 2ã€TTLï¼Œtime to liveï¼Œç¼“å­˜æ—¶é—´ï¼Œå•ä½ç§’ï¼Œä»£è¡¨ç¼“å­˜åŸŸåæœåŠ¡å™¨å¯ä»¥åœ¨ç¼“å­˜ä¸­ä¿å­˜çš„æœŸé™ã€‚ 3ã€æŸ¥è¯¢ä¿¡æ¯çš„ç±»åˆ« 4ã€æŸ¥è¯¢çš„è®°å½•ç±»å‹ï¼ŒCNAME è¡¨ç¤ºåˆ«åè®°å½•ï¼ŒA è®°å½•(Address)ä»£è¡¨ IPv4 åœ°å€ã€‚ 5ã€åŸŸåå¯¹åº”çš„ ip åœ°å€ã€‚ ;; Query time: 56 msec ;; SERVER: 202.106.0.20#53(202.106.0.20) æŸ¥è¯¢ä½¿ç”¨çš„æœåŠ¡å™¨åœ°å€å’Œç«¯å£,å…¶å®å°±æ˜¯æœ¬åœ° DNS åŸŸåæœåŠ¡å™¨ ;; WHEN: Thu Jul 11 15:59:37 CST 2019 ;; MSG SIZE rcvd: 65 æŸ¥è¯¢çš„æ—¶é—´ä¸å›åº”çš„å¤§å°ï¼Œæ”¶åˆ° 65 å­—èŠ‚çš„åº”ç­”æ•°æ®ã€‚ ä»è¿™ä¸ªåº”ç­”å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç»“æœä¸æ˜¯æƒå¨å›å¤ï¼Œåªæ˜¯æœ¬åœ° DNS æœåŠ¡å™¨ä»ç¼“å­˜ä¸­ç»™äº†åº”ç­”ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ dig å‘½ä»¤ä¸­å¢åŠ ä¸€ä¸ªå‚æ•° +traceï¼Œçœ‹çœ‹å®Œæ•´çš„åˆ†çº§æŸ¥è¯¢è¿‡ç¨‹ï¼š $ dig +trace news.qq.com ; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; +trace news.qq.com ;; global options: +cmd . 432944 IN NS g.root-servers.net. . 432944 IN NS k.root-servers.net. . 432944 IN NS b.root-servers.net. . 432944 IN NS h.root-servers.net. . 432944 IN NS i.root-servers.net. . 432944 IN NS f.root-servers.net. . 432944 IN NS d.root-servers.net. . 432944 IN NS e.root-servers.net. . 432944 IN NS j.root-servers.net. . 432944 IN NS l.root-servers.net. . 432944 IN NS c.root-servers.net. . 432944 IN NS m.root-servers.net. . 432944 IN NS a.root-servers.net. ;; Received 228 bytes from 202.106.0.20#53(202.106.0.20) in 45 ms è¿™äº›å°±æ˜¯ç¥ç§˜çš„æ ¹åŸŸåæœåŠ¡å™¨ï¼Œç”±æœ¬åœ° DNS æœåŠ¡å™¨è¿”å›äº†æ‰€æœ‰æ ¹åŸŸåæœåŠ¡å™¨åœ°å€ã€‚ com. 172800 IN NS g.gtld-servers.net. com. 172800 IN NS a.gtld-servers.net. com. 172800 IN NS b.gtld-servers.net. com. 172800 IN NS m.gtld-servers.net. com. 172800 IN NS d.gtld-servers.net. com. 172800 IN NS c.gtld-servers.net. com. 172800 IN NS j.gtld-servers.net. com. 172800 IN NS h.gtld-servers.net. com. 172800 IN NS f.gtld-servers.net. com. 172800 IN NS l.gtld-servers.net. com. 172800 IN NS e.gtld-servers.net. com. 172800 IN NS k.gtld-servers.net. com. 172800 IN NS i.gtld-servers.net. ;; Received 1171 bytes from 192.36.148.17#53(i.root-servers.net) in 57 ms è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯ .com åŸŸåçš„ 13 æ¡ NS è®°å½•ï¼Œæœ¬åœ° DNS æœåŠ¡å™¨å‘è¿™äº›é¡¶çº§åŸŸåæœåŠ¡å™¨å‘å‡ºæŸ¥è¯¢è¯·æ±‚ï¼Œ è¯¢é—® qq.com çš„ NS è®°å½•ã€‚ qq.com. 172800 IN NS ns1.qq.com. qq.com. 172800 IN NS ns2.qq.com. qq.com. 172800 IN NS ns3.qq.com. qq.com. 172800 IN NS ns4.qq.com. ;; Received 805 bytes from 192.48.79.30#53(j.gtld-servers.net) in 331 ms è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯ qq.com çš„ 4 æ¡ NS è®°å½•ï¼Œç”± j.gtld-servers.net è¿™å°æœåŠ¡å™¨æœ€å…ˆè¿”å›ã€‚ ç„¶åæœ¬åœ° DNS æœåŠ¡å™¨å‘è¿™å››å°æœåŠ¡å™¨æŸ¥è¯¢ä¸‹ä¸€çº§åŸŸå news.qq.com çš„ NS è®°å½•ã€‚ news.qq.com. 86400 IN NS ns-cnc1.qq.com. news.qq.com. 86400 IN NS ns-cnc2.qq.com. ;; Received 180 bytes from 58.144.154.100#53(ns4.qq.com) in 37 ms è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯ news.qq.com çš„ NS è®°å½•ï¼Œå®ƒä»¬æ˜¯ç”±ä¸Šé¢çš„ ns4.qq.com åŸŸåæœåŠ¡å™¨è¿”å›çš„ã€‚ ç„¶åæœ¬åœ° DNS æœåŠ¡å™¨å‘è¿™ä¸¤å°æœºå™¨æŸ¥è¯¢ news.qq.com çš„ä¸»æœºåã€‚ news.qq.com. 600 IN CNAME https.qq.com. https.qq.com. 600 IN A 125.39.52.26 ;; Received 76 bytes from 223.167.83.104#53(ns-cnc2.qq.com) in 29 ms è¿™æ˜¯ä¸Šé¢çš„ ns-cnc2.qq.com è¿”å›çš„æœ€ç»ˆæŸ¥è¯¢ç»“æœï¼š news.qq.com æ˜¯ https.qq.com çš„åˆ«åï¼Œè€Œ https.qq.com çš„ A è®°å½•åœ°å€æ˜¯ 125.39.52.26 å®é™…çš„æµç¨‹é‡Œé¢ï¼Œæœ¬åœ° DNS æœåŠ¡å™¨ç›¸å½“äºé—¨å«å¤§çˆ·ï¼Œæ ¹åŸŸåæœåŠ¡å™¨ç›¸å½“äºå±€é•¿åŒå¿—ï¼Œå…¶ä½™ä»¥æ­¤ç±»æ¨ã€‚å®¢æˆ·ç«¯ä¸æœ¬åœ° DNS æœåŠ¡å™¨ä¹‹é—´çš„æŸ¥è¯¢å«é€’å½’æŸ¥è¯¢ï¼Œæœ¬åœ° DNS æœåŠ¡å™¨ä¸å…¶ä»–åŸŸåæœåŠ¡å™¨ä¹‹é—´çš„æŸ¥è¯¢å°±å«è¿­ä»£æŸ¥è¯¢ã€‚ åŸŸåè®°å½•çš„ç±»å‹ åŸŸåæœåŠ¡å™¨ä¹‹æ‰€ä»¥èƒ½çŸ¥é“åŸŸåä¸ IP åœ°å€çš„æ˜ å°„ä¿¡æ¯ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬åœ¨åŸŸåæœåŠ¡å•†é‚£é‡Œæäº¤äº†åŸŸåè®°å½•ã€‚è´­ä¹°äº†ä¸€ä¸ªåŸŸåä¹‹åï¼Œæˆ‘ä»¬éœ€è¦åœ¨åŸŸåæœåŠ¡å•†é‚£é‡Œè®¾ç½®åŸŸåè§£æçš„è®°å½•ï¼ŒåŸŸåæœåŠ¡å•†æŠŠè¿™äº›è®°å½•æ¨é€åˆ°æƒå¨åŸŸåæœåŠ¡å™¨ï¼Œè¿™æ ·æˆ‘ä»¬çš„åŸŸåæ‰èƒ½æ­£å¼ç”Ÿæ•ˆã€‚ åœ¨è®¾ç½®åŸŸåè®°å½•çš„æ—¶å€™ï¼Œä¼šé‡åˆ°ã€ŒA è®°å½•ã€ã€ã€ŒCNAMEã€ ç­‰ä¸åŒç±»å‹ï¼Œè¿™æ­£æ˜¯å‰é¢åšåŸŸåè§£æçš„æ—¶å€™æˆ‘ä»¬ç¢°åˆ°çš„ç»“æœã€‚è¿™äº›ç±»å‹æ˜¯ä»€ä¹ˆæ„æ€ï¼Œå®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å¸¸è§çš„è®°å½•ç±»å‹ã€‚ A è®°å½•ã€‚A (Address) è®°å½•ç”¨æ¥ç›´æ¥æŒ‡å®šä¸»æœºåï¼ˆæˆ–åŸŸåï¼‰å¯¹åº”çš„ IP åœ°å€ã€‚ä¸»æœºåå°±æ˜¯åŸŸåå‰ç¼€ï¼Œå¸¸è§æœ‰å¦‚ä¸‹å‡ ç§ï¼š wwwï¼šè§£æåçš„åŸŸåä¸º www.yourdomain.comï¼Œä¸€èˆ¬ç”¨äºç½‘ç«™åœ°å€ã€‚ @ï¼šç›´æ¥è§£æä¸»åŸŸåã€‚ *ï¼šæ³›è§£æï¼ŒæŒ‡å°† *.yourdomain.com è§£æåˆ°åŒä¸€ IPã€‚ CNAME è®°å½•ã€‚CNAME çš„å…¨ç§°æ˜¯ Canonical Nameï¼Œé€šå¸¸ç§°åˆ«åè®°å½•ã€‚å¦‚æœéœ€è¦å°†åŸŸåæŒ‡å‘å¦ä¸€ä¸ªåŸŸåï¼Œå†ç”±å¦ä¸€ä¸ªåŸŸåæä¾› IP åœ°å€ï¼Œå°±éœ€è¦æ·»åŠ  CNAME è®°å½•ã€‚ MX è®°å½•ã€‚é‚®ä»¶äº¤æ¢è®°å½•ï¼Œç”¨äºå°†ä»¥è¯¥åŸŸåä¸ºç»“å°¾çš„ç”µå­é‚®ä»¶æŒ‡å‘å¯¹åº”çš„é‚®ä»¶æœåŠ¡å™¨ä»¥è¿›è¡Œå¤„ç†ã€‚ NS è®°å½•ã€‚åŸŸåæœåŠ¡å™¨è®°å½•ï¼Œå¦‚æœéœ€è¦æŠŠå­åŸŸåäº¤ç»™å…¶ä»– DNS æœåŠ¡å™¨è§£æï¼Œå°±éœ€è¦æ·»åŠ  NS è®°å½•ã€‚ AAAA è®°å½•ã€‚ç”¨æ¥æŒ‡å®šä¸»æœºåï¼ˆæˆ–åŸŸåï¼‰å¯¹åº”çš„ IPv6 åœ°å€ï¼Œä¸å¸¸ç”¨ã€‚ TXT è®°å½•ã€‚å¯ä»¥å¡«å†™ä»»ä½•ä¸œè¥¿ï¼Œé•¿åº¦é™åˆ¶ 255ã€‚ç»å¤§å¤šæ•°çš„ TXT è®°å½•æ˜¯ç”¨æ¥åš SPF è®°å½•ï¼ˆååƒåœ¾é‚®ä»¶ï¼‰ï¼ŒMX è®°å½•çš„ä½œç”¨æ˜¯ç»™å¯„ä¿¡è€…æŒ‡æ˜æŸä¸ªåŸŸåçš„é‚®ä»¶æœåŠ¡å™¨æœ‰å“ªäº›ã€‚SPF çš„ä½œç”¨è·Ÿ MX ç›¸åï¼Œå®ƒå‘æ”¶ä¿¡è€…è¡¨æ˜ï¼Œå“ªäº›é‚®ä»¶æœåŠ¡å™¨æ˜¯ç»è¿‡æŸä¸ªåŸŸåè®¤å¯ä¼šå‘é€é‚®ä»¶çš„ã€‚ æ˜¾æ€§ URLã€‚ä»ä¸€ä¸ªåœ°å€ 301 é‡å®šå‘ï¼ˆä¹Ÿå«ã€Œæ°¸ä¹…æ€§è½¬ç§»ã€ï¼‰åˆ°å¦ä¸€ä¸ªåœ°å€çš„æ—¶å€™ï¼Œå°±éœ€è¦æ·»åŠ æ˜¾æ€§ URL è®°å½•ã€‚ éšæ€§ URLã€‚ä»ä¸€ä¸ªåœ°å€ 302 è·³è½¬ï¼ˆä¹Ÿå«ã€Œä¸´æ—¶è·³è½¬ã€ï¼‰åˆ°å¦ä¸€ä¸ªåœ°å€ï¼Œéœ€è¦æ·»åŠ éšæ€§ URL è®°å½•ã€‚å®ƒç±»ä¼¼äºæ˜¾æ€§ URLï¼ŒåŒºåˆ«åœ¨äºéšæ€§ URL ä¸ä¼šæ”¹å˜åœ°å€æ ä¸­çš„åŸŸåã€‚ åœ¨å¡«å†™å„ç§è®°å½•çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜ä¼šç¢°åˆ°ä¸€ä¸ªç‰¹æ®Šçš„è®¾ç½®é¡¹â€”â€”TTLï¼Œç”Ÿå­˜æ—¶é—´ï¼ˆTime To Liveï¼‰ã€‚ TTLè¡¨ç¤ºè§£æè®°å½•åœ¨ DNS æœåŠ¡å™¨ä¸­çš„ç¼“å­˜æ—¶é—´ï¼Œæ—¶é—´é•¿åº¦å•ä½æ˜¯ç§’ï¼Œä¸€èˆ¬ä¸º 3600 ç§’ã€‚æ¯”å¦‚ï¼šåœ¨è®¿é—®news.qq.comæ—¶ï¼Œå¦‚æœåœ¨ DNS æœåŠ¡å™¨çš„ç¼“å­˜ä¸­æ²¡æœ‰è¯¥è®°å½•ï¼Œå°±ä¼šå‘æŸä¸ª NS æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œè·å¾—è¯¥è®°å½•åï¼Œè¯¥è®°å½•ä¼šåœ¨ DNS æœåŠ¡å™¨ä¸Šä¿å­˜TTLçš„æ—¶é—´é•¿åº¦ï¼Œåœ¨TTLæœ‰æ•ˆæœŸå†…è®¿é—®news.qq.comï¼ŒDNS æœåŠ¡å™¨ä¼šç›´æ¥ç¼“å­˜ä¸­è¿”å›åˆšæ‰çš„è®°å½•ã€‚ DNS æ™ºèƒ½è§£æ DNS ä¸»è¦çš„å·¥ä½œå°±æ˜¯å®ŒæˆåŸŸååˆ° IP çš„æ˜ å°„ï¼Œä½†æ˜¯ä¹Ÿä¸æ˜¯ç®€å•åˆ°æŸ¥æŸ¥å­—å…¸å°±å¯ä»¥æå®šçš„ç¨‹åº¦ã€‚åœ¨è®¾ç½® DNS è§£æçš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€äº›é¢å¤–çš„éœ€æ±‚ï¼Œä¾‹å¦‚ï¼š å°†ä¸€ä¸ªåŸŸåè§£æåˆ°å¤šä¸ª IP ä¾‹å¦‚æˆ‘ä»¬ä¸€ä¸ªç½‘ç«™æœ‰å¤šå°å‰ç«¯æœºï¼Œå¸Œæœ›ç”¨æˆ·è®¿é—®çš„æ—¶å€™ï¼Œå¯ä»¥éšæœºåˆ†æ•£åˆ°è¿™äº›æœºå™¨ä¸Šï¼Œä»¥å¢åŠ ç½‘ç«™æ‰¿è½½èƒ½åŠ›ã€‚æœ‰ä¸€ç§è§£å†³çš„åŠæ³•å°±æ˜¯å¯¹åŒä¸€ä¸ªåŸŸåè®¾ç½®å¤šæ¡ A è®°å½•ï¼Œåˆ†åˆ«æŒ‡å®šåˆ°ä¸åŒçš„ IP ä¸Šã€‚ æ ¹æ®ç‰¹å¾å·®å¼‚å°†ä¸åŒè¯·æ±‚è§£æåˆ°ä¸åŒ IPï¼ˆæ™ºèƒ½è§£æï¼‰ å›½å†…äº’è”ç½‘çš„æ¶æ„å…¶å®è¿œæ¯”æˆ‘ä»¬æƒ³è±¡çš„å¤æ‚ï¼ŒåŸºæœ¬ä¸Šè¿˜æ˜¯æ ¹æ®è¿è¥å•†çš„ä¸åŒåˆ‡å‰²æˆå¤šä¸ªå¹³è¡Œç½‘ç»œï¼Œåªæœ‰åœ¨å›ºå®šçš„å‡ ä¸ªèŠ‚ç‚¹è¿™äº›å¹³è¡Œç½‘ç»œæ‰ä¼šæœ‰äº¤å‰ã€‚ä¾‹å¦‚ç”µä¿¡å’Œè”é€šä¹‹é—´çš„äº’è”æ˜¯é€šè¿‡ã€Œå›½å®¶çº§äº’è”ç½‘éª¨å¹²ç›´è”ç‚¹ã€æ¥å…¥çš„ï¼Œç›®å‰æˆ‘ä»¬ä¸€å…±å»ºè®¾äº†ä¸‰æ‰¹å›½å®¶çº§äº’è”ç½‘éª¨å¹²ç›´è”ç‚¹ï¼š ç¬¬ä¸€æ‰¹ 2001 å¹´æŠ•å…¥ä½¿ç”¨ï¼šåŒ—äº¬ï¼Œä¸Šæµ·ï¼Œå¹¿å· ç¬¬äºŒæ‰¹ 2014 å¹´æŠ•å…¥ä½¿ç”¨ï¼šæˆéƒ½ï¼Œéƒ‘å·ï¼Œæ­¦æ±‰ï¼Œè¥¿å®‰ï¼Œæ²ˆé˜³ï¼Œå—äº¬ï¼Œé‡åº† ç¬¬ä¸‰æ‰¹ 2017 å¹´æŠ•å…¥ä½¿ç”¨ï¼šæ­å·ï¼Œè´µé˜³ / è´µå®‰ï¼Œç¦å· æ•™è‚²ç½‘ç›®å‰è¿˜åªèƒ½é€šè¿‡åŒ—ä¸Šå¹¿ä¸‰ä¸ªç‚¹è¿›è¡Œè¿æ¥ã€‚è¿™æ ·çš„ç½‘ç»œæ‹“æ‰‘ç»“æ„ï¼Œç»™ DNS è§£æå¸¦æ¥äº†æ–°çš„æŒ‘æˆ˜ã€‚ ä¼ ç»Ÿ DNS è§£æï¼Œä¸åˆ¤æ–­è®¿é—®è€…æ¥æºï¼Œä¼šéšæœºé€‰æ‹©å…¶ä¸­ä¸€ä¸ª IP åœ°å€è¿”å›ç»™è®¿é—®è€…ã€‚å¦‚æœè®©ç”µä¿¡ç”¨æˆ·ä½¿ç”¨äº†è”é€š IP æ¥è®¿é—®ç½‘ç«™ï¼Œé‚£ç»“æœè‡ªç„¶ä¸å¦‚ä½¿ç”¨ç”µä¿¡ IP è®¿é—®æ¥çš„å¿«æ·ã€‚è€Œæ™ºèƒ½ DNS è§£æï¼Œä¼šåˆ¤æ–­è®¿é—®è€…çš„æ¥æºç‰¹å¾ï¼Œä¸ºä¸åŒçš„è®¿é—®è€…è¿”å›ä¸åŒçš„ IP åœ°å€ï¼Œèƒ½å¤Ÿå‡å°‘è§£ææ—¶å»¶ï¼Œå¹¶æå‡ç½‘ç»œè®¿é—®é€Ÿåº¦ã€‚ä¾‹å¦‚ï¼Œå›½å†…æŸè‘—å DNS æœåŠ¡å•†ä¸å…‰å¯ä»¥åŒºåˆ†ç½‘ç»œè¿è¥å•†ï¼Œè¿˜å¯ä»¥æ ¹æ®è®¿é—®è€…çš„åœ°ç†ä½ç½®æ¥è®¾ç½®ä¸åŒçš„è§£æçº¿è·¯ï¼Œè€Œä¸”ç”šè‡³è¿˜å¯ä»¥ä¸ºæœç´¢å¼•æ“è®¾ç½®ç‰¹å®šçš„è§£æåœ°å€ã€‚ CNAME å’Œ A è®°å½•åŒºåˆ« æŒ‰ç…§å‰é¢çš„è§£é‡Šï¼ŒA è®°å½•å°±æ˜¯æŠŠä¸€ä¸ªåŸŸåè§£æåˆ°ä¸€ä¸ª IP åœ°å€ï¼Œè€Œ CNAME è®°å½•å°±æ˜¯æŠŠä¸€ä¸ªåŸŸåè§£æåˆ°å¦å¤–ä¸€ä¸ªåŸŸåï¼Œå…¶åŠŸèƒ½å·®ä¸å¤šã€‚ä½†æ˜¯ CNAME ç›¸å½“äºå°†åŸŸåå’Œ IP åœ°å€ä¹‹é—´åŠ äº†ä¸€ä¸ªä¸­é—´å±‚ï¼Œå¯ä»¥å¸¦æ¥å¾ˆå¤§çš„çµæ´»æ€§ï¼Œç‰¹åˆ«æ˜¯å½“ä½ è¦ä½¿ç”¨ä½†æ˜¯å¹¶ä¸æ‹¥æœ‰é‚£äº›åŸŸåçš„æ—¶å€™ã€‚ ä¾‹å¦‚æˆ‘ä»¬ä½¿ç”¨ CDN æœåŠ¡ï¼ŒæœåŠ¡å•†æä¾›ç»™æˆ‘ä»¬çš„æ˜¯ä¸€ä¸ª CNAME åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè‡ªå·±çš„åŸŸåç»‘å®šåˆ°è¿™ä¸€ä¸ªåœ°å€ä¸Šï¼Œè¿™æ ·ä¸‡ä¸€ä»¥åæœåŠ¡å•†çš„ IP åœ°å€æ›´æ¢äº†ï¼Œæˆ‘ä»¬è‡ªå·±çš„åŸŸåè§£ææ˜¯ä¸éœ€è¦åšä»»ä½•å˜æ›´çš„ï¼Œåªè¦æœåŠ¡å•†è°ƒæ•´ä¸€ä¸‹ CNAME åœ°å€çš„è§£æç»“æœï¼Œæ‰€æœ‰ä½¿ç”¨è€…éƒ½å¯ä»¥æ— æ„ŸçŸ¥çš„åˆ‡æ¢ã€‚ ä» 6 æœˆåº•å¼€å§‹ï¼ŒLeanCloud æ–°æ¨å‡ºäº†ç»‘å®šè‡ªå®šä¹‰åŸŸåçš„åŠŸèƒ½ï¼Œå…¨é¢æ”¯æŒå¼€å‘è€…è®¾ç½®è‡ªå·±çš„ APIã€æ–‡ä»¶ã€äº‘å¼•æ“åŸŸåï¼Œä¹Ÿæ­£æ˜¯ä¾èµ–äº CNAME è®°å½•çš„è¿™ä¸€ç‰¹ç‚¹æ¥å®ç°çš„ã€‚ DNS æ±¡æŸ“ä¸å®‰å…¨æŒ‘æˆ˜ DNS æ˜¯æœ€æ—©å•†ç”¨çš„å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œè™½ç„¶ç°åœ¨çœ‹èµ·æ¥å·²ç»å¾ˆå®Œå¤‡äº†ï¼Œä½†æ˜¯å®é™…ä½¿ç”¨çš„æ—¶å€™ï¼Œç‰¹åˆ«æ˜¯å›½å†…å¤æ‚çš„ç½‘ç»œç¯å¢ƒï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¼šé‡åˆ°å¾ˆå¤šé—®é¢˜ã€‚ ä½œä¸ºäº’è”ç½‘æ—©æœŸäº§ç‰©ï¼ŒDNS ä½¿ç”¨æ— è¿æ¥çš„ UDP åè®®è™½ç„¶é™ä½äº†å¼€é”€ä¹Ÿä¿è¯äº†é«˜æ•ˆçš„é€šä¿¡ï¼Œä½†æ˜¯æ²¡æœ‰å¤ªè€ƒè™‘å®‰å…¨é—®é¢˜ã€‚ç”±äºå®ƒä½¿ç”¨ç›®çš„ç«¯å£ä¸º 53 çš„ UDP æ˜æ–‡è¿›è¡Œé€šä¿¡ï¼ŒDNS è§£æå™¨è¯†åˆ«æ˜¯è‡ªå·±å‘å‡ºçš„æ•°æ®åŒ…çš„å”¯ä¸€æ ‡å‡†å°±æ˜¯éšæœºçš„æºç«¯å£å·ï¼Œå¦‚æœç«¯å£å·åŒ¹é…åˆ™è®¤ä¸ºæ˜¯æ­£ç¡®å›å¤ï¼Œè€Œä¸ä¼šéªŒè¯æ¥æºã€‚æ‰€ä»¥ä¹Ÿå¸¦æ¥äº†è¯¸å¦‚ DNS æ¬ºéª—ã€DNS Cache æ±¡æŸ“ã€DNS æ”¾å¤§æ”»å‡»ç­‰é—®é¢˜ï¼ŒåŒæ—¶ç»™ä¸€äº›åŒºåŸŸè¿è¥å•†å¸¦æ¥äº†ã€Œå•†æœºã€ã€‚ ä¸ºæ­¤ä¸šç•Œæå‡ºäº† DNSSecï¼ˆDomain Name System Security Extensionsï¼Œä¹Ÿå«ã€ŒDNS å®‰å…¨æ‰©å±•ã€ï¼‰æœºåˆ¶ï¼Œä½¿ç”¨å¯†ç å­¦æ–¹æ³•ï¼Œè®©å®¢æˆ·ç«¯å¯¹åŸŸåæ¥æºèº«ä»½è¿›è¡ŒéªŒè¯ï¼Œå¹¶ä¸”æ£€æŸ¥æ¥è‡ª DNS åŸŸåæœåŠ¡å™¨åº”ç­”è®°å½•çš„å®Œæ•´æ€§ï¼Œä»¥åŠéªŒè¯æ˜¯å¦åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹è¿‡ï¼Œç­‰ç­‰ä¸€ç³»åˆ—æªæ–½æ¥ä¿è¯æ•°æ®é€šä¿¡çš„å®‰å…¨æ€§ã€‚å¯¹è¿™æ–¹é¢æ„Ÿå…´è¶£çš„è¯»è€…ï¼Œå¯ä»¥å…³æ³¨æˆ‘ä»¬çš„åç»­æ–‡ç« ã€‚ ","tags":[{"index":-1,"name":"è½¬è½½","slug":"JDrWa3FBq","used":true,"link":"https://xuyj1111.github.io/JDrWa3FBq/"},{"index":-1,"name":"æ‚è®°","slug":"CseDYEWrD","used":true,"link":"https://xuyj1111.github.io/CseDYEWrD/"}],"title":"ã€è½¬è½½ã€‘åŸŸåèƒŒåé‚£äº›äº‹","feature":"","link":"https://xuyj1111.github.io/a9PYxb2n7/","stats":{"text":"20 min read","time":1160000,"words":5091,"minutes":20},"date":"2022-04-29 11:29:41","dateFormat":"2022-04-29"},{"content":" åŸç ã€åç ã€è¡¥ç ã€å·¦ç§»ã€å³ç§»ã€&amp;ã€| ã€&lt;&lt;ã€‘é€šè¿‡ä½è¿ç®—å®ç°å–ä½™æ•ˆæœ ä¸ºå˜é‡å®šä¸€ä¸ªäºŒè¿›åˆ¶é•¿åº¦ï¼Œä¾‹å¦‚å®šäºŒè¿›åˆ¶é•¿åº¦è€Œ 4 ä½ï¼Œåˆ™å˜é‡æœ€å¤§å€¼ï¼š ~(-1L &lt;&lt; 4) = 15 ä½†æ˜¯åœ¨ä»£ç ä¸­å¹¶æ²¡æœ‰ä¸€ä¸ªæ•°å€¼ç±»å‹èƒ½æŒ‡å®šä¸€ä¸ªå¯å˜ä½æ•°ï¼Œä»…æœ‰ int(32ä½)ã€long(64ä½)ç­‰ï¼Œå¦‚æœæƒ³è¦æŒ‡å®šä½æ•°ï¼ˆåŠæŒ‡å®šæœ€å¤§å€¼ï¼‰ï¼Œåˆ™éœ€è¦å®ç°è¶…è¿‡æœ€å¤§å€¼åè‡ªåŠ¨ä» 0 å¼€å§‹ï¼Œä¾‹å¦‚ï¼š long number = 15; number = (number + 1) &amp; getMaxNum(); //number = 0 getMaxNum() = ~(-1L &lt;&lt; 4) p.s. ç›¸å¯¹äºå–ä½™(%)ï¼Œä½è¿ç®—é€Ÿåº¦æ›´å¿« ã€&lt;&lt;ã€‘æ‹¼æ¥æˆä¸€ä¸ªLong ç¬¦å·ä½ ç©ºç™½ä½ appId deltaSeconds workId sequence 1bit 11bits 5bits 30bits 4bits 13bits appId &lt;&lt; (13 + 4 + 30) | deltaSeconds &lt;&lt; (13 + 4) | workerId &lt;&lt; 13 | sequence; æŒç»­æ›´æ–°ã€‚ã€‚ã€‚ ","tags":[{"index":-1,"name":"æŒç»­æ›´æ–°","slug":"tMXGs2hmt","used":true,"link":"https://xuyj1111.github.io/tMXGs2hmt/"},{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"æ‚è®°","slug":"CseDYEWrD","used":true,"link":"https://xuyj1111.github.io/CseDYEWrD/"}],"title":"ä½¿ç”¨äºŒè¿›åˆ¶ç¼–ç¨‹å¿ƒå¾—","feature":"","link":"https://xuyj1111.github.io/dFvS6kPBm/","stats":{"text":"1 min read","time":49000,"words":196,"minutes":1},"date":"2022-04-28 16:35:23","dateFormat":"2022-04-28"},{"content":" åŸæ–‡åœ°å€ www.modb.proï¼Œby èŒ¶å¶è›‹æ—¥å¸¸ æ ‡è®°ä¸€ä¸ªè°ƒç”¨ï¼Œä¸€ç¬”æ—¥å¿—ï¼Œä¸€ç¬”äº¤æ˜“ï¼Œç»å¸¸ä¼šéœ€è¦ç”Ÿæˆä¸€ä¸ªå”¯ä¸€ IDï¼Œè€Œç”Ÿæˆå”¯ä¸€ ID çš„å½¢å¼æœ‰å¾ˆå¤šï¼Œå¸¸å¸¸ä½¿ç”¨çš„ï¼Œä¾¿æ˜¯ UUID (Universally Unique Identifier)ã€‚UUID ååˆ†æ–¹ä¾¿ï¼Œæ— éœ€ç½‘ç»œï¼Œæ•ˆç‡ä¹Ÿé«˜ï¼ŒJava ç­‰è¯­è¨€éƒ½æä¾›äº†ç›¸å…³æ¥å£ï¼Œå¾ˆå®¹æ˜“å°±èƒ½å¾—åˆ°ä¸€ä¸ªå…¨çƒå”¯ä¸€çš„ IDã€‚ 2a7b067b-ea89-4bb5-9aa6-51596d4d53c0 UUID çš„ç”Ÿæˆè§„åˆ™é‡ŒåŒ…å«äº†ç¡¬ä»¶æ ‡è¯†ã€æ—¶é—´æˆ³ã€è®¡æ•°å™¨ç­‰ä¿¡æ¯ã€‚ä½†å´æœ‰ä¸ªæ¯”è¾ƒä¸çˆ½çš„ç‚¹ï¼Œå°±æ˜¯ UUID çš„é•¿åº¦ï¼Œå³ä½¿ç”¨ 16 è¿›åˆ¶è¡¨ç¤ºï¼Œä¾ç„¶æœ‰ 32 ä½ä¹‹é•¿ï¼Œè¿™å¢åŠ äº†ä¼ è¾“ä»¥åŠå­˜å‚¨çš„æˆæœ¬ã€‚ è‡ªå¢åºåˆ—æˆ–è®¸æ˜¯æœ€ç›´æ¥çš„ä¸€ç§å½¢å¼ï¼Œè®¾è®¡ä¸€ä¸ªè®¡æ•°å™¨ï¼Œæ¯æ¬¡è·å–ä¾¿è‡ªå¢ï¼Œè¿™æ ·å¯ä»¥ä¿è¯åºå·å”¯ä¸€ï¼Œä¸”é€»è¾‘ç®€å•ï¼Œæ•ˆç‡é«˜ã€‚è¿™åœ¨å•æœºå™¨ä¸‹ååˆ†æ–¹ä¾¿ï¼Œä½†è€ƒè™‘åˆ°åˆ†å¸ƒå¼åœºæ™¯ï¼Œè‡ªå¢åºåˆ—è®¡æ•°å™¨çš„ä½ç½®ä¾¿ä¸é‚£ä¹ˆç®€å•ã€‚å€˜è‹¥å„ä¸ªæœºå™¨å„æ”¾ç½®ä¸€ä¸ªï¼Œåˆ™å¯èƒ½äº§ç”Ÿç›¸åŒçš„ IDï¼Œè€Œå€˜è‹¥å°†è‡ªå¢å€¼å­˜å‚¨åœ¨æ•°æ®åº“ï¼ŒZookeeper æˆ–è€… Redis ä¸Šï¼Œåˆ™å¢åŠ äº†ç½‘ç»œå¼€é”€ã€‚è‹¥æ˜¯å‡ºç°ä¸åˆç†çš„é”äº‰ç”¨ç­‰æƒ…å†µï¼Œé‚£è·å–ä¸€ä¸ªåºå·èŠ±ä¸Šåå‡ æ¯«ç§’ï¼Œä¾¿ä¸é‚£ä¹ˆå¥½æ¥å—ã€‚ è€ƒè™‘å°†æ—¶é—´æˆ³ä½œä¸ºå”¯ä¸€ IDã€‚æ¯”å¦‚ Java ä¸­ï¼Œå¯ä»¥å– System.currentTimeMillis()ï¼Œå³ 1970-1-1 æ—¥ 0 ç‚¹åˆ°ç°åœ¨çš„æ¯«ç§’å€¼ï¼Œä»¥å½“å‰çš„æ—¶é—´æ¥è®¡ç®—ï¼Œå¤§æ¦‚å¾—åˆ°ä¸€ä¸ªé€’å¢çš„ 13 ä½çš„åè¿›åˆ¶æ•°å­—ã€‚ä½†è¿™æ˜¯ä¸€ä¸ªä¸æ€ä¹ˆæ˜æ™ºçš„é€‰æ‹©ã€‚å‡è‹¥ CPU æ•ˆç‡é«˜ï¼Œåœ¨åŒä¸€æ¯«ç§’å†…åºå·ç”Ÿæˆè¢«è°ƒç”¨äº†å¤šæ¬¡ï¼Œåˆ™ä¼šè·å¾—ç›¸åŒçš„ IDã€‚é‚£ä¹ˆè€ƒè™‘åœ¨æ—¶é—´æˆ³çš„åŸºç¡€ä¸Šï¼Œå¢åŠ ä¸€ä¸ª N ä½çš„è‡ªå¢åºåˆ—ï¼Œè®°å½•æ¯ä¸€æ¯«ç§’ç”Ÿæˆçš„ ID æ•°å‘¢ï¼Œé‚£åˆå›åˆ°äº†è‡ªå¢åºåˆ—å­˜æ”¾ä½ç½®çš„é—®é¢˜ã€‚ è€Œå³ä½¿è‡ªå¢åºåˆ—çš„é—®é¢˜è§£å†³äº†ï¼Œåˆæ€ä¹ˆä¿è¯æ—¶é—´æˆ³æ˜¯ä¸€å¾€æ— å‰çš„å‘¢ï¼Ÿå¦‚æœä¿è¯é€‰æ‹©æ˜¯ 0 æ—¶ 0 åˆ† 0 ç§’ï¼Œä¸‹ä¸€ç¬é—´ä¸ä¼šå˜æˆ 23 æ—¶ 59 åˆ† 59 ç§’å‘¢ï¼Ÿ äº‹å®ä¸Šæ—¶é—´å›æ‹¨æ˜¯å¯èƒ½å‘ç”Ÿçš„ã€‚é™¤å´ä¸€äº›å¼‚å¸¸åœºæ™¯ï¼Œä¸€å¤©çš„æ—¶é—´å¹¶ä¸æ˜¯é‚£ä¹ˆå‡†ç¡®çš„ 24X60x60=86400 ç§’ï¼Œåœ°çƒæœ‰æ—¶å€™è½¬å¾—å¿«ï¼Œæœ‰æ—¶å€™è½¬å¾—æ…¢ã€‚è€Œç”µè„‘çš„æ—¶é’Ÿï¼ˆä¹Ÿè®¸æ˜¯æ™¶æŒ¯å§ï¼‰å´æ˜¯ç›¸å¯¹æ¯”è¾ƒç¨³å®šçš„ã€‚è¿™å°±å¯¼è‡´äº†æ¯éš”ä¸€æ®µæ—¶é—´å°±ä¼šå‡ºç°é—°ç§’ã€‚è¿™å¯¹æ—¥å¸¸ç”Ÿæ´»å¯èƒ½æ²¡ä»€ä¹ˆå½±å“ï¼Œä½†è¡¨ç°åœ¨è®¡ç®—æœºä¸Šï¼Œé‚£å°±æ˜¯æ—¶é—´å›æº¯äº†ã€‚é‚£è¿™ç§æƒ…å†µä¸‹ï¼ŒæŒ‰æˆ‘ä»¬çš„ç®—æ³•ï¼ŒID ä¸å°±é‡å¤ç”Ÿæˆäº†ä¹ˆï¼Ÿ é‚£ä¹ˆï¼Œå€˜è‹¥æ˜¯åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬è¦ç”Ÿæˆä¸€ä¸ªå”¯ä¸€ IDï¼Œé¦–å…ˆæˆ‘ä»¬ä¸å¸Œæœ›ç”Ÿæˆä¸€ä¸ª ID è€—è´¹çš„èµ„æºå¤ªå¤šï¼Œè‡³å°‘ä¸è¦æœ‰ä»€ä¹ˆç½‘ç»œå¼€é”€ã€‚é‚£å¿…ç„¶æˆ‘ä»¬éœ€è¦åœ¨ ID çš„ç”Ÿæˆè§„åˆ™é‡Œï¼ŒåŠ å…¥æœºå™¨çš„ç¡¬ä»¶æ ‡è¯†ã€‚ åœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œä½¿ç”¨æ—¶é—´æˆ³åŠ è‡ªå¢åºå·æ˜¯ä¸€ä¸ªæ¯”è¾ƒå®¹æ˜“æƒ³åˆ°çš„å½¢å¼ã€‚ä½†æ—¶é—´å›æ‹¨çš„é—®é¢˜ï¼Œå¯¹ä¸€äº›ä¸šåŠ¡ç³»ç»Ÿä¸æ˜¯é‚£ä¹ˆå®¹æ˜“æ¥å—ã€‚ è€ƒè™‘è§£å†³æ—¶é—´å›æ‹¨çš„é—®é¢˜ï¼Œä¸ºäº†çŸ¥é“å½“å‰æ—¶é—´è¢«å›æ‹¨äº†ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ ‡å¿—ä½ï¼Œè®°å½•ä¸Šä¸€æ¬¡ç”Ÿæˆ ID çš„æ—¶é—´ï¼Œæ¯æ¬¡ç”Ÿæˆ ID çš„æ—¶å€™ï¼Œéƒ½è·Ÿè¿™ä¸ªæ—¶é—´æˆ³è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå½“å‰æ—¶é—´æˆ³åœ¨è¿™ä¹‹å‰ï¼Œåˆ™è¡¨ç¤ºå‘ç”Ÿäº†æ—¶é—´å›æ‹¨ã€‚å½“å¾—çŸ¥å‘ç°æ—¶é—´å›æ‹¨çš„æ—¶å€™ï¼Œå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œç­‰å¾…ç¨‹åºå‘˜å¤„ç†ï¼Ÿè™½ç„¶æ˜¯å°æ¦‚ç‡äº‹ä»¶ï¼Œä½†ä¸åº”è¯¥æ˜¯åºå·ç”Ÿæˆå™¨ç¼–ç äººå‘˜åº”è¯¥å¿½ç•¥çš„é—®é¢˜ã€‚ çº¿ç¨‹è¿›å…¥ç­‰å¾…ï¼Œç›´åˆ°å½“å‰æ—¶é—´æˆ³å¤§äºä¸Šä¸€æ—¶é—´æˆ³ï¼Ÿä¹Ÿè®¸æ˜¯ä¸ªæ–¹å¼ï¼Œä½†åŠ å…¥å›æ‹¨äº†ä¸€ç§’ï¼Œé‚£å°±éœ€è¦ç¨‹åºç­‰å¾…ä¸€ç§’ï¼Œè¿™å¯¹äºå®æ—¶æ€§åŠå¯ç”¨æ€§è¦æ±‚æ¯”è¾ƒé«˜çš„æµç¨‹ï¼Œå¯èƒ½ä¸æ˜¯å¾ˆèƒ½æ¥å—ã€‚ æ¯”è¾ƒå¸¸ç”¨çš„æ–¹å¼æ˜¯åœ¨å‡ºç°æ—¶é—´å›æ‹¨æ—¶ï¼Œä½¿ç”¨ä¸Šä¸€æ—¶é—´æˆ³çš„åºå·æ¥ç»§ç»­ç´¯åŠ ã€‚æ¯”å¦‚ä¸Šä¸€ç§’æ—¶ 0 æ—¶ 0 åˆ† 0 ç§’ï¼Œè‡ªå¢åºå·åˆ°è¾¾äº† xã€‚å› ä¸ºæ—¶é—´å›æ‹¨ï¼Œä¸‹ä¸€ç§’æ—¶é—´æ˜¯ 23 æ—¶ 59 åˆ† 59 ç§’ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡ç”Ÿæˆåºå·ï¼Œå‘ç°å½“å‰æ—¶é—´æˆ³å°äºä¸Šä¸€æ—¶é—´æˆ³æ—¶ï¼Œåˆ™ä½¿ç”¨ 0 æ—¶ 0 åˆ† 0 ç§’çš„ï¼Œè‡ªå¢åºå·ä½¿ç”¨ x+1ã€‚ä½†ï¼Œè™½ç„¶æ¦‚ç‡ä¸é«˜ï¼Œè‡ªå¢åºå·ç”¨å®Œåï¼Œæ˜¯ä¸æ˜¯åˆå¾—é‡æ–°ç­‰å¾…å‘¢ï¼Ÿ æˆ–è€…ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªè™šæ‹Ÿåˆ†é…çš„ç¡¬ä»¶æ ‡å¿—ï¼Œæˆ–è€…ä¸€ä¸ªä¸å¯èƒ½å‘ç”Ÿçš„æ—¶é—´ä½ç½®ï¼Œåœ¨å‘ç”Ÿæ—¶é—´å›æ‹¨çš„æ—¶é—´åŒºé—´å†…ï¼Œç”¨æ¥ç”Ÿæˆå”¯ä¸€ IDã€‚ ç¡¬ä»¶æ ‡å¿—ã€æ—¶é—´æˆ³ã€åºå·ï¼Œè¿™ç§åºå·ç”Ÿæˆæ–¹å¼ï¼Œå½“å‰æœ€æµè¡Œçš„è«è¿‡äºé›ªèŠ±ç®—æ³•äº†ã€‚ç»å…¸çš„é›ªèŠ±ç®—æ³•ï¼Œä½¿ç”¨ 0+41 ä½æ¯«ç§’çº§æ—¶é—´æˆ³ + 10 ä½ç¡¬ä»¶æ ‡å¿— + 12 ä½åºå· æ€»å…± 64 ä½çš„äºŒè¿›åˆ¶ç”Ÿæˆã€‚ é›ªèŠ±ç®—æ³•ç›¸å¯¹äº UUID è€Œè¨€ï¼Œå­˜å‚¨çš„é•¿åº¦ä»…ä¸ºä¸€åŠï¼Œæ›´æ–¹ä¾¿çš„æ˜¯ï¼Œé€šè¿‡ç”Ÿæˆçš„ ID å¯ä»¥å€’æ¨å‡ºä¸€äº›ä¿¡æ¯ï¼Œåˆ™ ID å‘ˆè‡ªå¢å®è¡Œï¼Œä¸ä¼šåƒ UUID ä¸€æ ·æ‘¸ä¸ç€å¤´è„‘ã€‚ è€Œä¸Šé¢çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯å¤šç§å¤„ç†äº†æ—¶é—´å›æ‹¨çš„é›ªèŠ±æ–¹æ³•ã€‚ç½‘ä¸Šæ”¹è¿›é›ªèŠ±ç®—æ³•çš„æ–¹å¼å¾ˆå¤šï¼Œä½†å®é™…å¦‚ä½•æ”¹è¿›é›ªèŠ±ç®—æ³•æ¥ç”Ÿæˆ ID æœ€ä½³ï¼Œè¿™å¯èƒ½æ›´å¤šçš„å–å†³äºä½¿ç”¨åœºæ™¯ã€‚ ","tags":[{"index":-1,"name":"è½¬è½½","slug":"JDrWa3FBq","used":true,"link":"https://xuyj1111.github.io/JDrWa3FBq/"},{"index":-1,"name":"æ‚è®°","slug":"CseDYEWrD","used":true,"link":"https://xuyj1111.github.io/CseDYEWrD/"}],"title":"ã€è½¬è½½ã€‘é›ªèŠ±ç®—æ³•ä¸æ—¶é—´å›æ‹¨","feature":"","link":"https://xuyj1111.github.io/812AbNpSc/","stats":{"text":"5 min read","time":293000,"words":1404,"minutes":5},"date":"2022-04-28 16:16:02","dateFormat":"2022-04-28"},{"content":" TimeUnit è¡¨ç¤ºç»™å®šå•å…ƒç²’åº¦çš„æ—¶é—´æ®µ å¸¸ç”¨çš„é¢—ç²’åº¦ï¼š TimeUnit.DAYSå¤© TimeUnit.HOURSå°æ—¶ TimeUnit.MINUTESåˆ†é’Ÿ TimeUnit.SECONDSç§’ TimeUnit.MILLISECONDSæ¯«ç§’ é¢—ç²’åº¦è½¬æ¢ 1 å¤©è½¬æ¢ä¸º 24 å°æ—¶ TimeUnit.DAYS.toHours(1) 1 å°æ—¶è½¬æ¢ä¸º 60*60 ç§’ TimeUnit.HOURS.toSeconds(1) 3 å¤©è½¬æ¢ä¸º 72 å°æ—¶ TimeUnit.HOURS.convert(3, TimeUnit.DAYS) çº¿ç¨‹ç­‰å¾… å¯æ›¿ä»£Thread.sleep() çº¿ç¨‹ç­‰å¾… 1 ç§’ TimeUnit.SECONDS.sleep(1); ","tags":[{"index":-1,"name":"Java","slug":"SOje8Joqr","used":true,"link":"https://xuyj1111.github.io/SOje8Joqr/"},{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"}],"title":"ã€Javaã€‘TimeUnitçš„ä½¿ç”¨","feature":"","link":"https://xuyj1111.github.io/wmN375vyy/","stats":{"text":"1 min read","time":26000,"words":100,"minutes":1},"date":"2022-04-28 15:27:09","dateFormat":"2022-04-28"},{"content":" å¯ä»¥ç”¨æ¥ä¿®é¥°ï¼šç±» ã€å˜é‡ã€æ–¹æ³•ï¼Œä¸èƒ½ç”¨æ¥ä¿®é¥°æŠ½è±¡ç±»å’Œæ¥å£ finalå˜é‡ finalå˜é‡åªèƒ½è¢«èµ‹å€¼ä¸€æ¬¡ï¼Œèµ‹å€¼åå€¼ä¸å†æ”¹å˜ finalä¿®é¥°æˆå‘˜å˜é‡ é static çš„åˆå§‹åŒ–æ–¹å¼ï¼š åœ¨å˜é‡å£°æ˜çš„æ—¶å€™èµ‹å€¼ åœ¨å˜é‡æ‰€åœ¨çš„ç±»çš„æ„é€ å‡½æ•°ä¸­èµ‹å€¼ åœ¨éé™æ€çš„ä»£ç å—ä¸­èµ‹å€¼ static çš„åˆå§‹åŒ–æ–¹å¼ï¼š åœ¨å˜é‡å£°æ˜çš„æ—¶å€™èµ‹å€¼ åœ¨é™æ€çš„ä»£ç å—ä¸­èµ‹å€¼ p.s. ä¸èƒ½åœ¨æ„é€ æ–¹æ³•ä¸­èµ‹å€¼ finalä¿®é¥°å±€éƒ¨å˜é‡ éœ€è¦åœ¨å®šä¹‰æ—¶èµ‹å€¼ï¼Œæˆ–è€…åœ¨åç»­ä»£ç ä¸­èµ‹å€¼ï¼Œä»…ä¸€æ¬¡æœ‰æ•ˆ finalæ–¹æ³• finalæ–¹æ³•ä¸èƒ½è¢«é‡å†™ p.s. ä¸èƒ½ä¿®é¥°æ„é€ æ–¹æ³• finalç±» finalä¿®é¥°çš„ç±»ä¸èƒ½è¢«ç»§æ‰¿ ","tags":[{"index":-1,"name":"Java","slug":"SOje8Joqr","used":true,"link":"https://xuyj1111.github.io/SOje8Joqr/"},{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"}],"title":"ã€Javaã€‘finalå…³é”®å­—","feature":"","link":"https://xuyj1111.github.io/zriZx5dsI/","stats":{"text":"1 min read","time":41000,"words":197,"minutes":1},"date":"2022-04-28 14:33:32","dateFormat":"2022-04-28"},{"content":" åœ¨ IT ä¸­ä½¿ç”¨ï¼Œç®€å•è®²å°±æ˜¯æ¨¡æ‹Ÿå¯¹è±¡ä½¿ç”¨ å¼•å…¥ä¾èµ–ï¼š implementation 'org.mockito:mockito-core:2.23.4' mockå¯¹è±¡ mock å¯¹è±¡ä¸æ‰§è¡ŒçœŸå®æ–¹æ³•ï¼Œè¿”å›å€¼é»˜è®¤ null mockå¯¹è±¡çš„åˆ›å»º ä½¿ç”¨ Mockito ç±»çš„é™æ€æ–¹æ³•åˆ›å»º ex. List mockObj = Mockito.mock(List.class); ä½¿ç”¨@Mockæ³¨è§£ ä½¿ç”¨@MockBeanæ³¨è§£ mockå¯¹è±¡çš„é…ç½® ä½¿ç”¨when(â€‹...).thenReturn(â€‹...)æ–¹æ³•é“¾å®šä¹‰ä¸€ä¸ªè¡Œä¸º List mockObj = Mockito.mock(List.class); Mockito.when(mockObj.get(0)).thenReturn(&quot;hello world&quot;); System.out.println(mockObj.get(0)); //è¾“å‡ºï¼šhello world å¯ä»¥æŒ‡å®šå¤šä¸ªè¿”å›å€¼ï¼Œå¤šæ¬¡è°ƒç”¨åä¼šä¾æ¬¡è¿”å›è¿™äº›å€¼ Mockito.when(mockObj.get(0)).thenReturn(&quot;1&quot;).thenReturn(&quot;2&quot;).thenReturn(&quot;3&quot;); System.out.println(mockObj.get(0)); //è¾“å‡ºï¼š1 System.out.println(mockObj.get(0)); //è¾“å‡ºï¼š2 System.out.println(mockObj.get(0)); //è¾“å‡ºï¼š3 ä½¿ç”¨when(â€‹...).thenThrow(â€‹...)æ–¹æ³•é“¾å®šä¹‰æŠ›å‡ºå¼‚å¸¸ Mockito.when(mockObj.get(1)).thenThrow(new Exception()); System.out.println(mockObj.get(1)); //æŠ›å‡ºå¼‚å¸¸ p.s. mock å¯¹è±¡ä¹Ÿå¯ä½¿ç”¨doReturn(...).when(...).methodCallå’ŒdoThrow(...).when(...).methodCallçš„å†™æ³•ï¼Œå’Œä¸Šé¢æ²¡å·® mockå¯¹è±¡çš„æ ¡éªŒ æ ¡éªŒè¡Œä¸ºï¼Œä½¿ç”¨verifyæ–¹æ³• mockObj.add(&quot;one&quot;); //æ˜¯å¦è°ƒç”¨æ–¹æ³• Mockito.verify(mockObj).add(&quot;one&quot;); //æ–¹æ³•è°ƒç”¨çš„æ¬¡æ•° Mockito.verify(mockObj, Mockito.times(1)).add(&quot;one&quot;); //æ˜¯å¦ä»æœªè°ƒç”¨æ–¹æ³• Mockito.verify(mockObj, Mockito.never()).add(&quot;two&quot;); //æœ€å°‘è°ƒç”¨ 1 æ¬¡ Mockito.verify(mockObj, Mockito.atLeast(1)).add(&quot;one&quot;); //æœ€å°‘è°ƒç”¨ 1 æ¬¡ Mockito.verify(mockObj, Mockito.atLeastOnce()).add(&quot;one&quot;); //æœ€å¤šè°ƒç”¨ 5 æ¬¡ Mockito.verify(mockObj, Mockito.atMost(5)).add(&quot;one&quot;); æ ¡éªŒæ–¹æ³•çš„æ‰§è¡Œé¡ºåºï¼Œä½¿ç”¨inOrderæ–¹æ³•åˆ›å»º InOrder å¯¹è±¡ mockObj.add(&quot;two&quot;); InOrder inOrder = Mockito.inOrder(mockObj); //å•ä¸ª mock å¯¹è±¡çš„æ‰§è¡Œé¡ºåºæ ¡éªŒ inOrder.verify(mockObj).add(&quot;one&quot;); inOrder.verify(mockObj).add(&quot;two&quot;); List mockObj2 = Mockito.mock(List.class); mockObj2.add(111); InOrder inOrder2 = Mockito.inOrder(mockObj, mockObj2); //å¤šä¸ª mock å¯¹è±¡çš„æ‰§è¡Œé¡ºåºæ ¡éªŒ inOrder2.verify(mockObj).add(&quot;two&quot;); inOrder2.verify(mockObj2).add(111); éªŒè¯å•ä¸ªæˆ–å¤šä¸ª mock å¯¹è±¡æ²¡æœ‰è°ƒç”¨è¿‡æ–¹æ³•ï¼Œä½¿ç”¨verifyZeroInteractionsæ–¹æ³• List mockObj3 = Mockito.mock(List.class); List mockObj4 = Mockito.mock(List.class); Mockito.verifyZeroInteractions(mockObj3, mockObj4); å‚æ•°åŒ¹é…å™¨ï¼Œä½¿ç”¨ArgumentMatchersçš„é™æ€æ–¹æ³• any() anyXxx() eq(...) endsWith(String) startsWith(String) ...... spyå¯¹è±¡ spy å¯¹è±¡ä¼šæ‰§è¡ŒçœŸå®æ–¹æ³•ï¼Œè¿”å›å€¼ä¸ºçœŸå®è¿”å›å€¼ p.s. å‰ææ˜¯æ²¡æœ‰ç”¨ Mockito ç±»çš„æ–¹æ³•ä»£ç† spyå¯¹è±¡çš„åˆ›å»º ä½¿ç”¨ Mockito ç±»çš„é™æ€æ–¹æ³•åˆ›å»º ex. List spyObj = Mockito.spy(List.class); ä½¿ç”¨@Spyæ³¨è§£ ä½¿ç”¨@SpyBeanæ³¨è§£ spyå¯¹è±¡çš„é…ç½® doReturn(...).when(...).methodCallä¸ä¼šæ‰§è¡ŒçœŸå®æ–¹æ³•ï¼ŒåŒ mock å¯¹è±¡ä¸€è‡´ when(â€‹...).thenReturn(â€‹...)ä¼šæ‰§è¡ŒçœŸå®æ–¹æ³• @Spyã€@SpyBeanã€@Mockã€@MockBeanåŒºåˆ« spy å’Œ mock ç”Ÿæˆçš„å¯¹è±¡ä¸å— spring ç®¡ç† SpyBean å’Œ MockBean ç”Ÿæˆçš„å¯¹è±¡å— spring ç®¡ç†ï¼Œç›¸å½“äºè‡ªåŠ¨æ›¿æ¢å¯¹åº”ç±»å‹ bean çš„æ³¨å…¥ å‚æ•°æ•è· Mockito å…å‡†æˆ‘ä»¬æ•è·ä¸€ä¸ª Mock å¯¹è±¡çš„æ–¹æ³•è°ƒç”¨æ‰€ä¼ é€’çš„å‚æ•° é€šè¿‡argument.capture()è·å–ä¼ å‚ï¼Œç„¶åä½¿ç”¨argument.getValue()å–å‡ºå‚æ•° List mock = mock(ArrayList.class); List&lt;Integer&gt; list = new ArrayList&lt;&gt;(); list.add(111); list.add(222); mock.addAll(list); ArgumentCaptor&lt;ArrayList&gt; argument = ArgumentCaptor.forClass(ArrayList.class); verify(mock).addAll(argument.capture()); Assert.assertEquals(2, argument.getValue().size()); Assert.assertEquals(list, argument.getValue()); å»¶ä¼¸ å¯æ­é…ä½¿ç”¨Awaitilityâ€”â€”å¼‚æ­¥æ“ä½œæ ¡éªŒå·¥å…·ï¼Œé€‚ç”¨äºå¼‚æ­¥è¯·æ±‚çš„ITã€‚å³ç­‰å¾…å¼‚æ­¥è¯·æ±‚ä¸­çš„æŸä¸€æ¡ä»¶è¾¾æˆï¼Œæ ¡éªŒåç»­çš„ä»£ç  ","tags":[{"index":-1,"name":"Java","slug":"SOje8Joqr","used":true,"link":"https://xuyj1111.github.io/SOje8Joqr/"},{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"ä½¿ç”¨æ‰‹å†Œ","slug":"0shj16Tx0","used":true,"link":"https://xuyj1111.github.io/0shj16Tx0/"}],"title":"ã€Javaã€‘Mockitoçš„ä½¿ç”¨","feature":"","link":"https://xuyj1111.github.io/iPGLGnAWB/","stats":{"text":"4 min read","time":221000,"words":801,"minutes":4},"date":"2022-04-27 14:44:51","dateFormat":"2022-04-27"},{"content":" æœ¬æ–‡é€‰å–äº†å‚è€ƒé“¾æ¥ä¸­çš„éƒ¨åˆ†å†…å®¹ï¼Œå¹¶ä¸”èåˆäº†è‡ªå·±çš„ä¹ æƒ¯ ä¸ªäººä¹ æƒ¯ äºŒçº§æ ‡é¢˜ä¹‹é—´ä½¿ç”¨åˆ†å‰²çº¿ å­—ç¬¦ã€ç¬¦å·ã€è‹±æ–‡ç¼©å†™ä½¿ç”¨å•è¡Œä»£ç å—åŒ…ä½ å¸¸ç”¨çš„ç¼©å†™åŠç¬¦å· Q. question A. answer e.g.ä¾‹å¦‚ã€ä¸¾ä¾‹æ¥è¯´ï¼ˆç”¨äºå¥å­ä¸­ï¼‰ ex.èŒƒä¾‹æˆ–ç»ƒä¹  p.s.å¤‡æ³¨ æ ‡é¢˜ æ–‡ç« æ ‡é¢˜ä¸ºä¸€çº§æ ‡é¢˜ï¼Œæ–‡ç« å†…å®¹ä»äºŒçº§æ ‡é¢˜å¼€å§‹ï¼Œæœ€å°ä¸‰çº§æ ‡é¢˜ï¼Œä¸å¯è¶Šçº§ # ä¸€çº§æ ‡é¢˜ ## äºŒçº§æ ‡é¢˜ ## ä¸‰çº§æ ‡é¢˜ è‹¥ä»…æœ‰ 1 ä¸ªä¸‹çº§æ ‡é¢˜ï¼Œå¯çœç•¥ä¸‹çº§æ ‡é¢˜ ## äºŒçº§æ ‡é¢˜ A ### ä¸‰çº§æ ‡é¢˜ A ï¼ˆçœç•¥ï¼‰ ## äºŒçº§æ ‡é¢˜ B ä¸Šä¸€çº§æ ‡é¢˜ä¸å¯ä¸ä¸‹çº§æ ‡é¢˜é‡å ## æ¦‚è¿° ### æ¦‚è¿° æ–‡æœ¬ ä¸­æ–‡ä¸è‹±æ–‡ï¼ˆæˆ–åŠè§’ç¬¦å·ï¼‰ä¹‹é—´ï¼Œä¸­æ–‡ä¸æ•°å­—ä¹‹é—´ï¼Œåº”æœ‰åŠè§’ç©ºæ ¼ é”™è¯¯ï¼šæœ¬æ–‡ä»‹ç»å¦‚ä½•å¿«é€Ÿå¯åŠ¨1ä¸ªWindowsç³»ç»Ÿã€‚ æ­£ç¡®ï¼šæœ¬æ–‡ä»‹ç»å¦‚ä½•å¿«é€Ÿå¯åŠ¨ 1 ä¸ª Windows ç³»ç»Ÿã€‚ ä½¿ç”¨ç®€å•å¥æˆ–å¹¶åˆ—å¥ï¼Œé¿å…ä½¿ç”¨å¤åˆå¥ å¹¶åˆ—å¥ï¼šä»–æ˜¨å¤©ç”Ÿç—…äº†ï¼Œæ²¡æœ‰å‚åŠ ä¼šè®®ã€‚ å¤åˆå¥ï¼šé‚£ä¸ªæ˜¨å¤©ç”Ÿç—…çš„äººæ²¡æœ‰å‚åŠ ä¼šè®®ã€‚ ä½¿ç”¨è‚¯å®šå¥è¡¨è¾¾ï¼Œé¿å…ä½¿ç”¨å¦å®šå¥è¡¨è¾¾ é”™è¯¯ï¼šè¯·ç¡®è®¤æ²¡æœ‰æ¥é€šè£…ç½®çš„ç”µæºã€‚ æ­£ç¡®ï¼šè¯·ç¡®è®¤è£…ç½®çš„ç”µæºå·²å…³é—­ã€‚ é¿å…ä½¿ç”¨åŒé‡å¦å®šå¥ é”™è¯¯ï¼šæ²¡æœ‰åˆ é™¤æƒé™çš„ç”¨æˆ·ï¼Œä¸èƒ½åˆ é™¤æ­¤æ–‡ä»¶ã€‚ æ­£ç¡®ï¼šç”¨æˆ·å¿…é¡»æ‹¥æœ‰åˆ é™¤æƒé™ï¼Œæ‰èƒ½åˆ é™¤æ­¤æ–‡ä»¶ã€‚ å°½é‡ä¸ä½¿ç”¨è¢«åŠ¨è¯­æ€ï¼Œæ”¹ä¸ºä¸»åŠ¨è¯­æ€ é”™è¯¯ï¼šå‡å¦‚æ­¤è½¯ä»¶å°šæœªè¢«å®‰è£…ï¼Œ æ­£ç¡®ï¼šå‡å¦‚å°šæœªå®‰è£…è¿™ä¸ªè½¯ä»¶ï¼Œ ä¸ä½¿ç”¨å†·åƒ»ã€ç”Ÿé€ æˆ–æ–‡è¨€æ–‡çš„è¯è¯­ï¼Œè€Œè¦ä½¿ç”¨ç°ä»£æ±‰è¯­çš„å¸¸ç”¨è¡¨è¾¾æ–¹å¼ é”™è¯¯ï¼šè¿™æ˜¯å”¯äºŒçš„å¿«é€Ÿå¯åŠ¨çš„æ–¹æ³•ã€‚ æ­£ç¡®ï¼šè¿™æ˜¯ä»…æœ‰çš„ä¸¤ç§å¿«é€Ÿå¯åŠ¨çš„æ–¹æ³•ã€‚ å‚è€ƒé“¾æ¥ ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒï¼Œ by é˜®ä¸€å³° ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"è§„èŒƒ","slug":"pL5x1IP1J","used":true,"link":"https://xuyj1111.github.io/pL5x1IP1J/"}],"title":"å†™ä½œè§„èŒƒ","feature":"","link":"https://xuyj1111.github.io/ueAZWvrkp/","stats":{"text":"2 min read","time":103000,"words":501,"minutes":2},"date":"2022-04-27 09:49:32","dateFormat":"2022-04-27"},{"content":"å¼•å…¥ spring-data-redis ä¾èµ– implementation &quot;org.springframework.data:spring-data-redis&quot; å®˜ç½‘è¯´æ˜æ–‡æ¡£ ä¸ Redis è¿æ¥ï¼Œæœ‰å¤šç§è¿æ¥å™¨ã€‚æ ¹æ®å®˜ç½‘æ–‡æ¡£ä»‹ç»ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ï¼š Jedis connector JRedis connector SRP connector Lettuce connector ä»¥ä¸‹åªä»‹ç» Jedisï¼Œä½†æ¨èä½¿ç”¨ Lettuceï¼Œå› ä¸º Jedis çº¿ç¨‹ä¸å®‰å…¨ï¼ŒLettuce çº¿ç¨‹å®‰å…¨. Jedis å’Œ Jedis Pool çš„å…·ä½“ä»‹ç»è¯·å‚è€ƒJediså’ŒJedisè¿æ¥æ± çš„åŸºæœ¬ä½¿ç”¨å’Œé…ç½® SpringBoot è‡ªåŠ¨é…ç½®è¿æ¥ Jedis åœ¨ SpringBoot2.Ã— ä½¿ç”¨ jedisï¼Œä¹‹åè¢«æ›¿æ¢ä¸º lettuce é…ç½®ä¿¡æ¯ åœ¨ application.yml ä¸­å†™é…ç½®ä¿¡æ¯ spring: redis: host: 127.0.0.1 port: 6379 database: 0 password: jedis: pool: max-active: 32 max-wait: -1 max-idle: 8 min-idle: 0 p.s. æ–°ç‰ˆæœ¬çš„ jedis ä¸­å°† maxActive æ”¹æˆäº† maxTotalï¼ŒMaxWait æ”¹æˆäº† MaxWaitMillis è‡ªåŠ¨è£…é… SpringBoot ä¼šè‡ªåŠ¨é…ç½® Redisï¼Œæ‰€ä»¥åªéœ€è¦çš„åœ°æ–¹ä½¿ç”¨ RedisTemplate @Autowired private RedisTemplate&lt;String, String&gt; redisTemplate; è‡ªå®šä¹‰é…ç½®è¿æ¥ Jedis è‹¥éœ€è¦å°† redis æŸåŠŸèƒ½å°è£…æˆ frameworkï¼Œå¹¶å¯ä½œä¸ºç¬¬ä¸‰æ–¹åŒ…å¼•å…¥ä½¿ç”¨ï¼Œåˆ™éœ€è¦è‡ªè¡Œé…ç½® æ’é™¤è‡ªåŠ¨è£…é… @SpringBootApplication(exclude = {RedisAutoConfiguration.class}) åˆ›å»ºé…ç½®ç±» é…ç½® JedisConnectionFactory å’Œ RedisTemplate Beanï¼Œæ³¨å…¥ IOC å®¹å™¨ @Configuration public class RedisConfiguration { @Value(&quot;${spring.redis.host}&quot;) private String host; @Value(&quot;${spring.redis.port}&quot;) private int port; @Value(&quot;${spring.redis.database}&quot;) private int database; @Value(&quot;${spring.redis.password}&quot;) private String password; @Value(&quot;${spring.redis.jedis.pool.max-active}&quot;) private int maxActive; @Value(&quot;${spring.redis.jedis.pool.max-wait}&quot;) private int maxWait; @Value(&quot;${spring.redis.jedis.pool.max-idle}&quot;) private int maxIdle; @Value(&quot;${spring.redis.jedis.pool.min-idle}&quot;) private int minIdle; @Bean public JedisConnectionFactory redisConnectionFactory() { RedisStandaloneConfiguration serverConfig = new RedisStandaloneConfiguration(host, port); serverConfig.setDatabase(database); if (Strings.isNotBlank(password)) { serverConfig.setPassword(password); } JedisPoolConfig poolConfig = new JedisPoolConfig(); poolConfig.setMaxTotal(maxActive); poolConfig.setMaxWaitMillis(maxWait); poolConfig.setMaxIdle(maxIdle); poolConfig.setMinIdle(minIdle); JedisClientConfiguration.JedisPoolingClientConfigurationBuilder jpcb = (JedisClientConfiguration.JedisPoolingClientConfigurationBuilder) JedisClientConfiguration.builder(); jpcb.poolConfig(poolConfig); JedisClientConfiguration jedisClientConfiguration = jpcb.build(); return new JedisConnectionFactory(serverConfig, jedisClientConfiguration); } @Bean public RedisTemplate&lt;String, String&gt; redisTemplate(JedisConnectionFactory redisConnectionFactory) { RedisTemplate&lt;String, String&gt; redisTemplate = new RedisTemplate&lt;&gt;(); redisTemplate.setConnectionFactory(redisConnectionFactory); //è®¾ç½®åºåˆ—åŒ–ï¼Œé˜²æ­¢ä¹±ç  RedisSerializer stringSerializer = new StringRedisSerializer(); redisTemplate.setKeySerializer(stringSerializer); redisTemplate.setValueSerializer(stringSerializer); redisTemplate.setHashKeySerializer(stringSerializer); redisTemplate.setHashValueSerializer(stringSerializer); //åˆ·æ–°é…ç½® redisTemplate.afterPropertiesSet(); return redisTemplate; } } è‡ªåŠ¨è£…é… åœ¨éœ€è¦çš„åœ°æ–¹ä½¿ç”¨ RedisTemplate @Autowired private RedisTemplate&lt;String, String&gt; redisTemplate; ","tags":[{"index":-1,"name":"Java","slug":"SOje8Joqr","used":true,"link":"https://xuyj1111.github.io/SOje8Joqr/"},{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"ä½¿ç”¨æ‰‹å†Œ","slug":"0shj16Tx0","used":true,"link":"https://xuyj1111.github.io/0shj16Tx0/"},{"index":-1,"name":"Redis","slug":"FktD58SLR","used":true,"link":"https://xuyj1111.github.io/FktD58SLR/"}],"title":"ã€Javaã€‘Redisçš„é…ç½®å’Œä½¿ç”¨","feature":"","link":"https://xuyj1111.github.io/O9XdzloyU/","stats":{"text":"3 min read","time":149000,"words":496,"minutes":3},"date":"2022-04-06 17:34:12","dateFormat":"2022-04-06"},{"content":"ä½¿ç”¨å‘½ä»¤show plugins;æŸ¥çœ‹æ‰€æœ‰æ’ä»¶ï¼Œç¡®å®šå¼€å¯è¡¨åˆ†åŒºåŠŸèƒ½ åˆ›å»ºè¡¨åˆ†åŒº ex. CREATE TABLE `test_partition` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ID', `no` varchar(50) NULL DEFAULT NULL, PRIMARY KEY (`id`) ) PARTITION BY RANGE(id) ( PARTITION p0 VALUES LESS THAN(10), PARTITION p1 VALUES LESS THAN(20), PARTITION p2 VALUES LESS THAN maxvalue ); æ•°æ®è¡¨çš„æ•°æ®è¢«æ‹†åˆ†æˆå‡ ä¸ª ibd æ–‡ä»¶ï¼Œfrm æ–‡ä»¶æ˜¯è¡¨æ ¼å¼æ–‡ä»¶ å¯¼å…¥æ•°æ®INSERT INTO test_partition SELECT id,no FROM test WHERE id &lt;= 100; æ£€ç´¢æ•°æ®SELECT * FROM test_partition partition(p0); RANGEè¡¨åˆ†åŒº èŒƒå›´è¡¨åˆ†åŒºï¼ŒæŒ‰ä¸€å®šçš„èŒƒå›´åˆ’åˆ† åˆ†åŒºå­—æ®µå¿…é¡»æ˜¯æ•´æ•°ç±»å‹ï¼ˆbit, int ,tinyint,bigintç­‰ï¼‰ åˆ†åŒºçš„å®šä¹‰èŒƒå›´å¿…é¡»æ˜¯è¿ç»­çš„ï¼Œä¸”ä¸èƒ½é‡å  ç»™åˆ†åŒºå­—æ®µèµ‹å€¼æ—¶ï¼Œåˆ†åŒºå­—æ®µçš„å€¼å¤§å°ä¸èƒ½è¶…è¿‡åˆ†åŒºçš„å–å€¼èŒƒå›´ éæ•´æ•°ç±»å‹å­—æ®µï¼Œå¯åœ¨RANGE()ä¸­ä½¿ç”¨å‡½æ•°è¿›è¡Œè½¬æ¢ CREATE TABLE `test_partition` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ID', `no` varchar(50) NULL DEFAULT NULL, PRIMARY KEY (`id`) ) PARTITION BY RANGE(id) ( PARTITION p0 VALUES LESS THAN(10), PARTITION p1 VALUES LESS THAN(20), PARTITION p2 VALUES LESS THAN maxvalue ); è¯­æ³•ï¼š PARTITION BY RANGE(xxx) VALUES LESS THAN(...) VALUES LESS THAN maxvalue LISTè¡¨åˆ†åŒº åˆ—è¡¨è¡¨åˆ†åŒºï¼ŒæŒ‡å®šä¸€ä¸ªä¸ªç¡®å®šçš„å€¼ åˆ†åŒºå­—æ®µå¿…é¡»æ•´æ•°ç±»å‹ï¼Œæˆ–è€…å‡½æ•°è¿”å›çš„æ•´æ•° insertæ’å…¥æ•°æ®æ—¶ï¼Œæ•°æ®çš„åˆ†ç»„å­—æ®µåœ¨åˆ†åŒºèŒƒå›´å†…ï¼Œå¦åˆ™æŠ¥é”™ï¼šTable has no partition for XXX CREATE TABLE `test_partition` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ID', `no` varchar(50) NULL DEFAULT NULL, PRIMARY KEY (`id`) ) PARTITION BY LIST(id) ( PARTITION p0 VALUES IN(1,2,3,4,5), PARTITION p1 VALUES IN(6,7,8,9,10) ); è¯­æ³•ï¼š PARTITION BY LIST(xxx) VALUES IN(...,...,...,) HASHè¡¨åˆ†åŒº å“ˆå¸Œè¡¨åˆ†åŒºï¼Œæ ¹æ®è‡ªå®šä¹‰çš„æ•°æ®å–ä½™è®¡ç®—ï¼Œæ”¾å…¥å¯¹åº”åˆ†åŒº CREATE TABLE `test_partition` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ID', `no` varchar(50) NULL DEFAULT NULL, PRIMARY KEY (`id`) ) PARTITION BY HASH(id) PARTITIONS 4; è¯­æ³•ï¼š PARTITION BY HASH(xxx) PARTITIONS num KEYè¡¨åˆ†åŒº KEYè¡¨åˆ†åŒºï¼Œä¸å“ˆå¸Œè¡¨åˆ†åŒºç±»ä¼¼ï¼Œä½†æ˜¯ç”¨MySQLè‡ªå·±çš„HASHå‡½æ•°è®¡ç®— ä¸å†™åˆ†ç»„å­—æ®µï¼Œé»˜è®¤ä¸»é”®ï¼›æ²¡æœ‰ä¸»é”®åˆ™å”¯ä¸€é”®ï¼Œå”¯ä¸€é”®å¿…é¡»not null åˆ†ç»„å­—æ®µä¸å¿…æ˜¯æ•´æ•°ç±»å‹ åˆ†ç»„å­—æ®µéµå¾ªçº¦æŸæ¡ä»¶ CREATE TABLE `test_partition` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ID', `no` varchar(50) NOT NULL, PRIMARY KEY (`id`, `no`) ) PARTITION BY KEY(`id`, `no`) PARTITIONS 4; è¯­æ³•ï¼š PRIMARY KEY () PARTITIONS num PRIMARY KEY (xxx) PARTITIONS num PRIMARY KEY (xxx, xxx, ...) PARTITIONS num å¤šå­—æ®µåˆ†åŒºï¼ˆrangeï¼Œlistï¼‰ å¯ä»¥æŒ‡å®šå¤šä¸ªå­—æ®µä½œä¸ºåˆ†åŒºå­—æ®µ å¤šåˆ†ç»„å­—æ®µå¯ä»¥ä½¿ç”¨éæ•´æ•°ç±»å‹ï¼Œå› æ­¤å¯ä»¥åˆ›å»ºéæ•´æ•°ç±»å‹çš„å•åˆ†ç»„å­—æ®µï¼› å¯¹æ¯”æ–¹å‘ä»å·¦å¾€å³ CREATE TABLE `test_partition` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ID', `no` varchar(50) NOT NULL, PRIMARY KEY (`id`, `no`) ) PARTITION BY RANGE COLUMNS(`id`, `no`) ( PARTITION P0 VALUES LESS THAN(10, 'd'), PARTITION P1 VALUES LESS THAN(20, 'g') ); ----------------------------------------------------------- CREATE TABLE `test_partition` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ID', `no` varchar(50) NOT NULL, PRIMARY KEY (`id`, `no`) ) PARTITION BY LIST COLUMNS(`id`, `no`) ( PARTITION P0 VALUES IN ((1, 'a'), (1, 'b')), PARTITION P1 VALUES IN ((2, 'c'), (2, 'd')) ); range è¯­æ³•ï¼š PARTITION BY RANGE COLUMNS(xxx) PARTITION BY RANGE COLUMNS(xxx, xxx) list è¯­æ³•ï¼š PARTITION BY LIST COLUMNS(xxx) PARTITION BY LIST COLUMNS(xxx, xxx) VALUES IN (..., ...) VALUES IN ((..., ...), (..., ...)) åˆ›å»ºè¡¨åˆ†åŒºçš„çº¦æŸæ¡ä»¶ å¦‚æœè¡¨æœ‰ä¸»é”®ï¼ˆprimary keyï¼‰æˆ–è€…å”¯ä¸€é”®ï¼ˆunique keyï¼‰ï¼Œåˆ†åŒºå­—æ®µå¿…é¡»è¢«åŒ…å«åœ¨ä¸»é”®å’Œå”¯ä¸€é”®å­—æ®µçš„äº¤é›†éƒ¨åˆ† æ˜¯å¦æœ‰ä¸»é”®ï¼ˆprimary keyï¼‰ æ˜¯å¦æœ‰å”¯ä¸€é”®ï¼ˆunique keyï¼‰ åˆ†åŒºå­—æ®µ âˆš Ã— åœ¨ä¸»é”®å­—æ®µå†… Ã— âˆš æ²¡æœ‰å¯åˆ†åŒºçš„å­—æ®µ âˆš âˆš ä¸»é”®å’Œå”¯ä¸€é”®çš„äº¤é›†å­—æ®µ è¡¨åˆ†åŒºçš„ä½¿ç”¨ ä½¿ç”¨åˆ†åŒºå­—æ®µåšæŸ¥è¯¢æ—¶ï¼ŒåªæŸ¥æ‰€åœ¨åˆ†åŒºï¼Œå¦åˆ™æŸ¥è¯¢æ‰€æœ‰åˆ†åŒº åˆ†åŒºå­—æ®µæŸ¥è¯¢ æ™®é€šå­—æ®µæŸ¥è¯¢ è¡¨åˆ†åŒºçš„ä¼˜ç‚¹ æé«˜è¡¨å­˜å‚¨çš„æ•°æ®é‡ï¼ˆå¤šä¸ªæ–‡ä»¶ï¼‰ æé«˜æŸ¥è¯¢æˆ–ä¿®æ”¹è¯­å¥çš„æ‰§è¡Œé€Ÿåº¦ï¼ˆå¯å®šä½åˆ°ä¸€ä¸ªåˆ†åŒºæˆ–å¤šä¸ªåˆ†åŒºï¼‰ å‚è€ƒé“¾æ¥ MySqlè¡¨åˆ†åŒºçš„åˆ›å»ºä¸ä½¿ç”¨ï¼Œby Bear Coding ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"MySQL","slug":"eng41sp6q","used":true,"link":"https://xuyj1111.github.io/eng41sp6q/"}],"title":"ã€MySQLã€‘è¡¨åˆ†åŒºçš„ä½¿ç”¨","feature":"","link":"https://xuyj1111.github.io/iJYYroozC/","stats":{"text":"5 min read","time":254000,"words":935,"minutes":5},"date":"2021-09-10 10:07:45","dateFormat":"2021-09-10"},{"content":"ä¸€çº§æ ‡é¢˜ äºŒçº§æ ‡é¢˜ æ–œä½“ åŠ ç²— æ–œä½“åŠ ç²— åˆ é™¤å†™ ç™¾åº¦é“¾æ¥ https://www.bilibili.com å¼•ç”¨å†…å®¹ å¼•ç”¨é‡Œé¢ä¹Ÿå¯ä»¥ä½¿ç”¨Markdownè¯­æ³• åµŒå¥—å¼•ç”¨ æ— éœ€åˆ—è¡¨ æœ‰åºåˆ—è¡¨ åˆ—è¡¨é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨Markdownè¯­æ³• ä»¥ä¸‹æ˜¯è¡¨æ ¼è§„èŒƒï¼š |ç¬¦å·çš„ä¸¤ä¾§éƒ½éœ€ç©ºæ ¼ ç¬¬äºŒè¡Œå›ºå®š 4 ä¸ª-ä»£è¡¨ 1 åˆ— ä¸è¦æ±‚ä¹¦å†™æ—¶æ¯è¡Œå¯¹é½ æœˆä»½ æ”¶å…¥ æ”¯å‡º 8 1000 500 9 1200 600 10 1400 650 å¯ä½¿ç”¨:æŒ‡å®šåˆ—çš„å¯¹é½æ–¹å‘ :----:å±…ä¸­å¯¹é½ ----:å³å¯¹é½ :----å·¦å¯¹é½ æœˆä»½ æ”¶å…¥ æ”¯å‡º 8 1000 500 9 1200 600 10 1400 650 Sytem.out.println(&quot;å•è¡Œä»£ç &quot;) public static void main(){ System.out.println(&quot;å¤šè¡Œä»£ç &quot;); } ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"è§„èŒƒ","slug":"pL5x1IP1J","used":true,"link":"https://xuyj1111.github.io/pL5x1IP1J/"}],"title":"Markdownç¤ºä¾‹","feature":"","link":"https://xuyj1111.github.io/5u99Umvhx/","stats":{"text":"1 min read","time":42000,"words":176,"minutes":1},"date":"2021-06-16 20:56:15","dateFormat":"2021-06-16"},{"content":"æ•°æ®åº“ MySQL Redis ä¸­é—´ä»¶ ActiveMQ RabbitMQ Kafka æ„å»º Maven Gradle Git SVN Docker Kubernetes å…¶ä»– Linux æ•°æ®ç»“æ„ è®¾è®¡æ¨¡å¼ Luaè„šæœ¬ Nginx æ­£åˆ™è¡¨è¾¾å¼ Spring Spring Spring MVC Spring Boot Spring Cloud Spring Batch Spring Security Spring Retry æŒä¹…åŒ–æ¡†æ¶ MyBatis MyBatis-Plus Hibernate JPA ç¬¬ä¸‰æ–¹ Lombok slf4j + logbackâ€”â€”æ—¥å¿—æ¡†æ¶ Elastic-Jobâ€”â€”ä½œä¸šæ¡†æ¶ Zookeeper Quartzâ€”â€”å®šæ—¶ä»»åŠ¡æ¡†æ¶ Activitiâ€”â€”ä¸šåŠ¡æµç¨‹æ¡†æ¶ EasyExcelâ€”â€”é˜¿é‡Œexcelå¤„ç†æ¡†æ¶ ElasticSearchâ€”â€”æœç´¢å¼•æ“æ¡†æ¶ Sharding-JDBCâ€”â€”åˆ†åº“åˆ†è¡¨æŠ€æœ¯ OkHttpâ€”â€”HTTPå®¢æˆ·ç«¯ Orikaâ€”â€”JavaBeanæ˜ å°„ Guavaâ€”â€”è°·æ­Œå·¥å…·åº“ Hutoolâ€”â€”Javaå·¥å…·åŒ… Jacksonâ€”â€”JSONå·¥å…·ç±»åº“ Querydslâ€”â€”SQLæ„å»ºå·¥å…· Flywayâ€”â€”æ•°æ®åº“ç‰ˆæœ¬ç®¡ç†å·¥å…· Curatorâ€”â€”Zookeeperå®¢æˆ·ç«¯ Zip4jâ€”â€”å‹ç¼©å·¥å…·åŒ… OpenCSVâ€”â€”csvå¤„ç†å·¥å…·åŒ… Awaitilityâ€”â€”å¼‚æ­¥æ“ä½œæ ¡éªŒå·¥å…· jjwtâ€”â€”æä¾›JWTåˆ›å»ºå’ŒéªŒè¯çš„Javaåº“ Minioâ€”â€”åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨æœåŠ¡ æµ‹è¯• REST Assuredâ€”â€”HTTPæ¥å£æµ‹è¯• Assertâ€”â€”åŸç”Ÿæ–­è¨€ Hamcrestâ€”â€”matcheråŒ¹é…å™¨æ–­è¨€ Mockitoâ€”â€”æµ‹è¯•æ¡†æ¶ æŒç»­æ›´æ–°...... ","tags":[{"index":-1,"name":"åŸåˆ›","slug":"WSbjWpIkN","used":true,"link":"https://xuyj1111.github.io/WSbjWpIkN/"},{"index":-1,"name":"æ€»ç»“","slug":"MIh5ain1j","used":true,"link":"https://xuyj1111.github.io/MIh5ain1j/"}],"title":"ã€TOPã€‘æŠ€æœ¯åŠå®˜ç½‘æ–‡æ¡£","feature":"","link":"https://xuyj1111.github.io/38IQbQ0h-/","stats":{"text":"2 min read","time":60000,"words":237,"minutes":2},"date":"2021-05-31 18:10:10","dateFormat":"2021-05-31"}]}